# 📋 IEPON MCP 주요 기능 명세 (Alpine.js + MCP 통합)

> **MCP 통합 Alpine.js + HTML 기반**: Supabase MCP, Toss Payments MCP 서버 연동 기능 명세 포함  
> **MCP 툴 호출 기반 기능**: 모든 데이터 CRUD, AI 생성, 결제 처리 등이 MCP 툴 호출 패턴으로 구현  
> **연결 문서**: [01_시스템_아키텍처.md](./01_시스템_아키텍처.md) | [02_데이터베이스_설계.md](./02_데이터베이스_설계.md) | [03_UI_UX_설계.md](./03_UI_UX_설계.md) | [07_API_설계.md](./07_API_설계.md) | [05_컴포넌트_설계.md](./05_컴포넌트_설계.md) | [08_환경_설정.md](./08_환경_설정.md) | [10_보안_권한.md](./10_보안_권한.md) | [14_결제_설계.md](./14_결제_설계.md)
> **MCP 기술 스택**: Alpine.js v3 + HTMX v1.9+ + Supabase MCP + Toss Payments MCP + Netlify 기반 개발
> **MCP 서버 ENUM 통합**: 본 문서의 `status` 필드는 [02_데이터베이스_설계.md](./02_데이터베이스_설계.md) MCP 연동 테이블에 정의된 공통 ENUM (`'active'`, `'expired'`, `'pending'`, `'cancelled'`, `'error'`) 값을 MCP 툴 호출로 사용합니다.
> **MCP 데이터 UTF-8 안전성**: MCP 툴 호출 및 모든 데이터 교환에서 UTF-8 인코딩 안전성 보장
> **MCP 접근성 준수**: WCAG 2.1 AA 표준 준수, MCP 서버 상태 표시 UI 포함, 48px 이상 터치 타겟, ARIA 레이블 적용

---

## 4.1 학생 인적사항 관리

### 4.1.1 기본 정보 관리
**기능 개요**: 특수교육 대상 학생의 기본 인적사항을 체계적으로 관리

#### 필수 입력 항목
- **학생 기본정보**
  - 이름 (필수, 100자 이내)
  - 생년월일 (필수, 세는나이/만나이 자동계산)
  - 성별 (선택)
  
- **학교 정보**
  - 소속학교명 (200자 이내)
  - 학년 (1-12학년)
  - 반 (20자 이내)
  - 통합학급 담임교사명 (100자 이내)

#### 통합교육 정보
- **통합 유형**: 완전통합/부분통합 라디오 버튼 선택
- **통합 시간**: 주당 통합 시간 수 입력
- **통합 과목**: 다중 선택 가능한 체크박스

#### 장애 정보
- **장애 영역**: 다중 선택 체크박스
  - 지적장애, 자폐성장애, 정서·행동장애, 의사소통장애
  - 학습장애, 건강장애, 발달지체, 기타
- **장애 등록일**: 날짜 선택기
- **복지카드 소지**: 예/아니오 선택
- **장애 정도**: 경증/중증 선택

### 4.1.2 지원 현황 관리

#### 복지 지원
- **지원 유형**: 다중 선택 체크박스
  - 장애인연금, 장애수당, 장애아동수당
  - 보육료지원, 방과후돌봄, 기타
- **지원 기관**: 텍스트 입력
- **지원 내용**: 상세 내용 기록

#### 치료 지원
- **치료 유형**: 언어치료, 작업치료, 물리치료, 심리치료 등
- **치료 빈도**: 주 1회, 주 2회, 월 1회 등 선택
- **치료 기관**: 기관명 및 연락처
- **치료 담당자**: 담당 치료사 정보

#### 보조인력 지원
- **보조인력 종류**: 특수교육실무사, 사회복무요원, 자원봉사자 등
- **지원 시간**: 주당 지원 시간 수
- **주요 역할**: 학습지원, 생활지원, 이동지원 등

### 4.1.3 가정환경 및 개인특성

#### 보호자 정보 (MCP 통합 Alpine.js 데이터 구조)
```javascript
// MCP 통합 Alpine.js 데이터 구조
function studentGuardianMcpData() {
  return {
    // MCP 서버 상태
    mcpServerStatus: 'unknown',
    mcpToolCalling: false,
    mcpError: null,
    
    guardians: [
      {
        id: null,
        name: '',           // 보호자 이름 (MCP UTF-8 안전)
        relationship: '',   // 관계 (부, 모, 조부모 등)
        phone: '',         // 연락처 (하이픈 포맷 자동 적용)
        email: '',         // 이메일 (선택, 유효성 검증)
        address: '',       // 주소 (선택)
        occupation: '',    // 직업 (선택)
        isPrimary: false   // 주 보호자 여부
      }
    ],
    
    // MCP 툴 호출을 통한 보호자 추가
    async addGuardian() {
      try {
        this.mcpToolCalling = true;
        this.mcpError = null;
        
        const newGuardian = {
          id: Date.now(),
          name: '', relationship: '', phone: '', 
          email: '', address: '', occupation: '', 
          isPrimary: false
        };
        
        // MCP를 통한 보호자 데이터 저장
        await this.callMcpTool('supabase', 'execute_sql', {
          project_id: window.SUPABASE_PROJECT_ID,
          query: `INSERT INTO student_guardians (student_id, name, relationship, phone, email, address, occupation, is_primary) 
                   VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING *`,
          params: [this.studentId, newGuardian.name, newGuardian.relationship, 
                   newGuardian.phone, newGuardian.email, newGuardian.address, 
                   newGuardian.occupation, newGuardian.isPrimary]
        });
        
        this.guardians.push(newGuardian);
      } catch (error) {
        this.mcpError = `보호자 추가 실패: ${error.message}`;
        console.error('MCP 보호자 추가 오류:', error);
      } finally {
        this.mcpToolCalling = false;
      }
    },
    
    // MCP 툴 호출을 통한 보호자 삭제
    async removeGuardian(index) {
      if (this.guardians.length <= 1) return;
      
      try {
        this.mcpToolCalling = true;
        this.mcpError = null;
        
        const guardian = this.guardians[index];
        if (guardian.id) {
          // MCP를 통한 보호자 데이터 삭제
          await this.callMcpTool('supabase', 'execute_sql', {
            project_id: window.SUPABASE_PROJECT_ID,
            query: 'DELETE FROM student_guardians WHERE id = $1',
            params: [guardian.id]
          });
        }
        
        this.guardians.splice(index, 1);
      } catch (error) {
        this.mcpError = `보호자 삭제 실패: ${error.message}`;
        console.error('MCP 보호자 삭제 오류:', error);
      } finally {
        this.mcpToolCalling = false;
      }
    },
    
    // MCP 툴 호출을 통한 보호자 목록 로드
    async loadGuardians(studentId) {
      try {
        this.mcpToolCalling = true;
        this.mcpError = null;
        this.studentId = studentId;
        
        const result = await this.callMcpTool('supabase', 'execute_sql', {
          project_id: window.SUPABASE_PROJECT_ID,
          query: 'SELECT * FROM student_guardians WHERE student_id = $1 ORDER BY is_primary DESC, created_at ASC',
          params: [studentId]
        });
        
        if (result && result.length > 0) {
          this.guardians = result.map(row => ({
            id: row.id,
            name: row.name || '',
            relationship: row.relationship || '',
            phone: row.phone || '',
            email: row.email || '',
            address: row.address || '',
            occupation: row.occupation || '',
            isPrimary: row.is_primary || false
          }));
        }
      } catch (error) {
        this.mcpError = `보호자 목록 로드 실패: ${error.message}`;
        console.error('MCP 보호자 로드 오류:', error);
      } finally {
        this.mcpToolCalling = false;
      }
    },
    
    // MCP 툴 호출 래퍼
    async callMcpTool(serverName, toolName, params) {
      // MCP 툴 호출 전 UTF-8 검증
      if (params && typeof params === 'object') {
        for (const [key, value] of Object.entries(params)) {
          if (typeof value === 'string' && !this.validateUTF8(value)) {
            throw new Error(`MCP 파라미터 '${key}'에 UTF-8 인코딩 문제가 있습니다.`);
          }
        }
      }
      
      const response = await fetch(`/mcp/${serverName}/${toolName}`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify(params || {})
      });
      
      if (!response.ok) {
        throw new Error(`MCP 툴 호출 실패: ${response.status} ${response.statusText}`);
      }
      
      const result = await response.json();
      
      // 응답 데이터 UTF-8 검증
      if (result && typeof result === 'object') {
        const jsonString = JSON.stringify(result);
        if (!this.validateUTF8(jsonString)) {
          console.warn('MCP 응답 데이터에 UTF-8 인코딩 문제가 있을 수 있습니다.');
        }
      }
      
      return result;
    },
    
    // UTF-8 안전성 검증 (MCP 데이터 교환용)
    validateUTF8(text) {
      try {
        const encoded = new TextEncoder().encode(text);
        const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
        return decoded === text;
      } catch (error) {
        console.error('MCP 데이터 UTF-8 인코딩 오류:', error);
        return false;
      }
    }
  };
}
```

#### 일상생활 정보
- **통학 방법**: 도보, 자가용, 통학버스, 대중교통 등
- **생활 습관**: 기상시간, 취침시간, 식사습관 등
- **가정 환경**: 가족 구성원, 주거 형태, 경제 상황 등

#### 개인 특성
- **좋아하는 것**: 관심사, 취미, 선호 활동 (배열 형태)
- **민감하거나 불편한 것**: 기피 대상, 주의사항 (배열 형태)
- **의사소통 방식**: 구어, 몸짓, 그림카드, AAC 등

### 4.1.4 보조기기 및 첨부서류

#### 보조기기 관리
- **사용 중인 보조기기**: 다중 선택 및 직접 입력
  - 휠체어, 보행기, 의사소통기기
  - 학습보조기기, 컴퓨터접근기기 등
- **device_condition** (`정상`, `수리필요`, `교체필요`)
- **관리 기관**: 보조기기센터 정보

#### 첨부서류 관리
- **진단서류**: PDF, JPG, PNG 파일 업로드
- **치료 기록**: 치료 관련 서류 첨부
- **기타 서류**: 관련 문서 첨부
- **파일 이력**: 업로드/다운로드/삭제 이력 관리

---

## 4.2 현행수준 평가

### 4.2.1 영역별 평가 시스템

#### 언어 영역 평가
- **수용 언어**: 듣기 이해 능력 평가 (200-500자)
- **표현 언어**: 말하기 능력 평가 (200-500자)
- **문해 능력**: 읽기/쓰기 능력 평가 (200-500자)
- **의사소통 방식**: 주요 의사소통 수단 기록

#### 수리 영역 평가
- **수 개념**: 수 인식 및 이해 수준
- **연산 능력**: 기본 사칙연산 수행 능력
- **문제 해결**: 수학적 사고 및 문제해결 능력
- **실생활 적용**: 일상생활 속 수학 활용 능력

#### 행동발달특성 평가
- **사회성**: 또래 관계, 사회적 상호작용 능력
- **정서 발달**: 감정 조절, 정서 표현 능력
- **행동 특성**: 주의집중, 충동성, 과잉행동 등
- **적응 행동**: 일상생활 기능, 자립 능력

### 4.2.2 평가 관리 시스템

#### 학기별 관리
- **1학기 평가**: 3월 초 작성 시작
- **2학기 평가**: 9월 초 작성 시작
- **평가 기간**: 각 학기 첫 달 집중 평가
- **평가 완료**: 학기 시작 후 1개월 내 완료

#### 자동저장 및 이력관리 (Alpine.js 데이터 관리)
```javascript
// Alpine.js 기반 현행수준 평가 데이터 관리
function currentLevelEvaluationData() {
  return {
    // 자동 저장 상태
    autoSave: {
      lastSaved: null,
      content: {},
      isDirty: false,
      isAutoSaving: false
    },
    
    // 평가 데이터
    evaluation: {
      // 언어 영역
      language: {
        receptive: '',      // 수용 언어 (200-500자)
        expressive: '',     // 표현 언어 (200-500자)
        literacy: '',       // 문해 능력 (200-500자)
        communication: ''   // 의사소통 방식
      },
      
      // 수리 영역
      math: {
        numberConcept: '',  // 수 개념
        calculation: '',    // 연산 능력
        problemSolving: '', // 문제 해결
        realLifeApp: ''     // 실생활 적용
      },
      
      // 행동발달특성
      behavior: {
        social: '',         // 사회성
        emotional: '',      // 정서 발달
        behavioral: '',     // 행동 특성
        adaptive: ''        // 적응 행동
      }
    },
    
    // 접근 로그
    accessLogs: [],
    
    // 자동 저장 시작
    startAutoSave() {
      setInterval(() => {
        if (this.autoSave.isDirty && !this.autoSave.isAutoSaving) {
          this.performAutoSave();
        }
      }, 30000); // 30초마다 자동 저장
    },
    
    // 자동 저장 실행
    performAutoSave() {
      this.autoSave.isAutoSaving = true;
      
      // UTF-8 안전성 검증
      const validContent = this.validateAllContent();
      if (!validContent) {
        console.error('입력 내용에 UTF-8 인코딩 오류가 있습니다.');
        this.autoSave.isAutoSaving = false;
        return;
      }
      
      fetch('/api/current-levels/auto-save', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          evaluation: this.evaluation,
          timestamp: new Date().toISOString()
        })
      })
      .then(response => {
        if (response.ok) {
          this.autoSave.lastSaved = new Date();
          this.autoSave.isDirty = false;
          this.logAccess('auto_save');
        }
        return response;
      })
      .catch(error => {
        console.error('자동 저장 중 오류 발생:', error);
      })
      .finally(() => {
        this.autoSave.isAutoSaving = false;
      });
    },
        
      // 내용 변경 감지
    markDirty() {
      this.autoSave.isDirty = true;
    },
    
    // UTF-8 안전성 검증
    validateAllContent() {
      const allTexts = [
        ...Object.values(this.evaluation.language),
        ...Object.values(this.evaluation.math),
        ...Object.values(this.evaluation.behavior)
      ];
      
      return allTexts.every(text => {
        if (!text) return true; // 빈 문자열은 통과
        return this.validateUTF8(text);
      });
    },
    
    // UTF-8 인코딩 검증
    validateUTF8(text) {
      try {
        const encoded = new TextEncoder().encode(text);
        const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
        return decoded === text;
      } catch (error) {
        return false;
      }
    },
    
    // 접근 로그 기록
    logAccess(action, changes = []) {
      this.accessLogs.unshift({
        timestamp: new Date(),
        action: action, // 'view', 'edit', 'save', 'delete', 'auto_save'
        userId: Alpine.store('auth').user?.id || 'unknown',
        changes: changes
      });
      
      // 로그는 최대 100개까지만 보관
      if (this.accessLogs.length > 100) {
        this.accessLogs = this.accessLogs.slice(0, 100);
      }
    },
    
    // 평가 내용 기능별 저장
    saveEvaluation() {
      this.logAccess('save');
      
      fetch('/api/current-levels', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify(this.evaluation)
      })
      .then(response => {
        if (response.ok) {
          this.autoSave.isDirty = false;
          alert('평가 내용이 저장되었습니다.');
        } else {
          throw new Error('저장 실패');
        }
        return response;
      })
      .catch(error => {
        console.error('평가 저장 오류:', error);
        alert('저장 중 오류가 발생했습니다.');
      });
    }
  };
}
```

---

## 4.2.3 교육과정 배정 시스템

### 4.2.3.1 개별 배정 관리
**기능 개요**: 교사가 학생별로 월별 교육과정 단원을 자유롭게 배정하는 시스템

#### 학생 컨텍스트 자동 연동
- **학생 선택 시 자동 로드**: 학생 선택 즉시 인적사항, 현행수준, 개별화 특성 자동 표시
- **현행수준 기반 추천**: 학생의 현재 수준에 맞는 적정 단원 자동 추천
- **개별화 특성 반영**: 학습 강점, 어려움, 지원 요구사항 자동 적용
- **이전 배정 이력**: 과거 배정 내역 및 성과 데이터 자동 참조
- **의료진단 연동**: 진단 정보 기반 배정 시 고려사항 자동 제시

#### 배정 기본 정보
- **대상 학생**: 드롭다운에서 학생 선택 → 자동 컨텍스트 로드
- **교육과정 단원**: 업로드된 교육과정 단원 중 선택 (현행수준 기반 필터링)
- **학사일정**: 학년도, 학기 선택
- **배정 월**: 다중 선택 가능 (3월, 4월, 5월 등)
- **배정 사유**: 해당 단원을 배정하는 이유 기입 (AI 자동 제안)

#### AI 기반 개별화 설정
- **난이도 조절**: 현행수준 기반 자동 추천 (쉽음/보통/어려움/맞춤형)
- **개별화 목표**: 학생 특성 기반 맞춤형 학습 목표 AI 자동 생성
- **예상 수업 시간**: 학생의 학습 속도 분석 기반 시간 자동 계산
- **선수 기술 검증**: 현행수준과 단원 요구사항 자동 비교 분석
- **지원 자료 추천**: 개별화 특성 기반 필요 교구/자료 자동 제안
- **개별화 메모**: 학생별 특별 고려사항 자동 생성 + 교사 추가 입력

#### 실시간 적합성 분석
- **수준 적합성**: 단원 난이도와 학생 현행수준 실시간 매칭 분석
- **학습 부하**: 월별 학습 부하량 자동 계산 및 경고
- **지원 요구사항**: 필요한 개별 지원 및 조정사항 자동 식별
- **성공 예측**: 과거 데이터 기반 학습 성공 가능성 예측

#### 중복 배정 허용
- **월별 중복**: 동일 단원을 여러 달에 배정 가능
- **학년 불일치**: 학생 학년과 다른 학년의 교육과정 배정 가능
- **과목 혼합**: 다양한 과목의 단원을 자유롭게 조합
- **진도 조절**: 학생의 학습 속도에 따라 유연하게 조절

### 4.2.3.2 대량 배정 기능
**기능 개요**: 여러 학생에게 동일한 교육과정을 일괄 배정하는 기능

#### 대량 배정 설정
- **대상 학생**: 체크박스로 다중 선택
- **공통 설정**: 배정 월, 난이도, 기본 설정 일괄 적용
- **개별 예외**: 특정 학생에 대한 예외 설정 가능
- **배정 결과**: 성공/실패 현황 상세 보고

#### 배정 검증
- **중복 배정 검사**: 이미 배정된 단원 자동 검사
- **선수 기술 검증**: 학생의 현재 수준과 비교
- **월별 부하 분석**: 월별 학습 부하량 자동 계산
- **충돌 방지**: 동일 월에 과도한 배정 방지

### 4.2.3.3 배정 현황 관리
**기능 개요**: 배정된 교육과정의 진행 상황을 추적하고 관리

#### 진도 추적
- **progress_status** (`배정됨`, `진행중`, `완료`, `일시정지`, `취소`)
- **진도율**: 백분율로 진행 상황 표시
- **시작일/완료일**: 실제 수업 시작 및 완료 일자 기록
- **진도 메모**: 주차별 진행 상황 및 특이사항 기록

#### 대시보드 및 통계
- **월별 현황**: 월별 배정 현황 시각화
- **학생별 현황**: 개별 학생의 배정 현황 요약
- **과목별 통계**: 과목별 배정 및 진행 현황
- **지연 배정**: 예상 완료일을 넘긴 배정 목록

### 4.2.3.4 AI 기반 배정 추천
**기능 개요**: AI가 학생의 학습 수준과 선호도를 분석하여 최적의 교육과정을 추천

#### 추천 알고리즘
- **학습 수준 분석**: 학생의 현재 수준과 교육과정 난이도 매칭
- **선수 기술 검증**: 필요한 선수 기술 보유 여부 확인
- **학습 패턴 분석**: 과거 학습 이력을 바탕으로 선호도 추정
- **진도 예측**: 학습 속도를 고려한 예상 완료 시점 예측

#### 추천 결과
- **추천 단원 목록**: 신뢰도 순으로 정렬된 추천 목록
- **추천 사유**: 각 추천에 대한 구체적인 이유 설명
- **신뢰도 점수**: AI 추천의 신뢰도 (0.0-1.0)
- **예상 속도**: 해당 단원의 예상 학습 속도 및 소요 시간

#### 추천 설정
- **난이도 선호도**: 쉽음/보통/어려움 중 선호 난이도 설정
- **집중 영역**: 특별히 집중하고 싶은 학습 영역 지정
- **제외 과목**: 추천에서 제외할 과목 선택
- **월별 분산**: 추천 단원을 어떤 월에 배치할지 설정

---

## 4.3 월별 교육계획 작성수립

### 4.3.1 월별 교육계획 작성

#### 학생 컨텍스트 자동 반영
- **학생 선택 시 자동 로드**: 학생 선택 즉시 인적사항, 현행수준, 개별화 특성 자동 표시
- **현행수준 기반 목표**: 학생의 현재 수준에 맞는 개별화 목표 자동 생성
- **학습 특성 반영**: 학습 스타일, 강점, 어려움 영역 자동 적용
- **지원 요구사항**: 특별 지원 사항 및 조정 필요사항 자동 식별
- **이전 계획 연계**: 과거 교육계획 및 성과 데이터 자동 참조
- **상담 이력 연동**: 최근 상담 내용 및 권장사항 자동 반영

#### 기본 정보 입력
- **대상 학생**: 드롭다운에서 선택 → 자동 컨텍스트 로드
- **학기**: 1학기/2학기 선택
- **월**: 3월~12월 선택 (방학 제외)
- **과목**: 국어, 수학, 사회, 과학, 예체능 등

#### 개별화 교육과정 연동
- **단원 선택**: 배정된 교육과정 단원 자동 로드 (현행수준 기반 필터링)
- **성취기준**: 선택된 단원의 성취기준 자동 로드 + 개별화 조정
- **교육내용**: 학생 특성에 맞는 세부 교육내용 자동 추천
- **선수학습 확인**: 필요한 선수 기술 보유 여부 자동 검증

#### AI 기반 개별화 교육계획 수립
- **개별화 목표**: 현행수준 + 개별 특성 기반 맞춤형 교육목표 AI 자동 생성
- **적응적 교수방법**: 학습 스타일 기반 최적 교수학습 방법 자동 추천
- **개별화 평가계획**: 학생 특성 고려한 평가 방법 및 기준 자동 설정
- **지원 계획**: 필요한 개별 지원 및 조정사항 자동 계획
- **주요날짜**: 학생 학습 속도 고려한 일정 및 평가일 자동 설정

### 4.3.2 AI 지원 기능

#### GPT 기반 자동 생성 (Alpine.js + Supabase Edge Functions)
```javascript
// Alpine.js 기반 AI 교육계획 생성 데이터 관리
function aiEducationPlanGenerator() {
  return {
    // AI 생성 요청 데이터
    generationRequest: {
      studentId: '',
      subject: '',
      unit: '',
      standards: [],
      teacherPreferences: {
        educationPhilosophy: '',    // 교육 철학
        preferredMethods: [],       // 선호 교수법
        writingStyle: 'formal',     // 문체 설정
        aiIntensity: 'medium'       // AI 강도
      }
    },
    
    // AI 생성 결과
    generationResponse: {
      educationGoal: '',          // 교육목표
      teachingMethods: [],        // 교수방법
      evaluationPlan: '',         // 평가계획
      confidence: 0,              // 신뢰도 (0.0-1.0)
      generatedAt: null,          // 생성 시간
      estimatedTime: 0            // 예상 소요 시간(분)
    },
    
    // 생성 상태
    isGenerating: false,
    generationProgress: 0,
    generationError: null,
    
    // AI 교육계획 생성 실행
    generateEducationPlan(studentId, subject, unit, standards) {
      this.isGenerating = true;
      this.generationProgress = 0;
      this.generationError = null;
      
      // UTF-8 안전성 검증
      const inputs = [subject, unit, ...standards];
      const validInputs = inputs.every(input => this.validateUTF8(input));
      
      if (!validInputs) {
        console.error('입력 내용에 UTF-8 인코딩 오류가 있습니다.');
        this.generationError = '입력 내용에 UTF-8 인코딩 오류가 있습니다.';
        this.isGenerating = false;
        return;
      }
      
      // 요청 데이터 설정
      this.generationRequest.studentId = studentId;
      this.generationRequest.subject = subject;
      this.generationRequest.unit = unit;
      this.generationRequest.standards = standards;
      
      this.generationProgress = 20;
      
      // Supabase Edge Function 호출
      fetch('/api/ai/generate-education-plan', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          ...this.generationRequest,
          teacherPreferences: this.generationRequest.teacherPreferences
        })
      })
      .then(response => {
        this.generationProgress = 60;
        
        if (!response.ok) {
          throw new Error(`AI 생성 실패: ${response.status}`);
        }
        
        return response.json();
      })
      .then(result => {
        // 생성 결과 저장
        this.generationResponse = {
          educationGoal: result.educationGoal || '',
          teachingMethods: result.teachingMethods || [],
          evaluationPlan: result.evaluationPlan || '',
          confidence: result.confidence || 0,
          generatedAt: new Date(),
          estimatedTime: result.estimatedTime || 0
        };
        
        this.generationProgress = 100;
        
        // 생성 이력 저장
        this.saveGenerationHistory();
      })
      .catch(error => {
        console.error('AI 교육계획 생성 오류:', error);
        this.generationError = error.message;
      })
      .finally(() => {
        this.isGenerating = false;
      });
    },
    
    // 생성 이력 저장
    saveGenerationHistory() {
      fetch('/api/ai/generation-history', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          request: this.generationRequest,
          response: this.generationResponse
        })
      })
      .catch(error => {
        console.error('생성 이력 저장 오류:', error);
      });
    }
    },
    
    // 교사 선호도 업데이트
    updateTeacherPreferences(preferences) {
      this.generationRequest.teacherPreferences = {
        ...this.generationRequest.teacherPreferences,
        ...preferences
      };
      
      // 로컬 스토리지에 저장
      localStorage.setItem('iepon_teacher_preferences', 
        JSON.stringify(this.generationRequest.teacherPreferences)
      );
    },
    
    // 선호도 불러오기
    loadTeacherPreferences() {
      try {
        const saved = localStorage.getItem('iepon_teacher_preferences');
        if (saved) {
          this.generationRequest.teacherPreferences = JSON.parse(saved);
        }
      } catch (error) {
        console.error('선호도 불러오기 오류:', error);
      }
    },
    
    // UTF-8 인코딩 검증
    validateUTF8(text) {
      try {
        const encoded = new TextEncoder().encode(text);
        const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
        return decoded === text;
      } catch (error) {
        return false;
      }
    },
    
    // 생성 결과 초기화
    resetGeneration() {
      this.generationResponse = {
        educationGoal: '',
        teachingMethods: [],
        evaluationPlan: '',
        confidence: 0,
        generatedAt: null,
        estimatedTime: 0
      };
      this.generationError = null;
      this.generationProgress = 0;
    }
  };
}
```

#### 개인화 설정 반영
- **교사 컨셉**: 교육 철학 및 접근 방식
- **선호 교수법**: 개별화, 협력학습, 체험학습 등
- **문체 설정**: 격식체/반말체, 친근함 정도
- **AI 강도**: 높음(80% 자동)/보통(50%)/낮음(20%)/없음

---

## 4.4 교육평가 실시 (Alpine.js + HTMX 기반 평가 시스템)

### 4.4.1 월별 평가 시스템

```javascript
// Alpine.js 기반 월별 평가 시스템 관리
function monthlyEvaluationSystem() {
  return {
    // 평가 데이터
    evaluation: {
      studentId: '',
      evaluationDate: new Date().toISOString().split('T')[0],
      subject: '',
      unit: '',
      evaluationType: 'performance', // 'performance', 'descriptive', 'comprehensive'
      
      // 개별화 평가 지원 데이터
      studentContext: {
        personalInfo: null,
        currentLevel: null,
        individualizationNeeds: [],
        supportRequirements: [],
        growthBaseline: null
      },
      
      // 수행 평가 데이터
      performanceEvaluation: {
        cognitiveScore: 0,      // 인지 영역 (1-5점)
        affectiveScore: 0,      // 정의 영역 (1-5점)
        psychomotorScore: 0,    // 심동 영역 (1-5점)
        overallScore: 0,        // 종합 점수
        adaptedCriteria: [],    // 적응적 평가 기준
        considerations: ''      // 개별화 고려사항
      },
      
      // 서술형 평가 데이터
      descriptiveEvaluation: {
        strengths: [],          // 강점 영역
        challenges: [],         // 도전 영역
        growthProgress: '',     // 성장 진전 사항
        improvementPlan: '',    // 개선 방향
        aiGenerated: false      // AI 생성 여부
      }
    },
    
    // UI 상태
    isLoading: false,
    isSaving: false,
    saveError: null,
    
    // 학생 선택 및 컨텍스트 로드
    selectStudent(studentId) {
      this.isLoading = true;
      
      // 학생 컨텍스트 자동 로드
      fetch(`/api/students/${studentId}/context`, {
        headers: {
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        }
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('학생 정보를 불러오는데 실패했습니다.');
        }
        return response.json();
      })
      .then(studentData => {
        // 학생 컨텍스트 설정
        this.evaluation.studentId = studentId;
        this.evaluation.studentContext = {
          personalInfo: studentData.personalInfo,
          currentLevel: studentData.currentLevel,
          individualizationNeeds: studentData.individualizationNeeds || [],
          supportRequirements: studentData.supportRequirements || [],
          growthBaseline: studentData.previousEvaluations?.latest || null
        };
        
        // 개별화 평가 기준 자동 조정
        this.adjustEvaluationCriteria();
      })
      .catch(error => {
        console.error('학생 컨텍스트 로드 오류:', error);
        this.saveError = error.message;
      })
      .finally(() => {
        this.isLoading = false;
      });
    },
    
    // 개별화 평가 기준 자동 조정
    adjustEvaluationCriteria() {
      fetch('/api/evaluation/adapt-criteria', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          studentContext: this.evaluation.studentContext,
          subject: this.evaluation.subject,
          unit: this.evaluation.unit
        })
      })
      .then(response => {
        if (response.ok) {
          return response.json();
        }
        return null;
      })
      .then(adaptedCriteria => {
        if (adaptedCriteria) {
          this.evaluation.performanceEvaluation.adaptedCriteria = adaptedCriteria.criteria || [];
        }
      })
      .catch(error => {
        console.error('평가 기준 조정 오류:', error);
      });
    },
    
    // 수행 평가 점수 입력 및 자동 계산
    updatePerformanceScore(domain, score) {
      // 점수 유효성 검증 (1-5점)
      if (score < 1 || score > 5) {
        this.saveError = '점수는 1-5점 사이여야 합니다.';
        return;
      }
      
      // 도메인별 점수 설정
      switch(domain) {
        case 'cognitive':
          this.evaluation.performanceEvaluation.cognitiveScore = score;
          break;
        case 'affective':
          this.evaluation.performanceEvaluation.affectiveScore = score;
          break;
        case 'psychomotor':
          this.evaluation.performanceEvaluation.psychomotorScore = score;
          break;
      }
      
      // 종합 점수 자동 계산
      this.calculateOverallScore();
      
      // 개별화 고려사항 자동 기록
      this.recordIndividualizedConsiderations(domain, score);
      
      this.saveError = null;
    },
    
    // 종합 점수 계산
    calculateOverallScore() {
      const scores = [
        this.evaluation.performanceEvaluation.cognitiveScore,
        this.evaluation.performanceEvaluation.affectiveScore,
        this.evaluation.performanceEvaluation.psychomotorScore
      ].filter(score => score > 0);
      
      if (scores.length > 0) {
        this.evaluation.performanceEvaluation.overallScore = 
          Math.round(scores.reduce((sum, score) => sum + score, 0) / scores.length * 10) / 10;
      }
    },
    
    // 개별화 고려사항 자동 기록
    recordIndividualizedConsiderations(domain, score) {
      const considerations = [];
      const studentNeeds = this.evaluation.studentContext.individualizationNeeds;
      
      // 학생 특성에 따른 고려사항 자동 생성
      if (studentNeeds.includes('시간연장')) {
        considerations.push(`${domain} 영역 평가 시 시간 연장 지원 적용`);
      }
      if (studentNeeds.includes('보조도구')) {
        considerations.push(`${domain} 영역 평가 시 보조도구 사용 허용`);
      }
      if (score >= 4) {
        considerations.push(`${domain} 영역에서 우수한 성과 달성`);
      } else if (score <= 2) {
        considerations.push(`${domain} 영역에서 추가 지원 필요`);
      }
      
      // 기존 고려사항에 추가
      const existingConsiderations = this.evaluation.performanceEvaluation.considerations;
      const newConsiderations = considerations.join(', ');
      
      if (existingConsiderations) {
        this.evaluation.performanceEvaluation.considerations = 
          `${existingConsiderations}; ${newConsiderations}`;
      } else {
        this.evaluation.performanceEvaluation.considerations = newConsiderations;
      }
    },
    
    // AI 기반 서술형 평가 생성
    generateDescriptiveEvaluation() {
      this.isLoading = true;
      
      fetch('/api/ai/generate-descriptive-evaluation', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          studentContext: this.evaluation.studentContext,
          performanceScores: this.evaluation.performanceEvaluation,
          subject: this.evaluation.subject,
          unit: this.evaluation.unit
        })
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('AI 평가 생성에 실패했습니다.');
        }
        return response.json();
      })
      .then(aiEvaluation => {
        this.evaluation.descriptiveEvaluation = {
          strengths: aiEvaluation.strengths || [],
          challenges: aiEvaluation.challenges || [],
          growthProgress: aiEvaluation.growthProgress || '',
          improvementPlan: aiEvaluation.improvementPlan || '',
          aiGenerated: true
        };
      })
      .catch(error => {
        console.error('AI 서술형 평가 생성 오류:', error);
        this.saveError = error.message;
      })
      .finally(() => {
        this.isLoading = false;
      });
    },
    
    // 평가 저장
    saveEvaluation() {
      // UTF-8 안전성 검증
      const evaluationData = JSON.stringify(this.evaluation);
      if (!this.validateUTF8(evaluationData)) {
        this.saveError = '평가 데이터에 UTF-8 인코딩 오류가 있습니다.';
        return;
      }
      
      this.isSaving = true;
      this.saveError = null;
      
      fetch('/api/monthly-evaluations', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: evaluationData
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('평가 저장에 실패했습니다.');
        }
        return response.json();
      })
      .then(savedEvaluation => {
        // 성공 메시지 표시
        this.$dispatch('evaluation-saved', { 
          evaluationId: savedEvaluation.id,
          studentId: this.evaluation.studentId 
        });
      })
      .catch(error => {
        console.error('평가 저장 오류:', error);
        this.saveError = error.message;
      })
      .finally(() => {
        this.isSaving = false;
      });
    },
    
    // UTF-8 인코딩 검증
    validateUTF8(text) {
      try {
        const encoded = new TextEncoder().encode(text);
        const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
        return decoded === text;
      } catch (error) {
        return false;
      }
    },
    
    // 평가 데이터 초기화
    resetEvaluation() {
      this.evaluation = {
        studentId: '',
        evaluationDate: new Date().toISOString().split('T')[0],
        subject: '',
        unit: '',
        evaluationType: 'performance',
        studentContext: {
          personalInfo: null,
          currentLevel: null,
          individualizationNeeds: [],
          supportRequirements: [],
          growthBaseline: null
        },
        performanceEvaluation: {
          cognitiveScore: 0,
          affectiveScore: 0,
          psychomotorScore: 0,
          overallScore: 0,
          adaptedCriteria: [],
          considerations: ''
        },
        descriptiveEvaluation: {
          strengths: [],
          challenges: [],
          growthProgress: '',
          improvementPlan: '',
          aiGenerated: false
        }
      };
      this.saveError = null;
    }
  };
}
```

#### 주요 기능

**개별화 평가 지원**
- **학생 컨텍스트 자동 로드**: 평가 대상 학생 선택 시 인적사항, 현행수준, 개별화 특성 자동 표시
- **개별화 평가 기준**: 학생의 개별 특성 및 지원 요구사항을 고려한 평가 기준 자동 조정
- **성장 기준점**: 이전 평가 결과 기반 개인별 성장 기준점 자동 설정
- **지원 조정 반영**: 보조도구, 시간 연장, 평가 방식 조정 등 자동 적용

**수행 평가**
- **적응적 평가 척도**: 학생 수준에 맞는 5점 척도 자동 조정
- **점수 입력**: 1-5점 숫자 입력 + 개별화 고려사항 자동 기록
- **개별화 기준**: 각 학생의 특성에 맞는 구체적 기준 자동 제시
- **다영역 평가**: 인지, 정의, 심동 영역별 개별화 평가

**서술형 평가**
- **개별화 평가문**: 학생 특성 및 성장 패턴 기반 맞춤형 평가문 작성
- **성장 추적 기록**: 이전 평가 대비 성장 사항 자동 분석 및 기록
- **강점 및 도전 영역**: 개별화 특성 기반 강점/도전 영역 자동 식별
- **맞춤형 개선 방향**: 학생별 최적 지도 방향 및 전략 자동 제안

**AI 기반 개별화 평가 지원**
- **컨텍스트 기반 평가문**: 학생 컨텍스트 반영 GPT 기반 개별화 평가문 생성
- **성장 패턴 분석**: 시간에 따른 학생 성장 패턴 자동 분석
- **비교 평가 연계**: 과거 평가와의 연관성 및 성장도 자동 분석
- **개별화 개선 제안**: 학생 특성 기반 맞춤형 교육 개선 방향 AI 제안
- **예측 모델**: 현재 성과 기반 향후 학습 성과 예측 및 지도 방안 제시

---

## 4.7 교사 개인화 및 컨셉 관리 (Alpine.js 기반 개인화 시스템)

### 4.7.1 개인화 설정

```javascript
// Alpine.js 기반 교사 개인화 관리
function teacherPersonalizationManager() {
  return {
    // 교사 개인화 프로필
    teacherProfile: {
      teacherId: '',
      
      // 대표 컨셉 설정
      concept: {
        educationPhilosophy: '',        // 교육 철학
        educationStyle: 'balanced',     // 교육 스타일
        preferredMethods: [],           // 선호 교수법
        evaluationApproach: 'comprehensive' // 평가 방식
      },
      
      // AI 자동생성 설정
      aiSettings: {
        generationIntensity: 'medium',  // 자동생성 강도
        generationScope: [],            // 생성 범위
        writingStyle: 'formal',         // 말투/문체
        forbiddenWords: []              // 금기어 목록
      },
      
      // 템플릿 관리
      templates: {
        greetings: [],                  // 인사말 템플릿
        encouragements: [],             // 격려 문구
        feedbackTemplates: [],          // 피드백 템플릿
        counselingGuides: []            // 상담 가이드
      }
    },
    
    // 사용 패턴 분석 데이터
    usageAnalytics: {
      featureUsage: {},               // 기능별 사용 빈도
      timePatterns: {},               // 시간대별 사용 패턴
      seasonalPatterns: {},           // 계절별 패턴
      studentManagementPatterns: {}   // 학생별 관리 패턴
    },
    
    // UI 상태
    isLoading: false,
    isSaving: false,
    saveError: null,
    activeTab: 'concept',           // 활성 탭
    
    // 대표 컨셉 설정 업데이트
    updateConcept(field, value) {
      // UTF-8 안전성 검증
      if (typeof value === 'string' && !this.validateUTF8(value)) {
        this.saveError = '입력 내용에 UTF-8 인코딩 오류가 있습니다.';
        return;
      }
      
      this.teacherProfile.concept[field] = value;
      this.saveError = null;
      
      // 자동 저장
      this.autoSaveProfile();
    },
    
    // AI 설정 업데이트
    updateAiSettings(setting, value) {
      if (setting === 'forbiddenWords' && Array.isArray(value)) {
        // 금기어 목록 UTF-8 검증
        const invalidWords = value.filter(word => !this.validateUTF8(word));
        if (invalidWords.length > 0) {
          this.saveError = '일부 금기어에 UTF-8 인코딩 오류가 있습니다.';
          return;
        }
      }
      
      this.teacherProfile.aiSettings[setting] = value;
      this.saveError = null;
      
      // AI 설정 즉시 적용
      this.applyAiSettings();
    },
    
    // 템플릿 추가
    addTemplate(category, template) {
      // UTF-8 안전성 검증
      if (!this.validateUTF8(JSON.stringify(template))) {
        this.saveError = '템플릿 내용에 UTF-8 인코딩 오류가 있습니다.';
        return;
      }
      
      if (!this.teacherProfile.templates[category]) {
        this.teacherProfile.templates[category] = [];
      }
      
      this.teacherProfile.templates[category].push({
        id: Date.now(),
        ...template,
        createdAt: new Date().toISOString()
      });
      
      this.saveProfile();
    },
    
    // 템플릿 수정
    updateTemplate(category, templateId, updatedTemplate) {
      const templates = this.teacherProfile.templates[category];
      const index = templates.findIndex(t => t.id === templateId);
      
      if (index !== -1) {
        // UTF-8 안전성 검증
        if (!this.validateUTF8(JSON.stringify(updatedTemplate))) {
          this.saveError = '템플릿 내용에 UTF-8 인코딩 오류가 있습니다.';
          return;
        }
        
        templates[index] = {
          ...templates[index],
          ...updatedTemplate,
          updatedAt: new Date().toISOString()
        };
        
        this.saveProfile();
      }
    },
    
    // 템플릿 삭제
    deleteTemplate(category, templateId) {
      const templates = this.teacherProfile.templates[category];
      const index = templates.findIndex(t => t.id === templateId);
      
      if (index !== -1) {
        templates.splice(index, 1);
        this.saveProfile();
      }
    },
    
    // 프로필 자동 저장
    autoSaveProfile() {
      // 디바운스 처리
      clearTimeout(this.autoSaveTimer);
      this.autoSaveTimer = setTimeout(() => {
        this.saveProfile();
      }, 2000);
    },
    
    // 프로필 저장
    saveProfile() {
      this.isSaving = true;
      this.saveError = null;
      
      fetch('/api/teacher/profile', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify(this.teacherProfile)
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('프로필 저장에 실패했습니다.');
        }
        return response;
      })
      .then(() => {
        // 성공 피드백
        this.$dispatch('profile-saved', { 
          teacherId: this.teacherProfile.teacherId 
        });
      })
      .catch(error => {
        console.error('프로필 저장 오류:', error);
        this.saveError = error.message;
      })
      .finally(() => {
        this.isSaving = false;
      });
    },
    
    // AI 설정 적용
    applyAiSettings() {
      fetch('/api/teacher/ai-settings', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify(this.teacherProfile.aiSettings)
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('AI 설정 적용에 실패했습니다.');
        }
        console.log('AI 설정이 성공적으로 적용되었습니다.');
      })
      .catch(error => {
        console.error('AI 설정 적용 오류:', error);
      });
    },
    
    // 사용 패턴 로드
    loadUsageAnalytics() {
      this.isLoading = true;
      
      fetch('/api/teacher/usage-analytics', {
        headers: {
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        }
      })
      .then(response => {
        if (response.ok) {
          return response.json();
        }
        throw new Error('사용 패턴 로드에 실패했습니다.');
      })
      .then(data => {
        this.usageAnalytics = data;
      })
      .catch(error => {
        console.error('사용 패턴 로드 오류:', error);
      })
      .finally(() => {
        this.isLoading = false;
      });
    },
    
    // UTF-8 인코딩 검증
    validateUTF8(text) {
      try {
        const encoded = new TextEncoder().encode(text);
        const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
        return decoded === text;
      } catch (error) {
        return false;
      }
    }
  };
}
```

**주요 개인화 기능:**

**대표 컨셉 설정**
- **교육 철학**: 교사의 교육 접근 방식 및 철학 설정
- **교육 스타일**: 엄격함/친근함, 구조적/자유로움 등 스타일 선택
- **선호 교수법**: 선호하는 교수 방법 및 전략 설정
- **평가 방식**: 선호하는 평가 방법 및 기준 설정

**AI 자동생성 설정**
- **자동생성 강도**: 높음/보통/낮음/없음 4단계 선택
- **생성 범위**: 교육목표, 교수법, 평가계획 등 범위 선택
- **말투/문체**: AI 생성 문서의 톤앤매너 개인화
- **금기어 설정**: 사용하지 않을 단어/표현 등록

**템플릿 관리**
- **인사말 템플릿**: 자주 사용하는 인사말 등록/관리
- **격려 문구**: 학생 격려용 문구 라이브러리
- **피드백 템플릿**: 평가 및 피드백용 문구 모음
- **상담 가이드**: 상담 시 활용할 가이드 템플릿

### 4.7.2 사용 패턴 분석
**기능 개요**: 교사의 시스템 사용 패턴을 분석하여 맞춤형 서비스 제공

#### 사용 경향 분석
- **기능별 사용 빈도**: 자주 사용하는 기능 및 패턴 분석
- **시간대별 사용**: 주로 사용하는 시간대 분석
- **계절별 패턴**: 학기별, 월별 사용 패턴 분석
- **학생별 관리**: 학생별 관리 패턴 및 특성 분석

#### 맞춤형 추천
- **기능 추천**: 사용 패턴 기반 유용한 기능 추천
- **템플릿 추천**: 개인 스타일에 맞는 템플릿 추천
- **일정 추천**: 업무 패턴 기반 일정 관리 추천
- **자동 리포트**: 주기적 사용 경향 분석 리포트

---

## 4.8 행정·상담 지원 도구 (Alpine.js + Chart.js 기반 분석 시스템)

### 4.8.1 학생 현황 집계

```javascript
// Alpine.js 기반 학생 현황 집계 시스템
function studentStatisticsManager() {
  return {
    // 집계 설정
    aggregationSettings: {
      baseDate: new Date().toISOString().split('T')[0],
      filters: {
        integrationTypes: [],     // 통합유형 필터
        disabilityTypes: [],      // 장애유형 필터
        grades: [],               // 학년 필터
        schools: [],              // 학교 필터
        regions: []               // 지역 필터
      },
      comparisonPeriod: 'monthly', // 'daily', 'weekly', 'monthly', 'yearly'
      groupBy: 'disabilityType'    // 집계 기준
    },
    
    // 집계 결과 데이터
    statistics: {
      totalCount: 0,
      byDisabilityType: {},
      byIntegrationType: {},
      byGrade: {},
      bySchool: {},
      byRegion: {},
      trends: [],
      comparisons: []
    },
    
    // 차트 데이터
    chartData: {
      pieChart: null,
      barChart: null,
      trendChart: null,
      heatmapData: null
    },
    
    // UI 상태
    isLoading: false,
    isGeneratingReport: false,
    reportError: null,
    activeChart: 'pie',
    
    // 집계 실행
    executeAggregation() {
      this.isLoading = true;
      this.reportError = null;
      
      fetch('/api/statistics/student-aggregation', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          baseDate: this.aggregationSettings.baseDate,
          filters: this.aggregationSettings.filters,
          comparisonPeriod: this.aggregationSettings.comparisonPeriod,
          groupBy: this.aggregationSettings.groupBy
        })
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('집계 실행에 실패했습니다.');
        }
        return response.json();
      })
      .then(aggregationData => {
        // 집계 결과 저장
        this.statistics = {
          totalCount: aggregationData.totalCount || 0,
          byDisabilityType: aggregationData.byDisabilityType || {},
          byIntegrationType: aggregationData.byIntegrationType || {},
          byGrade: aggregationData.byGrade || {},
          bySchool: aggregationData.bySchool || {},
          byRegion: aggregationData.byRegion || {},
          trends: aggregationData.trends || [],
          comparisons: aggregationData.comparisons || []
        };
        
        // 차트 데이터 생성
        this.generateChartData();
        
        // 실시간 업데이트 설정
        this.setupRealTimeUpdates();
      })
      .catch(error => {
        console.error('집계 실행 오류:', error);
        this.reportError = error.message;
      })
      .finally(() => {
        this.isLoading = false;
      });
    },
    
    // 차트 데이터 생성
    generateChartData() {
      // 파이 차트 데이터 (장애유형별)
      this.chartData.pieChart = {
        labels: Object.keys(this.statistics.byDisabilityType),
        datasets: [{
          data: Object.values(this.statistics.byDisabilityType),
          backgroundColor: [
            '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0',
            '#9966FF', '#FF9F40', '#FF6384', '#C9CBCF'
          ]
        }]
      };
      
      // 막대 차트 데이터 (학년별)
      this.chartData.barChart = {
        labels: Object.keys(this.statistics.byGrade),
        datasets: [{
          label: '학생 수',
          data: Object.values(this.statistics.byGrade),
          backgroundColor: '#36A2EB',
          borderColor: '#36A2EB',
          borderWidth: 1
        }]
      };
      
      // 트렌드 차트 데이터
      this.chartData.trendChart = {
        labels: this.statistics.trends.map(t => t.date),
        datasets: [{
          label: '학생 수 변화',
          data: this.statistics.trends.map(t => t.count),
          borderColor: '#4BC0C0',
          backgroundColor: 'rgba(75, 192, 192, 0.2)',
          tension: 0.1
        }]
      };
      
      // 히트맵 데이터 (지역별, 학교별)
      this.chartData.heatmapData = this.processHeatmapData();
    },
    
    // 히트맵 데이터 처리
    processHeatmapData() {
      const heatmapData = [];
      
      Object.entries(this.statistics.byRegion).forEach(([region, count]) => {
        Object.entries(this.statistics.bySchool).forEach(([school, schoolCount]) => {
          heatmapData.push({
            x: region,
            y: school,
            v: schoolCount
          });
        });
      });
      
      return heatmapData;
    },
    
    // 실시간 업데이트 설정
    setupRealTimeUpdates() {
      // 5분마다 자동 업데이트
      if (this.updateInterval) {
        clearInterval(this.updateInterval);
      }
      
      this.updateInterval = setInterval(() => {
        this.executeAggregation();
      }, 300000); // 5분
    },
    
    // 필터 업데이트
    updateFilter(filterType, values) {
      this.aggregationSettings.filters[filterType] = values;
      // 실시간 집계 실행
      this.executeAggregation();
    },
    
    // Excel 출력
    exportToExcel() {
      this.isGeneratingReport = true;
      this.reportError = null;
      
      fetch('/api/statistics/export-excel', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          statistics: this.statistics,
          filters: this.aggregationSettings.filters,
          baseDate: this.aggregationSettings.baseDate
        })
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Excel 파일 생성에 실패했습니다.');
        }
        return response.blob();
      })
      .then(blob => {
        // 파일 다운로드
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `학생현황집계_${this.aggregationSettings.baseDate}.xlsx`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
      })
      .catch(error => {
        console.error('Excel 출력 오류:', error);
        this.reportError = error.message;
      })
      .finally(() => {
        this.isGeneratingReport = false;
      });
    },
    
    // PDF 출력
    exportToPDF() {
      this.isGeneratingReport = true;
      this.reportError = null;
      
      fetch('/api/statistics/export-pdf', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          statistics: this.statistics,
          chartData: this.chartData,
          filters: this.aggregationSettings.filters,
          baseDate: this.aggregationSettings.baseDate
        })
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('PDF 파일 생성에 실패했습니다.');
        }
        return response.blob();
      })
      .then(blob => {
        // 파일 다운로드
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `학생현황집계_${this.aggregationSettings.baseDate}.pdf`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
      })
      .catch(error => {
        console.error('PDF 출력 오류:', error);
        this.reportError = error.message;
      })
      .finally(() => {
        this.isGeneratingReport = false;
      });
    },
    
    // 비교 분석 실행
    executeComparison() {
      fetch('/api/statistics/comparison-analysis', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          baseDate: this.aggregationSettings.baseDate,
          comparisonPeriod: this.aggregationSettings.comparisonPeriod,
          filters: this.aggregationSettings.filters
        })
      })
      .then(response => {
        if (response.ok) {
          return response.json();
        }
        throw new Error('비교 분석에 실패했습니다.');
      })
      .then(comparisonData => {
        this.statistics.comparisons = comparisonData.comparisons || [];
      })
      .catch(error => {
        console.error('비교 분석 오류:', error);
      });
    },
    
    // 초기화 시 실행
    init() {
      // 초기 집계 실행
      this.executeAggregation();
      
      // 필터 옵션 로드
      this.loadFilterOptions();
    },
    
    // 필터 옵션 로드
    loadFilterOptions() {
      fetch('/api/statistics/filter-options', {
        headers: {
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        }
      })
      .then(response => {
        if (response.ok) {
          return response.json();
        }
        throw new Error('필터 옵션 로드에 실패했습니다.');
      })
      .then(options => {
        this.filterOptions = options;
      })
      .catch(error => {
        console.error('필터 옵션 로드 오류:', error);
      });
    },
    
    // 정리
    destroy() {
      if (this.updateInterval) {
        clearInterval(this.updateInterval);
      }
    }
  };
}
```

**주요 집계 기능:**

**집계 기능**
- **기준일 설정**: 특정 날짜 기준 학생 현황 집계
- **다중 필터링**: 통합유형, 장애유형, 학년별 복합 필터링
- **실시간 집계**: 데이터 변경 시 실시간 집계 업데이트
- **비교 분석**: 기간별, 학기별 현황 비교 분석

**시각화 차트**
- **파이 차트**: 장애유형별, 통합유형별 비율 표시
- **막대 차트**: 학년별, 학교별 학생 수 비교
- **트렌드 차트**: 시간에 따른 학생 수 변화 추이
- **히트맵**: 지역별, 학교별 분포 현황

**명단 출력**
- **Excel 출력**: 상세 학생 명단 Excel 파일 생성
- **PDF 출력**: 공식 문서 형태 PDF 생성
- **필터링 출력**: 선택된 조건에 맞는 명단만 출력
- **템플릿 적용**: 기관별 양식에 맞는 출력 템플릿

### 4.8.2 학교장 의견서 자동생성 (Alpine.js + AI 문서 생성 시스템)

```javascript
// Alpine.js 기반 학교장 의견서 자동생성 시스템
function principalOpinionGenerator() {
  return {
    // 의견서 데이터
    opinion: {
      studentId: '',
      opinionType: 'new_placement', // 'new_placement', 'reselection', 'relocation', 'cancellation'
      
      // 자동 연동 데이터
      studentData: {
        personalInfo: null,
        currentLevel: null,
        educationPlan: null,
        evaluationResults: null
      },
      
      // 의견서 내용
      content: {
        studentOverview: '',        // 학생 개요
        currentStatus: '',          // 현재 상황
        educationalNeeds: '',       // 교육적 요구
        recommendation: '',         // 배치 의견
        supportPlan: '',           // 지원 계획
        expectedOutcomes: '',      // 기대 효과
        additionalComments: ''     // 추가 의견
      },
      
      // 생성 설정
      generationSettings: {
        template: 'standard',      // 템플릿 유형
        educationOffice: '',       // 교육청
        writingStyle: 'formal',    // 문체
        detailLevel: 'medium'      // 상세도
      }
    },
    
    // UI 상태
    isLoading: false,
    isGenerating: false,
    isSaving: false,
    saveError: null,
    generationProgress: 0,
    
    // 학생 선택 및 데이터 로드
    selectStudent(studentId) {
      this.isLoading = true;
      this.saveError = null;
      
      fetch(`/api/students/${studentId}/complete-data`, {
        headers: {
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        }
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('학생 데이터를 불러오는데 실패했습니다.');
        }
        return response.json();
      })
      .then(studentData => {
        // 학생 데이터 설정
        this.opinion.studentId = studentId;
        this.opinion.studentData = {
          personalInfo: studentData.personalInfo,
          currentLevel: studentData.currentLevel,
          educationPlan: studentData.educationPlan,
          evaluationResults: studentData.evaluationResults
        };
        
        // 기본 의견서 내용 자동 생성
        this.generateBasicContent();
      })
      .catch(error => {
        console.error('학생 데이터 로드 오류:', error);
        this.saveError = error.message;
      })
      .finally(() => {
        this.isLoading = false;
      });
    },
    
    // 기본 의견서 내용 자동 생성
    generateBasicContent() {
      const studentInfo = this.opinion.studentData.personalInfo;
      const currentLevel = this.opinion.studentData.currentLevel;
      
      if (studentInfo && currentLevel) {
        // 학생 개요 자동 생성
        this.opinion.content.studentOverview = 
          `${studentInfo.name}(${studentInfo.birthDate}) 학생은 ${studentInfo.disabilityType} 장애를 가진 학생으로, ` +
          `현재 ${currentLevel.academicLevel} 수준의 학습 능력을 보이고 있습니다.`;
        
        // 현재 상황 자동 생성
        this.opinion.content.currentStatus = 
          `학생의 현행 수준 평가 결과, ${currentLevel.strengths?.join(', ')} 영역에서 강점을 보이며, ` +
          `${currentLevel.challenges?.join(', ')} 영역에서 추가 지원이 필요한 상황입니다.`;
      }
    },
    
    // AI 기반 의견서 전체 생성
    generateFullOpinion() {
      // UTF-8 안전성 검증
      const studentDataString = JSON.stringify(this.opinion.studentData);
      if (!this.validateUTF8(studentDataString)) {
        this.saveError = '학생 데이터에 UTF-8 인코딩 오류가 있습니다.';
        return;
      }
      
      this.isGenerating = true;
      this.generationProgress = 0;
      this.saveError = null;
      
      fetch('/api/ai/generate-principal-opinion', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          studentData: this.opinion.studentData,
          opinionType: this.opinion.opinionType,
          generationSettings: this.opinion.generationSettings,
          teacherPreferences: Alpine.store('teacherPersonalization')?.teacherProfile || {}
        })
      })
      .then(response => {
        this.generationProgress = 30;
        
        if (!response.ok) {
          throw new Error('AI 의견서 생성에 실패했습니다.');
        }
        return response.json();
      })
      .then(aiOpinion => {
        this.generationProgress = 70;
        
        // 생성된 의견서 내용 적용
        this.opinion.content = {
          studentOverview: aiOpinion.studentOverview || '',
          currentStatus: aiOpinion.currentStatus || '',
          educationalNeeds: aiOpinion.educationalNeeds || '',
          recommendation: aiOpinion.recommendation || '',
          supportPlan: aiOpinion.supportPlan || '',
          expectedOutcomes: aiOpinion.expectedOutcomes || '',
          additionalComments: aiOpinion.additionalComments || ''
        };
        
        this.generationProgress = 100;
        
        // 생성 완료 이벤트
        this.$dispatch('opinion-generated', {
          studentId: this.opinion.studentId,
          opinionType: this.opinion.opinionType
        });
      })
      .catch(error => {
        console.error('AI 의견서 생성 오류:', error);
        this.saveError = error.message;
      })
      .finally(() => {
        this.isGenerating = false;
        this.generationProgress = 0;
      });
    },
    
    // 의견서 내용 수정
    updateContent(section, content) {
      // UTF-8 안전성 검증
      if (!this.validateUTF8(content)) {
        this.saveError = '입력 내용에 UTF-8 인코딩 오류가 있습니다.';
        return;
      }
      
      this.opinion.content[section] = content;
      this.saveError = null;
      
      // 자동 저장
      this.autoSave();
    },
    
    // 템플릿 적용
    applyTemplate(templateType) {
      fetch(`/api/templates/principal-opinion/${templateType}`, {
        headers: {
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        }
      })
      .then(response => {
        if (response.ok) {
          return response.json();
        }
        throw new Error('템플릿 적용에 실패했습니다.');
      })
      .then(template => {
        // 템플릿을 현재 학생 데이터에 맞게 적용
        this.applyTemplateToContent(template);
      })
      .catch(error => {
        console.error('템플릿 적용 오류:', error);
        this.saveError = '템플릿 적용에 실패했습니다.';
      });
    },
    
    // 템플릿 내용 적용
    applyTemplateToContent(template) {
      const studentInfo = this.opinion.studentData.personalInfo;
      
      // 템플릿의 placeholder를 실제 데이터로 치환
      Object.keys(this.opinion.content).forEach(key => {
        if (template[key]) {
          let content = template[key];
          
          // 학생 정보 치환
          if (studentInfo) {
            content = content.replace(/\{student_name\}/g, studentInfo.name || '');
            content = content.replace(/\{birth_date\}/g, studentInfo.birthDate || '');
            content = content.replace(/\{disability_type\}/g, studentInfo.disabilityType || '');
            content = content.replace(/\{grade\}/g, studentInfo.grade || '');
          }
          
          this.opinion.content[key] = content;
        }
      });
    },
    
    // 의견서 저장
    saveOpinion() {
      this.isSaving = true;
      this.saveError = null;
      
      fetch('/api/principal-opinions', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify(this.opinion)
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('의견서 저장에 실패했습니다.');
        }
        return response.json();
      })
      .then(savedOpinion => {
        // 저장 완료 이벤트
        this.$dispatch('opinion-saved', {
          opinionId: savedOpinion.id,
          studentId: this.opinion.studentId
        });
      })
      .catch(error => {
        console.error('의견서 저장 오류:', error);
        this.saveError = error.message;
      })
      .finally(() => {
        this.isSaving = false;
      });
    },
    
    // 자동 저장
    autoSave() {
      clearTimeout(this.autoSaveTimer);
      this.autoSaveTimer = setTimeout(() => {
        this.saveOpinion();
      }, 3000);
    },
    
    // PDF 출력
    exportToPDF() {
      fetch('/api/principal-opinions/export-pdf', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          opinion: this.opinion,
          template: this.opinion.generationSettings.template
        })
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('PDF 생성에 실패했습니다.');
        }
        return response.blob();
      })
      .then(blob => {
        // PDF 다운로드
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `학교장의견서_${this.opinion.studentData.personalInfo?.name || 'student'}_${new Date().toISOString().split('T')[0]}.pdf`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
      })
      .catch(error => {
        console.error('PDF 출력 오류:', error);
        this.saveError = error.message;
      });
    },
    
    // UTF-8 인코딩 검증
    validateUTF8(text) {
      try {
        const encoded = new TextEncoder().encode(text);
        const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
        return decoded === text;
      } catch (error) {
        return false;
      }
    },
    
    // 의견서 초기화
    resetOpinion() {
      this.opinion = {
        studentId: '',
        opinionType: 'new_placement',
        studentData: {
          personalInfo: null,
          currentLevel: null,
          educationPlan: null,
          evaluationResults: null
        },
        content: {
          studentOverview: '',
          currentStatus: '',
          educationalNeeds: '',
          recommendation: '',
          supportPlan: '',
          expectedOutcomes: '',
          additionalComments: ''
        },
        generationSettings: {
          template: 'standard',
          educationOffice: '',
          writingStyle: 'formal',
          detailLevel: 'medium'
        }
      };
      this.saveError = null;
    }
  };
}
```

**주요 기능:**

**의견서 유형**
- **신규 배치**: 신규 특수교육 대상자 배치 의견서
- **재선정**: 기존 학생 재선정 의견서
- **재배치**: 교육환경 재배치 의견서
- **선정취소**: 특수교육 대상자 선정취소 의견서

**자동 데이터 연동**
- **학생 정보**: 기본 인적사항 자동 삽입
- **현행수준**: 현행수준 평가 결과 연동
- **교육계획**: 개별화교육계획 내용 연동
- **평가 결과**: 교육평가 결과 및 성장 기록 연동

**AI 의견문 생성**
- **GPT 기반**: GPT-4 기반 전문적 의견문 생성
- **템플릿 활용**: 교육청별, 유형별 템플릿 적용
- **개인화 반영**: 교사 개인화 설정 반영
- **검토 및 수정**: 생성된 의견문 검토 및 수정 기능

### 4.8.3 상담록/상담가이드 생성 (Alpine.js + AI 상담 지원 시스템)

```javascript
// Alpine.js 기반 상담록/상담가이드 생성 시스템
function counselingRecordManager() {
  return {
    // 상담 기록 데이터
    counselingRecord: {
      id: null,
      studentId: '',
      counselingType: 'individual', // 'individual', 'parent', 'group', 'expert'
      counselingDate: new Date().toISOString().split('T')[0],
      duration: 60, // 분
      
      // 참가자 정보
      participants: {
        student: null,
        parents: [],
        teachers: [],
        experts: []
      },
      
      // 상담 내용
      content: {
        purpose: '',           // 상담 목적
        currentSituation: '',  // 현재 상황
        concerns: [],          // 주요 관심사항
        discussions: [],       // 논의 내용
        agreements: [],        // 합의 사항
        actionPlan: [],        // 실행 계획
        followUpDate: null     // 추후 상담 일정
      },
      
      // AI 분석 결과
      aiAnalysis: {
        studentDataAnalysis: null,  // 학생 데이터 분석
        growthPatterns: null,       // 성장 패턴 분석
        recommendations: [],        // AI 추천사항
        riskFactors: [],           // 위험 요소
        strengthAreas: []          // 강점 영역
      }
    },
    
    // 상담 가이드
    counselingGuide: {
      selectedDisability: '',
      developmentalStage: '',
      problemType: '',
      
      guidelines: {
        preparation: [],    // 상담 준비사항
        approaches: [],     // 상담 접근법
        techniques: [],     // 상담 기법
        questions: [],      // 핵심 질문
        precautions: []     // 주의사항
      }
    },
    
    // UI 상태
    isLoading: false,
    isSaving: false,
    isAnalyzing: false,
    saveError: null,
    activeTab: 'record', // 'record', 'guide', 'analysis'
    
    // 학생 선택 및 데이터 로드
    selectStudent(studentId) {
      this.isLoading = true;
      this.saveError = null;
      
      // 학생 데이터 로드 (순차적 로딩)
      fetch(`/api/students/${studentId}/complete-data`, {
        headers: { 'Authorization': `Bearer ${Alpine.store('auth').token}` }
      })
      .then(studentResponse => {
        if (!studentResponse.ok) {
          throw new Error('학생 정보를 불러오는데 실패했습니다.');
        }
        return studentResponse.json();
      })
      .then(studentData => {
        // 학생 정보 설정
        this.counselingRecord.studentId = studentId;
        this.counselingRecord.participants.student = studentData.personalInfo;
        
        // 상담 이력 로드
        return fetch(`/api/counseling/history/${studentId}`, {
          headers: { 'Authorization': `Bearer ${Alpine.store('auth').token}` }
        })
        .then(historyResponse => {
          const historyData = historyResponse.ok ? historyResponse.json() : Promise.resolve([]);
          return Promise.all([Promise.resolve(studentData), historyData]);
        });
      })
      .then(([studentData, historyData]) => {
        // AI 기반 상담 포인트 자동 생성
        this.generateCounselingPoints(studentData, historyData);
        
        // 장애별 상담 가이드 로드
        this.loadCounselingGuide(
          studentData.personalInfo?.disabilityType,
          studentData.currentLevel?.developmentalStage
        );
      })
      .catch(error => {
        console.error('학생 데이터 로드 오류:', error);
        this.saveError = error.message;
      })
      .finally(() => {
        this.isLoading = false;
      });
    },
    
    // AI 기반 상담 포인트 생성
    generateCounselingPoints(studentData, historyData) {
      this.isAnalyzing = true;
      
      fetch('/api/ai/generate-counseling-points', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          studentData: studentData,
          counselingHistory: historyData,
          counselingType: this.counselingRecord.counselingType
        })
      })
      .then(response => {
        if (response.ok) {
          return response.json();
        }
        throw new Error('AI 상담 포인트 생성에 실패했습니다.');
      })
      .then(analysis => {
        this.counselingRecord.aiAnalysis = {
          studentDataAnalysis: analysis.dataAnalysis || null,
          growthPatterns: analysis.growthPatterns || null,
          recommendations: analysis.recommendations || [],
          riskFactors: analysis.riskFactors || [],
          strengthAreas: analysis.strengthAreas || []
        };
        
        // AI 분석 결과를 바탕으로 상담 목적 자동 설정
        if (analysis.recommendations.length > 0) {
          this.counselingRecord.content.purpose = 
            `다음 영역에 대한 상담: ${analysis.recommendations.slice(0, 3).join(', ')}`;
        }
      })
      .catch(error => {
        console.error('AI 상담 포인트 생성 오류:', error);
      })
      .finally(() => {
        this.isAnalyzing = false;
      });
    },
    
    // 상담 가이드 로드
    loadCounselingGuide(disabilityType, developmentalStage) {
      fetch('/api/counseling/guide', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          disabilityType: disabilityType,
          developmentalStage: developmentalStage,
          counselingType: this.counselingRecord.counselingType
        })
      })
      .then(response => {
        if (response.ok) {
          return response.json();
        }
        throw new Error('상담 가이드 로드에 실패했습니다.');
      })
      .then(guide => {
        this.counselingGuide = {
          selectedDisability: disabilityType,
          developmentalStage: developmentalStage,
          problemType: '',
          guidelines: {
            preparation: guide.preparation || [],
            approaches: guide.approaches || [],
            techniques: guide.techniques || [],
            questions: guide.questions || [],
            precautions: guide.precautions || []
          }
        };
      })
      .catch(error => {
        console.error('상담 가이드 로드 오류:', error);
      });
    },
    
    // 상담 내용 업데이트
    updateContent(field, value) {
      // UTF-8 안전성 검증
      if (typeof value === 'string' && !this.validateUTF8(value)) {
        this.saveError = '입력 내용에 UTF-8 인코딩 오류가 있습니다.';
        return;
      }
      
      this.counselingRecord.content[field] = value;
      this.saveError = null;
      
      // 자동 저장
      this.autoSave();
    },
    
    // 참가자 추가
    addParticipant(type, participant) {
      if (!this.counselingRecord.participants[type]) {
        this.counselingRecord.participants[type] = [];
      }
      
      // UTF-8 안전성 검증
      if (!this.validateUTF8(JSON.stringify(participant))) {
        this.saveError = '참가자 정보에 UTF-8 인코딩 오류가 있습니다.';
        return;
      }
      
      this.counselingRecord.participants[type].push({
        id: Date.now(),
        ...participant,
        addedAt: new Date().toISOString()
      });
      
      this.autoSave();
    },
    
    // 논의 내용 추가
    addDiscussion(discussion) {
      // UTF-8 안전성 검증
      if (!this.validateUTF8(discussion)) {
        this.saveError = '논의 내용에 UTF-8 인코딩 오류가 있습니다.';
        return;
      }
      
      this.counselingRecord.content.discussions.push({
        id: Date.now(),
        content: discussion,
        timestamp: new Date().toISOString(),
        speaker: Alpine.store('auth').user?.name || 'Unknown'
      });
      
      this.autoSave();
    },
    
    // 실행 계획 추가
    addActionPlan(plan) {
      // UTF-8 안전성 검증
      if (!this.validateUTF8(JSON.stringify(plan))) {
        this.saveError = '실행 계획에 UTF-8 인코딩 오류가 있습니다.';
        return;
      }
      
      this.counselingRecord.content.actionPlan.push({
        id: Date.now(),
        task: plan.task,
        responsible: plan.responsible,
        deadline: plan.deadline,
        status: 'pending', // 'pending', 'in_progress', 'completed'
        createdAt: new Date().toISOString()
      });
      
      this.autoSave();
    },
    
    // 상담 기록 저장
    saveCounselingRecord() {
      this.isSaving = true;
      this.saveError = null;
      
      const method = this.counselingRecord.id ? 'PUT' : 'POST';
      const url = this.counselingRecord.id 
        ? `/api/counseling/${this.counselingRecord.id}`
        : '/api/counseling';
      
      fetch(url, {
        method: method,
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify(this.counselingRecord)
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('상담 기록 저장에 실패했습니다.');
        }
        return response.json();
      })
      .then(savedRecord => {
        this.counselingRecord.id = savedRecord.id;
        
        // 저장 완료 이벤트
        this.$dispatch('counseling-saved', {
          recordId: savedRecord.id,
          studentId: this.counselingRecord.studentId
        });
      })
      .catch(error => {
        console.error('상담 기록 저장 오류:', error);
        this.saveError = error.message;
      })
      .finally(() => {
        this.isSaving = false;
      });
    },
    
    // 자동 저장
    autoSave() {
      clearTimeout(this.autoSaveTimer);
      this.autoSaveTimer = setTimeout(() => {
        this.saveCounselingRecord();
      }, 5000);
    },
    
    // 상담 보고서 생성
    generateReport() {
      fetch('/api/counseling/generate-report', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          recordId: this.counselingRecord.id,
          includeAnalysis: true,
          includeGuide: true
        })
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('보고서 생성에 실패했습니다.');
        }
        return response.blob();
      })
      .then(blob => {
        // PDF 다운로드
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `상담보고서_${this.counselingRecord.participants.student?.name || 'student'}_${this.counselingRecord.counselingDate}.pdf`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
      })
      .catch(error => {
        console.error('보고서 생성 오류:', error);
        this.saveError = error.message;
      });
    },
    
    // UTF-8 인코딩 검증
    validateUTF8(text) {
      try {
        const encoded = new TextEncoder().encode(text);
        const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
        return decoded === text;
      } catch (error) {
        return false;
      }
    },
    
    // 상담 기록 초기화
    resetRecord() {
      this.counselingRecord = {
        id: null,
        studentId: '',
        counselingType: 'individual',
        counselingDate: new Date().toISOString().split('T')[0],
        duration: 60,
        participants: {
          student: null,
          parents: [],
          teachers: [],
          experts: []
        },
        content: {
          purpose: '',
          currentSituation: '',
          concerns: [],
          discussions: [],
          agreements: [],
          actionPlan: [],
          followUpDate: null
        },
        aiAnalysis: {
          studentDataAnalysis: null,
          growthPatterns: null,
          recommendations: [],
          riskFactors: [],
          strengthAreas: []
        }
      };
      this.saveError = null;
    }
  };
}
```

**주요 기능:**

**상담 유형**
- **개별 상담**: 학생 개별 상담 기록
- **학부모 상담**: 학부모와의 상담 기록
- **집단 상담**: 여러 학생 대상 집단 상담
- **전문가 상담**: 전문가와의 협의 상담

**상담 내용 자동 추출**
- **학생 데이터 분석**: 학생 데이터 기반 상담 포인트 제안
- **성장 패턴**: 학습 및 행동 성장 패턴 분석
- **관심사항**: 주의 깊게 관찰해야 할 사항 추출
- **개선 방안**: 구체적 개선 방안 및 전략 제안

**전문적 상담 가이드**
- **특수교육학 기반**: 특수교육학 이론 기반 상담 전략
- **장애별 가이드**: 장애 유형별 맞춤형 상담 가이드
- **발달 단계별**: 학생 발달 단계별 상담 접근법
- **문제 상황별**: 특정 문제 상황별 대응 가이드

---

## 4.8 교사 개인화/컴셉 관리

### 4.8.1 개인화 설정
**기능 개요**: 교사의 교육 철학 및 선호도를 반영한 개인화 설정

#### 대표 컴셉 설정
- **교육 철학**: 교사의 교육 철학 및 접근 방식 설정
- **말투/문체**: AI 생성 문서의 톤앤매너 개인화
- **상담 방법**: 선호하는 상담 및 피드백 방식 설정
- **AI 자동생성 강도**: 높음/보통/낮음/없음 선택

#### 템플릿 관리
- **인사말 템플릿**: 자주 사용하는 인사말 등록/관리
- **격려 문구**: 학생 격려용 문구 라이브러리
- **피드백 템플릿**: 평가 및 피드백용 문구 모음
- **금기어 설정**: 사용하지 않을 단어/표현 등록

#### 사용 경향 분석
- **사용 패턴**: 기능별 사용 빈도 및 패턴 분석
- **추천 시스템**: 사용 패턴 기반 맞춤형 추천
- **자동 리포트**: 주기적 사용 경향 분석 리포트

### 4.8.2 개인화 설정 인터페이스 (Alpine.js 데이터 구조)

```javascript
// Alpine.js 기반 교사 개인화 설정 데이터 구조
const teacherPersonalizationData = {
  // 기본 정보
  id: null,
  userId: '',
  
  // 교육 철학 및 스타일
  mainConcept: '',                    // 주요 교육 철학
  toneStyle: 'professional',          // 'formal', 'friendly', 'professional', 'casual'
  counselingMethod: '',               // 선호 상담 방법
  aiGenerationLevel: 'medium',        // 'high', 'medium', 'low', 'none'
  
  // 템플릿 관리
  greetingTemplates: [],              // 인사말 템플릿 배열
  encouragementPhrases: [],           // 격려 문구 배열
  feedbackTemplates: [],              // 피드백 템플릿 배열
  forbiddenWords: [],                 // 금기어 배열
  
  // 사용 패턴 분석
  usagePatterns: [],                  // 사용 패턴 데이터
  
  // 메타데이터
  createdAt: null,
  updatedAt: null,
  
  // UTF-8 안전성 검증 메소드
  validateUTF8(text) {
    try {
      const encoded = new TextEncoder().encode(text);
      const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
      return decoded === text;
    } catch (error) {
      return false;
    }
  },
  
  // 템플릿 추가 메소드
  addTemplate(type, template) {
    if (!this.validateUTF8(template)) {
      throw new Error('템플릿에 UTF-8 인코딩 오류가 있습니다.');
    }
    
    const templateArray = this[type] || [];
    templateArray.push({
      id: Date.now(),
      content: template,
      createdAt: new Date().toISOString(),
      usageCount: 0
    });
    
    this[type] = templateArray;
  },
  
  // 사용 패턴 업데이트 메소드
  updateUsagePattern(feature) {
    const pattern = this.usagePatterns.find(p => p.feature === feature);
    
    if (pattern) {
      pattern.frequency += 1;
      pattern.lastUsed = new Date().toISOString();
    } else {
      this.usagePatterns.push({
        feature: feature,
        frequency: 1,
        lastUsed: new Date().toISOString()
      });
    }
  }
};
```

---

## 4.9 행정·상담 지원 도구

### 4.9.1 학생 현황 집계
**기능 개요**: 특정 기준일 및 조건에 따른 학생 현황 집계 및 분석

#### 기준일 설정
- **특정 날짜 기준**: 원하는 날짜 기준 학생 현황 집계
- **학기별 집계**: 1학기/2학기 구분 집계
- **월별 집계**: 월별 학생 현황 변화 추이
- **연도별 비교**: 연도별 학생 현황 비교 분석

#### 필터링 기능
- **통합유형**: 완전통합/부분통합 필터링
- **장애유형**: 지적장애, 자폐성장애 등 필터링
- **학년별**: 1-12학년 구분 필터링
- **성별**: 남/여 구분 필터링

#### 통계 차트
- **시각화 차트**: 막대그래프, 원그래프, 선그래프
- **비교 분석**: 전년 대비, 전국 평균 비교
- **성장 추이**: 시간별 학생 수 변화 추이
- **예측 분석**: 향후 학생 수 예측

#### 고급 분석 기능
- **진도율 분석**: 학생별 교육과정 진도율 통계
- **성취도 분석**: 영역별 성취도 평균 및 분포
- **참여도 분석**: 수업 참여도 및 활동 참여율
- **개선 영역**: 집중 지원이 필요한 영역 식별
- **우수 사례**: 성과가 우수한 학생 사례 분석

#### 명단 출력
- **Excel 출력**: 상세 데이터 포함 Excel 파일
- **PDF 출력**: 공식 문서 형태 PDF 생성
- **필터링 출력**: 선택된 조건에 맞는 명단만 출력
- **템플릿 적용**: 기관별 양식에 맞는 출력 템플릿
- **자동 스케줄링**: 정기적 보고서 자동 생성 및 발송

#### 실시간 모니터링
- **대시보드 위젯**: 실시간 학생 현황 대시보드
- **알림 시스템**: 중요 변화 사항 즉시 알림
- **트렌드 분석**: 장기적 변화 추이 모니터링
- **예외 상황**: 주의가 필요한 학생 자동 식별

### 4.9.2 학교장 의견서 자동생성 (Alpine.js + AI 문서 생성 시스템)

```javascript
// Alpine.js 기반 학교장 의견서 자동생성 시스템 (고급 버전)
function advancedPrincipalOpinionGenerator() {
  return {
    // 의견서 기본 정보
    opinionDocument: {
      id: null,
      studentId: '',
      opinionType: 'newSelection', // 'newSelection', 'reselection', 'relocation', 'cancellation'
      quarterYear: '',
      schoolYear: new Date().getFullYear(),
      
      // 학생 정보 (자동 연동)
      studentInfo: {
        personalData: null,
        currentLevel: null,
        medicalDiagnosis: null,
        evaluationResults: [],
        counselingRecords: []
      },
      
      // 의견서 내용
      content: {
        executiveSummary: '', // 요약
        currentStatus: '',    // 현재 상황
        strengths: [],        // 강점 영역
        challenges: [],       // 도전 영역
        recommendations: [],  // 권고사항
        legalBasis: [],      // 법적 근거
        supportPlan: '',     // 지원 계획
        conclusion: ''       // 결론
      },
      
      // AI 분석 결과
      aiAnalysis: {
        growthPatterns: null,
        comparativeAnalysis: null,
        predictionModel: null,
        riskFactors: [],
        supportRecommendations: []
      }
    },
    
    // UI 상태
    isLoading: false,
    isGenerating: false,
    isSaving: false,
    saveError: null,
    generationProgress: 0,
    activeSection: 'basic', // 'basic', 'content', 'review'
    
    // 학생 선택 및 데이터 로드
    selectStudent(studentId) {
      this.isLoading = true;
      this.saveError = null;
      
      fetch(`/api/students/${studentId}/comprehensive-data`, {
        headers: { 'Authorization': `Bearer ${Alpine.store('auth').token}` }
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('학생 데이터를 불러오는데 실패했습니다.');
        }
        return response.json();
      })
      .then(studentData => {
        // 학생 정보 설정
        this.opinionDocument.studentId = studentId;
        this.opinionDocument.studentInfo = {
          personalData: studentData.personalInfo,
          currentLevel: studentData.currentLevel,
          medicalDiagnosis: studentData.medicalDiagnosis,
          evaluationResults: studentData.evaluations || [],
          counselingRecords: studentData.counselingRecords || []
        };
        
        // AI 기반 초기 분석 수행
        this.performInitialAnalysis(studentData);
      })
      .catch(error => {
        console.error('학생 데이터 로드 오류:', error);
        this.saveError = error.message;
      })
      .finally(() => {
        this.isLoading = false;
      });
    },
    
    // AI 기반 초기 분석
    performInitialAnalysis(studentData) {
      fetch('/api/ai/analyze-student-for-opinion', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          studentData: studentData,
          opinionType: this.opinionDocument.opinionType
        })
      })
      .then(response => {
        if (response.ok) {
          return response.json();
        }
        throw new Error('AI 분석에 실패했습니다.');
      })
      .then(analysis => {
        this.opinionDocument.aiAnalysis = {
          growthPatterns: analysis.growthPatterns,
          comparativeAnalysis: analysis.comparativeAnalysis,
          predictionModel: analysis.predictionModel,
          riskFactors: analysis.riskFactors || [],
          supportRecommendations: analysis.supportRecommendations || []
        };
      })
      .catch(error => {
        console.error('AI 분석 오류:', error);
      });
    },
    
    // AI 의견서 전체 생성 (Alpine.js/HTMX 패턴)
    generateFullOpinion() {
      this.isGenerating = true;
      this.generationProgress = 0;
      this.saveError = null;
      
      // 1단계: 교사 개인화 설정 로드
      this.loadTeacherPersonalization()
        .then(personalization => {
          // 2단계: AI 의견서 생성 요청
          return this.requestAIOpinionGeneration(personalization);
        })
        .then(response => {
          // 3단계: 스트리밍 응답 처리
          return this.processStreamingResponse(response);
        })
        .then(generatedContent => {
          // 4단계: 생성된 내용 파싱 및 적용
          const parsedContent = JSON.parse(generatedContent);
          this.applyGeneratedContent(parsedContent);
          this.generationProgress = 100;
        })
        .catch(error => {
          console.error('의견서 생성 오류:', error);
          this.saveError = error.message || 'AI 의견서 생성 중 오류가 발생했습니다.';
        })
        .finally(() => {
          this.isGenerating = false;
        });
    },
    
    // 교사 개인화 설정 로드 (Promise 체인)
    loadTeacherPersonalization() {
      return fetch('/api/teacher/personalization', {
        headers: { 'Authorization': `Bearer ${Alpine.store('auth').token}` }
      })
      .then(response => {
        if (response.ok) {
          return response.json();
        }
        return null; // 개인화 설정이 없어도 계속 진행
      })
      .catch(() => null); // 오류 시에도 null로 계속 진행
    },
    
    // AI 의견서 생성 요청 (Promise 체인)
    requestAIOpinionGeneration(personalization) {
      return fetch('/api/ai/generate-principal-opinion', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          studentInfo: this.opinionDocument.studentInfo,
          opinionType: this.opinionDocument.opinionType,
          aiAnalysis: this.opinionDocument.aiAnalysis,
          teacherPersonalization: personalization,
          quarterYear: this.opinionDocument.quarterYear,
          schoolYear: this.opinionDocument.schoolYear
        })
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('AI 의견서 생성에 실패했습니다.');
        }
        return response;
      });
    },
    
    // 스트리밍 응답 처리 (Promise 체인)
    processStreamingResponse(response) {
      const reader = response.body.getReader();
      const decoder = new TextDecoder('utf-8'); // UTF-8 명시적 지정
      let generatedContent = '';
      
      const readStream = () => {
        return reader.read().then(({ done, value }) => {
          if (done) {
            return generatedContent;
          }
          
          const chunk = decoder.decode(value, { stream: true });
          
          // UTF-8 안전성 검증
          if (this.validateUTF8(chunk)) {
            generatedContent += chunk;
            // 진행률 업데이트 (최대 90%까지)
            this.generationProgress = Math.min(90, this.generationProgress + 10);
          } else {
            console.warn('스트림 청크에서 UTF-8 인코딩 문제 감지');
          }
          
          return readStream(); // 재귀 호출로 다음 청크 읽기
        });
      };
      
      return readStream();
    },
    
    // 생성된 내용 적용
    applyGeneratedContent(content) {
      // UTF-8 안전성 검증
      if (!this.validateUTF8(JSON.stringify(content))) {
        this.saveError = '생성된 내용에 UTF-8 인코딩 오류가 있습니다.';
        return;
      }
      
      this.opinionDocument.content = {
        executiveSummary: content.executiveSummary || '',
        currentStatus: content.currentStatus || '',
        strengths: content.strengths || [],
        challenges: content.challenges || [],
        recommendations: content.recommendations || [],
        legalBasis: content.legalBasis || [],
        supportPlan: content.supportPlan || '',
        conclusion: content.conclusion || ''
      };
    },
    
    // 섹션별 부분 생성 (Alpine.js/HTMX 패턴)
    generateSection(sectionName) {
      this.setSectionGenerationState(sectionName, true);
      
      fetch('/api/ai/generate-opinion-section', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          section: sectionName,
          studentInfo: this.opinionDocument.studentInfo,
          aiAnalysis: this.opinionDocument.aiAnalysis,
          existingContent: this.opinionDocument.content
        })
      })
      .then(response => {
        if (!response.ok) {
          throw new Error(`섹션 '${sectionName}' 생성에 실패했습니다.`);
        }
        return response.json();
      })
      .then(sectionContent => {
        // UTF-8 안전성 검증
        if (this.validateUTF8(sectionContent.content)) {
          this.opinionDocument.content[sectionName] = sectionContent.content;
          this.saveError = null; // 성공 시 에러 초기화
          
          // 성공 알림 이벤트 발생
          this.$dispatch('section-generated', {
            sectionName: sectionName,
            content: sectionContent.content
          });
        } else {
          this.saveError = `생성된 섹션 '${sectionName}'에 UTF-8 인코딩 오류가 있습니다.`;
        }
      })
      .catch(error => {
        console.error(`섹션 '${sectionName}' 생성 오류:`, error);
        this.saveError = error.message || `섹션 '${sectionName}' 생성 중 오류가 발생했습니다.`;
      })
      .finally(() => {
        this.setSectionGenerationState(sectionName, false);
      });
    },
    
    // 섹션별 생성 상태 관리 (헬퍼 함수)
    setSectionGenerationState(sectionName, isGenerating) {
      if (!this.sectionGenerationStates) {
        this.sectionGenerationStates = {};
      }
      this.sectionGenerationStates[sectionName] = isGenerating;
    },
    
    // 특정 섹션 생성 상태 확인 (헬퍼 함수)
    isSectionGenerating(sectionName) {
      return this.sectionGenerationStates && this.sectionGenerationStates[sectionName] === true;
    },
    
    // 의견서 저장 (Alpine.js/HTMX 패턴)
    saveOpinion() {
      this.isSaving = true;
      this.saveError = null;
      
      // 저장 전 UTF-8 인코딩 검증
      if (!this.validateOpinionDocumentUTF8()) {
        this.saveError = '의견서 내용에 UTF-8 인코딩 문제가 있습니다.';
        this.isSaving = false;
        return;
      }
      
      const method = this.opinionDocument.id ? 'PUT' : 'POST';
      const url = this.opinionDocument.id 
        ? `/api/principal-opinions/${this.opinionDocument.id}`
        : '/api/principal-opinions';
      
      fetch(url, {
        method: method,
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify(this.opinionDocument)
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('의견서 저장에 실패했습니다.');
        }
        return response.json();
      })
      .then(savedOpinion => {
        // 저장된 데이터 업데이트
        this.opinionDocument.id = savedOpinion.id;
        this.saveError = null; // 성공 시 에러 초기화
        
        // 저장 성공 이벤트 발생
        this.$dispatch('opinion-saved', {
          opinionId: savedOpinion.id,
          studentId: this.opinionDocument.studentId,
          isNew: !this.opinionDocument.id // 새로 생성된지 여부
        });
        
        // 성공 메시지 표시 (옵션)
        this.$nextTick(() => {
          this.$dispatch('show-toast', {
            type: 'success',
            message: '의견서가 성공적으로 저장되었습니다.'
          });
        });
      })
      .catch(error => {
        console.error('의견서 저장 오류:', error);
        this.saveError = error.message || '의견서 저장 중 오류가 발생했습니다.';
        
        // 에러 메시지 표시 (옵션)
        this.$nextTick(() => {
          this.$dispatch('show-toast', {
            type: 'error',
            message: this.saveError
          });
        });
      })
      .finally(() => {
        this.isSaving = false;
      });
    },
    
    // 의견서 내용 UTF-8 인코딩 검증 (헬퍼 함수)
    validateOpinionDocumentUTF8() {
      try {
        // 기본 데이터 검증
        if (this.opinionDocument.studentInfo && 
            !this.validateUTF8(JSON.stringify(this.opinionDocument.studentInfo))) {
          return false;
        }
        
        // 내용 데이터 검증
        if (this.opinionDocument.content && 
            !this.validateUTF8(JSON.stringify(this.opinionDocument.content))) {
          return false;
        }
        
        // AI 분석 데이터 검증
        if (this.opinionDocument.aiAnalysis && 
            !this.validateUTF8(JSON.stringify(this.opinionDocument.aiAnalysis))) {
          return false;
        }
        
        return true;
      } catch (error) {
        console.error('UTF-8 검증 중 오류:', error);
        return false;
      }
    },
    
    // PDF 생성 및 다운로드 (Alpine.js/HTMX 패턴)
    generatePDF() {
      // PDF 생성 상태 초기화
      this.isPDFGenerating = true;
      this.saveError = null;
      
      // 의견서 ID 검증
      if (!this.opinionDocument.id) {
        this.saveError = '의견서를 먼저 저장해주세요.';
        this.isPDFGenerating = false;
        return;
      }
      
      fetch('/api/principal-opinions/generate-pdf', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          opinionId: this.opinionDocument.id,
          includeAnalysis: true,
          officialFormat: true
        })
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('PDF 생성에 실패했습니다.');
        }
        return response.blob();
      })
      .then(blob => {
        // PDF 파일 다운로드 처리
        this.downloadPDFBlob(blob);
        
        // 성공 이벤트 발생
        this.$dispatch('pdf-generated', {
          opinionId: this.opinionDocument.id,
          fileName: this.getPDFFileName()
        });
        
        // 성공 메시지 표시
        this.$nextTick(() => {
          this.$dispatch('show-toast', {
            type: 'success',
            message: 'PDF가 성공적으로 생성되었습니다.'
          });
        });
      })
      .catch(error => {
        console.error('PDF 생성 오류:', error);
        this.saveError = error.message || 'PDF 생성 중 오류가 발생했습니다.';
        
        // 에러 메시지 표시
        this.$nextTick(() => {
          this.$dispatch('show-toast', {
            type: 'error',
            message: this.saveError
          });
        });
      })
      .finally(() => {
        this.isPDFGenerating = false;
      });
    },
    
    // PDF Blob 다운로드 처리 (헬퍼 함수)
    downloadPDFBlob(blob) {
      try {
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = this.getPDFFileName();
        a.setAttribute('aria-label', 'PDF 파일 다운로드'); // 접근성
        
        // 다운로드 실행
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        
        // 메모리 정리
        window.URL.revokeObjectURL(url);
      } catch (error) {
        console.error('파일 다운로드 오류:', error);
        throw new Error('파일 다운로드 중 오류가 발생했습니다.');
      }
    },
    
    // PDF 파일명 생성 (헬퍼 함수)
    getPDFFileName() {
      const studentName = this.opinionDocument.studentInfo?.personalData?.name || 'student';
      const quarterYear = this.opinionDocument.quarterYear || 'unknown';
      
      // 파일명에서 안전하지 않은 문자 제거 (UTF-8 안전성)
      const safeName = studentName.replace(/[<>:"/\\|?*]/g, '_');
      const safeQuarter = quarterYear.replace(/[<>:"/\\|?*]/g, '_');
      
      return `학교장의견서_${safeName}_${safeQuarter}.pdf`;
    },
    
    // 내용 검증 (Alpine.js/HTMX 패턴)
    validateContent(callback) {
      // 검증 상태 초기화
      this.isValidating = true;
      this.validationError = null;
      
      // 검증할 내용이 있는지 확인
      if (!this.opinionDocument.content || Object.keys(this.opinionDocument.content).length === 0) {
        const result = { isValid: false, issues: ['내용이 비어있습니다.'], suggestions: [] };
        this.handleValidationResult(result, callback);
        return;
      }
      
      // 서버 검증 요청
      fetch('/api/ai/validate-opinion-content', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').token}`
        },
        body: JSON.stringify({
          content: this.opinionDocument.content,
          studentInfo: this.opinionDocument.studentInfo
        })
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('내용 검증 서비스에 오류가 발생했습니다.');
        }
        return response.json();
      })
      .then(validation => {
        // 검증 결과 처리
        const result = {
          isValid: validation.isValid || false,
          issues: validation.issues || [],
          suggestions: validation.suggestions || []
        };
        
        this.handleValidationResult(result, callback);
        
        // 검증 완료 이벤트 발생
        this.$dispatch('content-validated', {
          result: result,
          opinionId: this.opinionDocument.id
        });
      })
      .catch(error => {
        console.error('내용 검증 오류:', error);
        this.validationError = error.message || '내용 검증 중 오류가 발생했습니다.';
        
        // 오류 시 기본 결과 반환
        const fallbackResult = { isValid: true, issues: [], suggestions: [] };
        this.handleValidationResult(fallbackResult, callback);
      })
      .finally(() => {
        this.isValidating = false;
      });
    },
    
    // 검증 결과 처리 (헬퍼 함수)
    handleValidationResult(result, callback) {
      // 결과를 상태에 저장
      this.validationResult = result;
      
      // 콜백이 있으면 실행
      if (typeof callback === 'function') {
        callback(result);
      }
      
      // UI 업데이트를 위한 nextTick 처리
      this.$nextTick(() => {
        if (result.isValid) {
          this.$dispatch('show-toast', {
            type: 'success',
            message: '내용 검증이 완료되었습니다.'
          });
        } else {
          this.$dispatch('show-toast', {
            type: 'warning',
            message: `검증 결과: ${result.issues.length}개의 이슈가 발견되었습니다.`
          });
        }
      });
    },
    
    // 간단한 동기식 검증 (헬퍼 함수)
    validateContentSync() {
      // 기본 내용 유입성 검사
      const content = this.opinionDocument.content;
      const issues = [];
      const suggestions = [];
      
      if (!content.executiveSummary || content.executiveSummary.trim().length < 10) {
        issues.push('요약 부분이 너무 짧습니다.');
        suggestions.push('요약을 보다 상세히 작성해주세요.');
      }
      
      if (!content.currentStatus || content.currentStatus.trim().length < 10) {
        issues.push('현재 상황 부분이 너무 짧습니다.');
        suggestions.push('학생의 현재 상황을 상세히 기술해주세요.');
      }
      
      return {
        isValid: issues.length === 0,
        issues: issues,
        suggestions: suggestions
      };
    },
    
    // UTF-8 인코딩 검증
    validateUTF8(text) {
      try {
        const encoded = new TextEncoder().encode(text);
        const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
        return decoded === text;
      } catch (error) {
        return false;
      }
    },
    
    // 의견서 초기화
    resetOpinion() {
      this.opinionDocument = {
        id: null,
        studentId: '',
        opinionType: 'newSelection',
        quarterYear: '',
        schoolYear: new Date().getFullYear(),
        studentInfo: {
          personalData: null,
          currentLevel: null,
          medicalDiagnosis: null,
          evaluationResults: [],
          counselingRecords: []
        },
        content: {
          executiveSummary: '',
          currentStatus: '',
          strengths: [],
          challenges: [],
          recommendations: [],
          legalBasis: [],
          supportPlan: '',
          conclusion: ''
        },
        aiAnalysis: {
          growthPatterns: null,
          comparativeAnalysis: null,
          predictionModel: null,
          riskFactors: [],
          supportRecommendations: []
        }
      };
      this.saveError = null;
    }
  };
}
```

**주요 기능:**

**분기별 의견서**
- **신규 선정**: 신규 특수교육 대상자 선정 의견서
- **재선정**: 기존 대상자 재선정 의견서
- **재배치**: 배치 변경 의견서
- **선정취소**: 특수교육 선정 취소 의견서

**자동 데이터 연동**
- **현행수준 연동**: 학생의 현행수준 평가 데이터 자동 삽입
- **진단 연동**: 의료진단 및 검사 결과 연동
- **평가 연동**: 월별 교육평가 결과 연동
- **상담 연동**: 학부모 상담 내용 연동

**AI 의견문 생성**
- **Supabase Edge Functions**: AI 기반 의견문 초안 자동 생성
- **개인화 반영**: 교사의 개인화 설정 반영
- **전문용어 사용**: 특수교육학 전문용어 사용
- **법적 규정 준수**: 관련 법령 및 규정 준수

#### 지능형 데이터 분서
- **성장 패턴 분석**: 시간에 따른 학생 성장 패턴 자동 분석
- **강점 영역 식별**: AI 기반 학생 강점 영역 자동 식별
- **도전 영역 추출**: 개선이 필요한 영역 자동 추출
- **비교 분석**: 동일 연령대 평균과 비교 분석
- **예측 모델**: 향후 발달 방향 예측 및 제안

#### 전문적 의견서 작성
- **법적 근거**: 특수교육법 및 관련 규정 자동 인용
- **전문용어**: 특수교육학 전문용어 적절한 사용
- **객관적 근거**: 데이터 기반 객관적 근거 제시
- **구체적 예시**: 실제 사례 및 구체적 예시 포함
- **발달적 관점**: 연령별 발달 특성 고려

#### 편집 및 품질 관리
- **단계별 검토**: 1차 AI 생성 → 2차 교사 검토 → 3차 최종 확인
- **내용 검증**: 사실 오류, 논리적 모순 자동 검증
- **일관성 체크**: 이전 의견서와의 일관성 체크
- **전자서명**: 블록체인 기반 안전한 디지털 서명
- **버전 관리**: 수정 이력 및 버전 관리 시스템

#### 문서 보안 및 관리
- **암호화 저장**: AES-256 암호화로 안전한 문서 저장
- **접근 권한**: 역할 기반 세분화된 접근 권한 관리
- **감사 로그**: 모든 접근 및 수정 내역 상세 기록
- **백업 시스템**: 자동 백업 및 재해 복구 시스템
- **유효기간**: 문서별 유효기간 설정 및 자동 알림

### 4.9.3 지능형 상담 지원 시스템
**기능 개요**: 학생 데이터 기반 상담록 작성 및 상담 가이드 제공

#### AI 기반 상담 분석
- **감정 상태 분석**: 학생 행동 패턴 기반 감정 상태 자동 분석
- **스트레스 지수**: 다양한 지표를 통한 스트레스 수준 측정
- **사회성 발달**: 또래 관계 및 사회적 상호작용 분석
- **학습 동기**: 학습 참여도 및 동기 수준 평가
- **위험 신호**: 조기 개입이 필요한 위험 신호 자동 감지

#### 맞춤형 상담 전략
- **개별 상담**: 학생 개별 특성 기반 맞춤형 상담 전략
- **집단 상담**: 유사 특성 학생들의 효과적인 집단 상담 계획
- **가족 상담**: 가족 구성원 포함 통합적 상담 접근
- **전문가 연계**: 필요시 외부 전문가 자동 연계 시스템
- **단계별 목표**: 단기/중기/장기 상담 목표 설정

#### 상담 도구 및 자료
- **상담 도구함**: 연령별, 장애유형별 상담 도구 라이브러리
- **활동 자료**: 상담에 활용할 수 있는 다양한 활동 자료
- **평가 척도**: 표준화된 평가 도구 및 척도 제공
- **진전 추적**: 상담 목표 달성도 시각적 추적
- **성공 사례**: 유사 사례의 성공적인 상담 사례 참고

#### 상담 기록 및 분석
- **자동 기록**: AI 기반 상담 내용 자동 요약 및 기록
- **진행 상황**: 상담 목표 달성도 실시간 추적
- **효과 분석**: 상담 효과 정량적/정성적 분석
- **예측 모델**: 상담 성과 예측 및 개선 방향 제시
- **후속 계획**: 다음 상담 계획 AI 기반 자동 제안

#### 전문적 상담 가이드
- **특수교육학 기반**: 특수교육학 이론 기반 상담 전략 제공
- **장애별 접근**: 장애 유형별 맞춤형 상담 전략
- **연령별 고려**: 학생 연령에 따른 상담 방법 안내
- **문제 상황별**: 특정 문제 상황별 대응 가이드

#### 문서 출력
- **PDF 출력**: 공식 문서 형태 PDF 생성
- **HWP 출력**: 한글 문서 형태 출력
- **상담록 템플릿**: 기관별 상담록 양식 적용
- **전자서명**: 디지털 서명 및 인증

---

## 4.10 퀵링크 및 외부 툴 관리

### 4.10.1 퀵링크 대시보드
**기능 개요**: 교사가 자주 사용하는 기능과 외부 도구에 빠르게 접근할 수 있는 3x3 버튼 형태의 퀵링크 대시보드

#### 기본 퀵링크 구성
- **학생 관리**: 학생 정보 조회 및 수정
- **교육과정**: 개별화교육계획 작성 및 관리
- **평가 도구**: 각종 평가 및 검사 도구
- **상담 지원**: 상담 기록 및 상담 가이드
- **행정 업무**: 공문서 작성 및 보고서 생성
- **자료실**: 교육 자료 및 템플릿 라이브러리
- **통계 분석**: 학급/학생 현황 통계
- **설정**: 개인화 설정 및 시스템 환경설정
- **도움말**: 사용자 가이드 및 지원 센터

#### 개인화 기능
- **버튼 재배치**: 드래그 앤 드롭으로 버튼 위치 자유 변경
- **기능 선택**: 자주 사용하는 기능을 우선 배치
- **색상 테마**: 개인 선호에 따른 색상 테마 선택
- **아이콘 변경**: 직관적인 아이콘으로 변경 가능
- **사용 빈도**: AI 기반 사용 패턴 분석으로 자동 최적화

### 4.10.2 외부 툴 연동
**기능 개요**: 교육 현장에서 활용하는 다양한 외부 도구와의 연동 관리

#### 지원 외부 툴
- **Google Workspace**: 구글 클래스룸, 드라이브, 문서 연동
- **Microsoft 365**: Teams, OneNote, Office 연동
- **Zoom/WebEx**: 화상 수업 및 회의 연동
- **Padlet**: 협업 보드 및 아이디어 공유
- **Kahoot**: 게임형 학습 도구 연동
- **Flipgrid**: 비디오 토론 플랫폼 연동
- **Seesaw**: 학습 포트폴리오 연동
- **ClassDojo**: 학급 관리 및 소통 도구
- **Nearpod**: 인터랙티브 수업 도구

#### 연동 관리 기능
- **API 연결**: 안전한 API 키 관리 및 연결
- **SSO 지원**: 단일 로그인으로 모든 툴 접근
- **데이터 동기화**: 학생 정보 및 성과 데이터 자동 동기화
- **권한 관리**: 툴별 세분화된 접근 권한 설정
- **사용 모니터링**: 외부 툴 사용 현황 및 효과 분석

#### 보안 및 개인정보 보호
- **데이터 암호화**: 외부 툴과의 데이터 전송 시 암호화
- **접근 로그**: 모든 외부 툴 접근 내역 기록
- **권한 검증**: 정기적인 권한 검증 및 갱신
- **개인정보 보호**: GDPR, 개인정보보호법 준수
- **데이터 지역화**: 국내 데이터 저장 및 처리 원칙

### 4.10.3 워크플로우 자동화
**기능 개요**: 반복적인 업무를 자동화하여 교사의 업무 효율성 향상

#### 자동화 시나리오
- **출석 체크**: 외부 시스템과 연동한 자동 출석 확인
- **과제 배포**: 정해진 시간에 자동 과제 배포
- **평가 결과**: 외부 도구 평가 결과 자동 수집 및 정리
- **학부모 알림**: 중요 사항 자동 학부모 통지
- **보고서 생성**: 정기 보고서 자동 생성 및 발송

#### 조건부 액션
- **IF-THEN 규칙**: 조건에 따른 자동 액션 설정
- **스케줄링**: 시간 기반 자동 실행
- **트리거 설정**: 특정 이벤트 발생 시 자동 실행
- **승인 워크플로우**: 중요 작업의 단계별 승인 프로세스
- **예외 처리**: 오류 발생 시 대체 액션 실행

## 4.11 교사 개인화 기능

### 4.9.1 대표 컨셉 관리
**기능 개요**: 교사별 교육 철학 및 대표 컨셉 설정

#### 교육 철학 설정
- **개별화 교육**: 학생 개별 능력에 맞춰 교육
- **통합교육**: 일반학생과 함께하는 통합교육 중시
- **실용교육**: 일상생활 중심의 실용적 교육
- **창의교육**: 창의성과 사고력 개발 중심
- **감성교육**: 정서적 안정과 감성 발달 중시

#### 대표 컨셉 설정
- **강점 기반**: 학생의 강점을 찾아 활용하는 교육
- **단계별 성취**: 작은 성취를 단계별로 쌓아가는 교육
- **체험 중심**: 직접 체험과 활동 중심의 교육
- **사회성 개발**: 사회적 기술과 상호작용 능력 개발
- **자립성 증진**: 자립적 생활 능력 향상

#### 컨셉 적용 범위
- **계획 작성**: 월별 계획 작성 시 대표 컨셉 반영
- **평가 기준**: 평가 기준 설정 시 컨셉 기반 지표 사용
- **AI 생성**: AI 자동 생성 시 개인화 컨셉 반영
- **상담 가이드**: 상담 시 컨셉 기반 접근 방법 제시

### 4.9.2 말투/문체 설정
**기능 개요**: 교사별 문서 작성 스타일 및 말투 설정

#### 문체 스타일
- **격식체**: 공식적이고 전문적인 문체
- **친근체**: 친근하고 따뜻한 문체
- **전문체**: 전문용어를 활용한 전문적 문체
- **일상체**: 일상적이고 자연스러운 문체
- **격려체**: 격려와 동기부여를 위한 문체

#### 말투 특성
- **상세도**: 설명의 상세한 정도 (간략/보통/상세)
- **긍정성**: 긍정적 표현 비율 (높음/보통/낮음)
- **전문성**: 전문용어 사용 비율 (높음/보통/낮음)
- **감정표현**: 감정적 표현 사용 비율 (높음/보통/낮음)
- **구체성**: 구체적 예시 사용 비율 (높음/보통/낮음)

#### 말투 적용 범위
- **계획서 작성**: 월별 계획서 작성 시 설정된 말투 적용
- **평가서 작성**: 평가서 작성 시 일관된 말투 사용
- **상담록 작성**: 상담록 작성 시 개인화된 말투 반영
- **AI 생성 문서**: AI 자동 생성 시 교사 말투 스타일 적용

### 4.9.3 AI 자동생성 강도 설정
**기능 개요**: AI 자동 생성 기능의 개입 정도 및 자동화 수준 조절

#### 자동생성 강도 단계
- **최소 (10%)**: 기본 템플릿만 제공, 대부분 수동 작성
- **낮음 (30%)**: 핵심 키워드 및 기본 구조 제시
- **보통 (50%)**: 기본 내용 자동 생성, 교사 검토 후 수정
- **높음 (70%)**: 상세 내용 자동 생성, 일부 수정만 필요
- **최대 (90%)**: 거의 완성된 문서 자동 생성, 최소한 검토만 필요

#### 영역별 세분화 설정
- **계획 작성**: 월별 계획 작성 시 AI 개입 정도
- **평가 작성**: 평가서 작성 시 AI 개입 정도
- **상담 가이드**: 상담 가이드 생성 시 AI 개입 정도
- **행정 문서**: 행정 문서 작성 시 AI 개입 정도
- **보고서 작성**: 보고서 작성 시 AI 개입 정도

#### AI 생성 옵션
- **창의성 수준**: AI 응답의 창의성 조절 (0.1-1.0)
- **전문성 비율**: 전문용어 사용 비율 조절
- **길이 선호도**: 생성되는 문서의 길이 선호도
- **구체성 수준**: 구체적 예시 포함 정도
- **검토 알림**: AI 생성 후 검토 요청 알림 설정

### 4.9.4 개인화 설정 관리
**기능 개요**: 교사별 개인화 설정 저장 및 관리

#### 설정 저장 및 동기화
- **자동 저장**: 설정 변경 시 자동 저장
- **클라우드 동기화**: 여러 기기에서 동일한 설정 사용
- **백업 및 복원**: 설정 백업 및 복원 기능
- **내보내기/가져오기**: 설정 내보내기 및 가져오기 기능

#### 설정 공유 및 협업
- **팀 설정 공유**: 같은 학교 교사들과 설정 공유
- **베스트 프랙티스**: 우수 설정 사례 공유
- **전문가 추천**: 전문가가 추천하는 설정 제공
- **새로운 교사 가이드**: 신임 교사를 위한 기본 설정 가이드

#### 설정 분석 및 추천
- **사용 패턴 분석**: 개인화 설정 사용 패턴 분석
- **효과성 측정**: 설정에 따른 작업 효율성 측정
- **맞춤 추천**: AI 기반 개인화 설정 추천
- **성과 리포트**: 개인화 설정 활용 성과 리포트

---

## 4.10 퀵링크/외부 툴 관리

### 4.10.1 퀵링크 시스템
**기능 개요**: 자주 사용하는 외부 도구 및 사이트 바로가기 관리

#### 3x3 버튼 배치
- **홈 화면 우측**: 메인 대시보드 우측에 3x3 그리드 배치
- **9개 퀵링크**: 최대 9개 외부 링크 바로가기 제공
- **드래그 앤 드롭**: 버튼 순서 변경 가능
- **반응형 디자인**: 모바일에서는 2x2 또는 1x4 배치

#### 외부 툴 연결
- **특수교육 도구**: 특수교육 관련 웹 도구 연결
- **교육 자료실**: 교육 자료 및 참고 사이트 연결
- **평가 도구**: 온라인 평가 및 진단 도구 연결
- **소통 도구**: 학부모 소통 및 알림 도구 연결

### 4.10.2 링크 관리 기능
**기능 개요**: 퀵링크의 시각적 요소 및 기능 관리

#### 시각적 요소
- **아이콘 설정**: 각 링크별 대표 아이콘 설정
- **배경색 설정**: 링크별 고유 배경색 지정
- **설명 툴팁**: 링크 설명 및 기능 안내 툴팁
- **미리보기**: 링크 클릭 전 미리보기 기능

#### 관리 권한
- **관리자 전용**: 중앙 관리자만 링크 추가/수정/삭제 가능
- **승인 시스템**: 교사 요청 시 관리자 승인 후 추가
- **카테고리 관리**: 링크 카테고리별 분류 및 관리
- **사용 통계**: 링크별 사용 빈도 및 통계 제공

#### 활성화 관리
- **노출/숨김**: 링크 노출 상태 개별 관리
- **정렬 순서**: 1-9 순서로 배치 순서 설정
- **조건부 노출**: 사용자 권한별 조건부 노출
- **임시 비활성**: 임시 점검 시 비활성화 기능

---

## 4.11 결제 및 이용권 관리

### 4.11.1 결제 시스템
**기능 개요**: 다양한 결제 방식을 지원하는 통합 결제 시스템

#### 결제 방식
- **개인 결제**: 신용카드, 계좌이체, 간편결제
- **학교 예산**: 학교 단위 예산 결제 (관리자 승인 필요)
- **시리얼 코드**: 바우처/시리얼 코드 등록
- **무료 체험**: 제한된 기능 무료 이용 (7일)

#### 다중 PG 지원
- **토스페이먼츠**: 주요 결제 수단 지원
- **카카오페이**: 카카오 간편결제 연동
- **네이버페이**: 네이버 간편결제 연동
- **NICE/Inicis**: 기존 PG사 연동 지원

#### 결제 보안
- **결제 정보 암호화**: 모든 결제 정보 AES-256 암호화
- **PCI DSS 준수**: 결제 보안 표준 준수
- **결제 이력 관리**: 모든 결제 시도 및 결과 로그 관리
- **사기 탐지**: 이상 결제 패턴 자동 탐지

```javascript
/**
 * @typedef {Object} PaymentResponse
 * @property {string} transactionId - 거래 ID
 * @property {string} [receiptUrl] - 영수증 URL (선택적)
 * @property {string} [errorMessage] - 에러 메시지 (선택적)
 */

// 결제 응답 데이터 구조 예시
const paymentResponse = {
  transactionId: 'PAY_123456789',
  receiptUrl: 'https://receipt.example.com/123',
  errorMessage: null
};
```

### 4.7.2 이용권 관리

#### 이용권 종류
- **월간 이용권**: 30일 이용권 (₩29,000)
- **연간 이용권**: 365일 이용권 (₩290,000, 17% 할인)
- **체험 이용권**: 30일 무료 체험 (기능 제한)
- **학교 단체권**: 학교 단위 단체 이용권 (별도 협의)

#### 이용권 상태
- **활성**: 정상 이용 중
- **만료**: 이용 기간 만료
- **대기**: 결제 승인 대기
- **취소**: 이용권 취소/환불
- **오류**: 시스템 오류 상태

---

## 📋 **체크리스트**

### 학생 관리 기능
- [ ] 학생 인적사항 CRUD 구현
- [ ] 파일 업로드/다운로드 기능
- [ ] 자동저장 및 이력관리 구현

### 교육 관리 기능
- [ ] 현행수준 평가 시스템 구현
- [ ] 월별 교육계획 작성 기능
- [ ] 월별 교육평가 시스템 구현
- [ ] AI 지원 기능 연동

### 시스템 관리 기능
- [ ] 학사일정 캘린더 구현
- [ ] 관리자 페이지 구현
- [ ] 결제 시스템 연동
- [ ] 퀵링크 관리 시스템 구현

---

## 4.8 관리자 시스템 기능

### 4.8.1 관리자 대시보드
- **통계 데이터 조회**: 전체 사용자, 활성 사용자, 전체 학생, 결제 현황, 라이선스 현황 실시간 모니터링
- **차트 시각화**: 월별 사용자 증가 추이, 라이선스 유형별 분포 차트
- **최근 활동 로그**: 관리자 행동 내역 실시간 모니터링

### 4.8.2 사용자 관리
- **사용자 목록 관리**: 전체 사용자 조회, 검색, 필터링(역할, 상태별)
- **역할 및 권한 관리**: 사용자 역할 변경(teacher, admin, super_admin)
- **계정 상태 관리**: 사용자 활성/비활성 전환
- **사용자 상세 정보**: 개별 사용자 상세 조회 및 편집

### 4.8.3 시스템 설정 관리
- **일반 설정**: 시스템 명칭, 전역 설정, 기본 값 관리
- **보안 설정**: 비밀번호 정책, 세션 타임아웃, 로그인 제한 설정
- **API 설정**: API 키 관리, 요청 제한, 타임아웃 설정
- **알림 설정**: 이메일 알림, 시스템 알림 설정

### 4.8.4 알림 센터
- **리얼타임 알림**: 실시간 알림 수신 및 표시
- **알림 처리**: 개별 알림 읽음 처리, 전체 읽음 처리
- **알림 발송**: 관리자가 전체 또는 특정 사용자에게 알림 전송
- **알림 내역 관리**: 알림 삭제, 전체 삭제

### 4.8.5 로그인 기록 관리
- **로그인 내역 조회**: 전체 사용자 로그인/로그아웃 기록
- **필터링 및 검색**: 날짜 범위, 로그인 유형, 사용자별 필터링
- **보안 모니터링**: 비정상적인 로그인 시도 감지 및 알림
- **IP 및 디바이스 추적**: 로그인 IP 주소 및 디바이스 정보 추적

---

## 🔗 **관련 문서**

- **[02_데이터베이스_설계.md](./02_데이터베이스_설계.md)**: 각 기능별 데이터 모델
- **[07_API_설계.md](./07_API_설계.md)**: 기능별 API 엔드포인트
- **[03_UI_UX_설계.md](./03_UI_UX_설계.md)**: 기능별 UI 컴포넌트
- **[10_보안_권한.md](./10_보안_권한.md)**: 기능별 접근 권한 정책
