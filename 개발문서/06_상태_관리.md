# ğŸ”„ IEPON ìƒíƒœ ê´€ë¦¬ ì„¤ê³„

> **ì—°ê²° ë¬¸ì„œ**: [05_ì»´í¬ë„ŒíŠ¸_ì„¤ê³„.md](./05_ì»´í¬ë„ŒíŠ¸_ì„¤ê³„.md) | [07_API_ì„¤ê³„.md](./07_API_ì„¤ê³„.md) | [12_ê°œë°œ_ê°€ì´ë“œ.md](./12_ê°œë°œ_ê°€ì´ë“œ.md)

---

## 6.1 ìƒíƒœ ê´€ë¦¬ ì•„í‚¤í…ì²˜

### 6.1.1 Alpine.js ê¸°ë°˜ ìƒíƒœ ê´€ë¦¬
```javascript
// ì „ì—­ ìƒíƒœ êµ¬ì¡° (Alpine.js ìŠ¤í† ì–´)
Alpine.store('appState', {
  // ì¸ì¦ ìƒíƒœ
  auth: {
    user: null,
    isAuthenticated: false,
    isLoading: false,
    license: null
  },
  // í•™ìƒ ë°ì´í„°
  students: {
    list: [],
    selected: null,
    isLoading: false,
    error: null
  },
  // êµìœ¡ ê³„íš/í‰ê°€
  education: {
    currentLevels: [],
    monthlyPlans: [],
    evaluations: [],
    isLoading: false,
    error: null
  },
  // UI ìƒíƒœ
  ui: {
    sidebarOpen: false,
    currentPage: 'dashboard',
    notifications: [],
    theme: 'light'
  },
  // ì„¤ì •
  settings: {
    language: 'ko',
    accessibilityMode: false,
    autoSave: true
  }
});
```

### 6.1.2 ìƒíƒœ ê´€ë¦¬ ì „ëµ
- **Alpine.js ìŠ¤í† ì–´**: ì „ì—­ ìƒíƒœ ê´€ë¦¬ (ì¸ì¦, í•™ìƒ ë°ì´í„° ë“±)
- **x-data ì§€ì—­ ìƒíƒœ**: ì»´í¬ë„ŒíŠ¸ë³„ ë…ë¦½ ìƒíƒœ
- **HTMX ì„œë²„ ìƒíƒœ**: ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™”
- **localStorage ì§€ì†ì„±**: ì„¤ì • ë° ìºì‹œ ë°ì´í„° ë³´ê´€

---

## 6.2 ì¸ì¦ ìƒíƒœ ê´€ë¦¬

### 6.2.1 Alpine.js ì¸ì¦ ìŠ¤í† ì–´ êµ¬í˜„
```javascript
// ì „ì—­ ì¸ì¦ ìŠ¤í† ì–´
Alpine.store('auth', {
  // ìƒíƒœ ë°ì´í„°
  user: null,
  isAuthenticated: false,
  isLoading: false,
  license: null,
  error: null,

  // ë¡œê·¸ì¸ ì•¡ì…˜
  async login(email, password) {
    this.isLoading = true;
    this.error = null;
    
    try {
      const { data: { user, session }, error } = await supabase.auth.signInWithPassword({
        email: email,
        password: password
      });
      
      if (error) throw error;
      
      if (user && session) {
        this.user = user;
        this.isAuthenticated = true;
        this.isLoading = false;
        
        // ë¼ì´ì„ ìŠ¤ í™•ì¸
        await this.checkLicense();
        
        // ì„¸ì…˜ ì •ë³´ë¥¼ localStorageì— ì €ì¥
        localStorage.setItem('iepon_session', JSON.stringify({
          user: user,
          sessionTime: new Date().toISOString()
        }));
        
        return { success: true, user };
      }
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('ë¡œê·¸ì¸ ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },

  // ë¡œê·¸ì•„ì›ƒ ì•¡ì…˜
  async logout() {
    try {
      await supabase.auth.signOut();
      
      // ìƒíƒœ ì´ˆê¸°í™”
      this.user = null;
      this.isAuthenticated = false;
      this.license = null;
      this.error = null;
      
      // localStorage ì •ë¦¬
      localStorage.removeItem('iepon_session');
      localStorage.removeItem('iepon_cache');
      
      // í™ˆí˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
      window.location.href = '/login.html';
      
    } catch (error) {
      console.error('ë¡œê·¸ì•„ì›ƒ ì˜¤ë¥˜:', error);
    }
  },

  // ë¼ì´ì„ ìŠ¤ í™•ì¸
  async checkLicense() {
    if (!this.user) return;
    
    try {
      const { data: license, error } = await supabase
        .from('licenses')
        .select('*')
        .eq('user_id', this.user.id)
        .eq('status', 'active')
        .single();
        
      if (!error && license) {
        this.license = license;
      }
    } catch (error) {
      console.error('ë¼ì´ì„ ìŠ¤ í™•ì¸ ì˜¤ë¥˜:', error);
    }
  },

  // í”„ë¡œí•„ ì—…ë°ì´íŠ¸
  async updateProfile(profileData) {
    this.isLoading = true;
    
    try {
      const { data: { user }, error } = await supabase.auth.updateUser(profileData);
      
      if (error) throw error;
      
      this.user = user;
      this.isLoading = false;
      
      return { success: true, user };
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'í”„ë¡œí•„ ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      return { success: false, error: this.error };
    }
  },

  // ì„¸ì…˜ ë³µì›
  async restoreSession() {
    this.isLoading = true;
    
    try {
      const { data: { session } } = await supabase.auth.getSession();
      
      if (session?.user) {
        this.user = session.user;
        this.isAuthenticated = true;
        await this.checkLicense();
      }
    } catch (error) {
      console.error('ì„¸ì…˜ ë³µì› ì˜¤ë¥˜:', error);
    } finally {
      this.isLoading = false;
    }
  },

  // í—¬í¼ ë©”ì„œë“œë“¤
  get hasValidLicense() {
    return this.license && this.license.status === 'active';
  },
  
  get isAdmin() {
    return this.user?.user_metadata?.role === 'super_admin';
  },
  
  get displayName() {
    return this.user?.user_metadata?.full_name || this.user?.email || 'ì‚¬ìš©ì';
  }
});
```

### 6.2.2 Alpine.js ì¸ì¦ ì»´í¬ë„ŒíŠ¸ íŒ¨í„´
```html
<!-- ì¸ì¦ ìƒíƒœë¥¼ í™œìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ ì˜ˆì‹œ -->
<div x-data="{
  get authState() { return $store.auth; },
  get isLoggedIn() { return this.authState.isAuthenticated; },
  get userName() { return this.authState.displayName; },
  get hasLicense() { return this.authState.hasValidLicense; },
  get isAdminUser() { return this.authState.isAdmin; }
}">
  <!-- ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¥¸ UI í‘œì‹œ -->
  <template x-if="isLoggedIn">
    <div class="user-info">
      <span x-text="userName"></span>
      <span x-show="hasLicense" class="license-badge">âœ… ì •í’ˆ ì¸ì¦</span>
      <span x-show="isAdminUser" class="admin-badge">ğŸ”§ ê´€ë¦¬ì</span>
      <button @click="$store.auth.logout()" class="logout-btn">
        ë¡œê·¸ì•„ì›ƒ
      </button>
    </div>
  </template>
  
  <!-- ë¡œê·¸ì•„ì›ƒ ìƒíƒœ UI -->
  <template x-if="!isLoggedIn">
    <a href="/login.html" class="login-link">ë¡œê·¸ì¸</a>
  </template>
</div>
```

```javascript
// ì¸ì¦ ê´€ë ¨ Alpine.js í—¬í¼ í•¨ìˆ˜ë“¤
Alpine.data('loginForm', () => ({
  email: '',
  password: '',
  isSubmitting: false,
  
  async submitLogin() {
    if (!this.email || !this.password) {
      alert('ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      return;
    }
    
    this.isSubmitting = true;
    const result = await this.$store.auth.login(this.email, this.password);
    
    if (result.success) {
      // HTMXë¡œ ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ ë¡œë“œ
      htmx.ajax('GET', '/dashboard.html', { target: 'body', swap: 'outerHTML' });
    } else {
      alert(result.error);
    }
    
    this.isSubmitting = false;
  }
}));
```

---

## 6.3 í•™ìƒ ë°ì´í„° ìƒíƒœ ê´€ë¦¬

### 6.3.1 Alpine.js í•™ìƒ ìŠ¤í† ì–´ êµ¬í˜„
```javascript
// ì „ì—­ í•™ìƒ ë°ì´í„° ìŠ¤í† ì–´
Alpine.store('students', {
  // ìƒíƒœ ë°ì´í„°
  list: [],
  selected: null,
  isLoading: false,
  error: null,
  totalCount: 0,
  
  // í•„í„° ë° ê²€ìƒ‰
  filters: {
    grade: '',
    disability: '',
    status: 'active',
    searchKeyword: ''
  },
  
  // í•™ìƒ ëª©ë¡ ì¡°íšŒ
  async fetchStudents(options = {}) {
    this.isLoading = true;
    this.error = null;
    
    try {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) throw new Error('ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìì…ë‹ˆë‹¤.');
      
      let query = supabase
        .from('students')
        .select('*, student_attachments(count)', { count: 'exact' })
        .eq('user_id', user.id)
        .eq('status', this.filters.status || 'active')
        .order('name');
      
      // í•„í„° ì ìš©
      if (this.filters.grade) {
        query = query.eq('grade', this.filters.grade);
      }
      if (this.filters.disability) {
        query = query.eq('disability_type', this.filters.disability);
      }
      if (this.filters.searchKeyword) {
        query = query.ilike('name', `%${this.filters.searchKeyword}%`);
      }
      
      const { data, error, count } = await query;
      
      if (error) throw error;
      
      this.list = data || [];
      this.totalCount = count || 0;
      this.isLoading = false;
      
      return { success: true, data: this.list };
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'í•™ìƒ ëª©ë¡ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('í•™ìƒ ì¡°íšŒ ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },
  
  // ìƒˆ í•™ìƒ ì¶”ê°€
  async addStudent(studentData) {
    this.isLoading = true;
    this.error = null;
    
    try {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) throw new Error('ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìì…ë‹ˆë‹¤.');
      
      // UTF-8 ì¸ì½”ë”© ê²€ì¦
      if (!this.validateUTF8(studentData.name)) {
        throw new Error('í•™ìƒ ì´ë¦„ì— ì¸ì½”ë”© ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤.');
      }
      
      const { data, error } = await supabase
        .from('students')
        .insert([{
          ...studentData,
          user_id: user.id,
          status: 'active',
          created_at: new Date().toISOString()
        }])
        .select()
        .single();
        
      if (error) throw error;
      
      // ëª©ë¡ì— ì¶”ê°€
      this.list.unshift(data);
      this.totalCount += 1;
      this.isLoading = false;
      
      return { success: true, data };
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'í•™ìƒ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('í•™ìƒ ì¶”ê°€ ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },

  // í•™ìƒ ì •ë³´ ìˆ˜ì •
  async updateStudent(id, updates) {
    this.isLoading = true;
    this.error = null;
    
    try {
      // UTF-8 ì¸ì½”ë”© ê²€ì¦ (ì´ë¦„ í•„ë“œê°€ ìˆëŠ” ê²½ìš°)
      if (updates.name && !this.validateUTF8(updates.name)) {
        throw new Error('í•™ìƒ ì´ë¦„ì— ì¸ì½”ë”© ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤.');
      }
      
      const { data, error } = await supabase
        .from('students')
        .update({ 
          ...updates, 
          updated_at: new Date().toISOString() 
        })
        .eq('id', id)
        .select()
        .single();
        
      if (error) throw error;
      
      // ëª©ë¡ì—ì„œ í•´ë‹¹ í•™ìƒ ì •ë³´ ì—…ë°ì´íŠ¸
      const index = this.list.findIndex(s => s.id === id);
      if (index !== -1) {
        this.list[index] = data;
      }
      
      // ì„ íƒëœ í•™ìƒì´ ìˆ˜ì •ëœ í•™ìƒì¸ ê²½ìš° ì—…ë°ì´íŠ¸
      if (this.selected?.id === id) {
        this.selected = data;
      }
      
      this.isLoading = false;
      return { success: true, data };
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'í•™ìƒ ì •ë³´ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('í•™ìƒ ìˆ˜ì • ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },
  
  // í•™ìƒ ì‚­ì œ (ì‹¤ì œë¡œëŠ” ë¹„í™œì„±í™”)
  async deleteStudent(id) {
    this.isLoading = true;
    this.error = null;
    
    try {
      const { data, error } = await supabase
        .from('students')
        .update({ 
          status: 'inactive',
          deleted_at: new Date().toISOString()
        })
        .eq('id', id)
        .select()
        .single();
        
      if (error) throw error;
      
      // ëª©ë¡ì—ì„œ ì œê±°
      this.list = this.list.filter(s => s.id !== id);
      this.totalCount -= 1;
      
      // ì„ íƒëœ í•™ìƒì´ ì‚­ì œëœ í•™ìƒì¸ ê²½ìš° ì„ íƒ í•´ì œ
      if (this.selected?.id === id) {
        this.selected = null;
      }
      
      this.isLoading = false;
      return { success: true };
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'í•™ìƒ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('í•™ìƒ ì‚­ì œ ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },
  
  // í•™ìƒ ì„ íƒ
  selectStudent(student) {
    this.selected = student;
    // ì„ íƒëœ í•™ìƒ ì •ë³´ë¥¼ localStorageì— ì €ì¥ (ì„¸ì…˜ ìœ ì§€ìš©)
    if (student) {
      localStorage.setItem('iepon_selected_student', JSON.stringify(student));
    } else {
      localStorage.removeItem('iepon_selected_student');
    }
  },
  
  // í•„í„° ì„¤ì •
  setFilters(newFilters) {
    this.filters = { ...this.filters, ...newFilters };
  },
  
  // ì—ëŸ¬ ì´ˆê¸°í™”
  clearError() {
    this.error = null;
  },
  
  // UTF-8 ê²€ì¦ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
  validateUTF8(text) {
    try {
      const encoder = new TextEncoder();
      const decoder = new TextDecoder('utf-8', { fatal: true });
      const encoded = encoder.encode(text);
      const decoded = decoder.decode(encoded);
      return decoded === text;
    } catch {
      return false;
    }
  },
  
  // í—¬í¼ ë©”ì„œë“œë“¤
  get activeStudents() {
    return this.list.filter(s => s.status === 'active');
  },
  
  get studentsByGrade() {
    const grouped = {};
    this.list.forEach(student => {
      const grade = student.grade || 'ë¯¸ì„¤ì •';
      if (!grouped[grade]) grouped[grade] = [];
      grouped[grade].push(student);
    });
    return grouped;
  }
});
```

---

## 6.4 êµìœ¡ ê´€ë ¨ ìƒíƒœ ê´€ë¦¬

### 6.4.1 Alpine.js êµìœ¡ ìŠ¤í† ì–´ êµ¬í˜„
```javascript
// ì „ì—­ êµìœ¡ ë°ì´í„° ìŠ¤í† ì–´
Alpine.store('education', {
  // ìƒíƒœ ë°ì´í„°
  currentLevels: [],
  monthlyPlans: [],
  monthlyEvaluations: [],
  isLoading: false,
  error: null,
  
  // í˜„ì¬ ì„ íƒëœ ë°ì´í„°
  selectedLevel: null,
  selectedPlan: null,
  selectedEvaluation: null,
  
  // í˜„í–‰ìˆ˜ì¤€ ì¡°íšŒ
  async fetchCurrentLevels(studentId) {
    this.isLoading = true;
    this.error = null;
    
    try {
      const { data, error } = await supabase
        .from('current_levels')
        .select(`
          *,
          students(name),
          curriculum_units(subject, unit_name)
        `)
        .eq('student_id', studentId)
        .order('semester', { ascending: false });
        
      if (error) throw error;
      
      this.currentLevels = data || [];
      this.isLoading = false;
      
      return { success: true, data: this.currentLevels };
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'í˜„í–‰ìˆ˜ì¤€ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('í˜„í–‰ìˆ˜ì¤€ ì¡°íšŒ ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },
  
  // ì›”ë³„ êµìœ¡ê³„íš ì¡°íšŒ
  async fetchMonthlyPlans(studentId, semester) {
    this.isLoading = true;
    this.error = null;
    
    try {
      const { data, error } = await supabase
        .from('monthly_plans')
        .select(`
          *,
          students(name),
          curriculum_units(subject, unit_name, grade)
        `)
        .eq('student_id', studentId)
        .eq('semester', semester)
        .order('month');
        
      if (error) throw error;
      
      this.monthlyPlans = data || [];
      this.isLoading = false;
      
      return { success: true, data: this.monthlyPlans };
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'ì›”ë³„ êµìœ¡ê³„íš ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('ì›”ë³„ ê³„íš ì¡°íšŒ ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },
  
  // ì›”ë³„ í‰ê°€ ì¡°íšŒ
  async fetchMonthlyEvaluations(studentId, semester) {
    this.isLoading = true;
    this.error = null;
    
    try {
      const { data, error } = await supabase
        .from('monthly_evaluations')
        .select(`
          *,
          students(name),
          monthly_plans(unit_id, goals)
        `)
        .eq('student_id', studentId)
        .eq('semester', semester)
        .order('evaluation_date', { ascending: false });
        
      if (error) throw error;
      
      this.monthlyEvaluations = data || [];
      this.isLoading = false;
      
      return { success: true, data: this.monthlyEvaluations };
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'ì›”ë³„ í‰ê°€ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('ì›”ë³„ í‰ê°€ ì¡°íšŒ ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },
  
  // í˜„í–‰ìˆ˜ì¤€ ì €ì¥
  async saveCurrentLevel(levelData) {
    this.isLoading = true;
    this.error = null;
    
    try {
      // UTF-8 ì¸ì½”ë”© ê²€ì¦
      if (levelData.detailed_content && !this.validateUTF8(levelData.detailed_content)) {
        throw new Error('ìƒì„¸ë‚´ìš©ì— ì¸ì½”ë”© ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤.');
      }
      
      const { data, error } = await supabase
        .from('current_levels')
        .upsert([
          {
            ...levelData,
            updated_at: new Date().toISOString()
          }
        ])
        .select()
        .single();
        
      if (error) throw error;
      
      // ê¸°ì¡´ ë°ì´í„° ì—…ë°ì´íŠ¸ ë˜ëŠ” ìƒˆ ë°ì´í„° ì¶”ê°€
      const existingIndex = this.currentLevels.findIndex(
        level => level.student_id === data.student_id && level.unit_id === data.unit_id
      );
      
      if (existingIndex !== -1) {
        this.currentLevels[existingIndex] = data;
      } else {
        this.currentLevels.unshift(data);
      }
      
      this.isLoading = false;
      return { success: true, data };
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'í˜„í–‰ìˆ˜ì¤€ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('í˜„í–‰ìˆ˜ì¤€ ì €ì¥ ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },
  
  // ì›”ë³„ ê³„íš ì €ì¥
  async saveMonthlyPlan(planData) {
    this.isLoading = true;
    this.error = null;
    
    try {
      // UTF-8 ì¸ì½”ë”© ê²€ì¦
      if (planData.goals && !this.validateUTF8(JSON.stringify(planData.goals))) {
        throw new Error('ê³„íš ëª©í‘œì— ì¸ì½”ë”© ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤.');
      }
      
      const { data, error } = await supabase
        .from('monthly_plans')
        .upsert([
          {
            ...planData,
            updated_at: new Date().toISOString()
          }
        ])
        .select()
        .single();
        
      if (error) throw error;
      
      // ê¸°ì¡´ ë°ì´í„° ì—…ë°ì´íŠ¸ ë˜ëŠ” ìƒˆ ë°ì´í„° ì¶”ê°€
      const existingIndex = this.monthlyPlans.findIndex(
        plan => plan.student_id === data.student_id && 
               plan.unit_id === data.unit_id && 
               plan.month === data.month
      );
      
      if (existingIndex !== -1) {
        this.monthlyPlans[existingIndex] = data;
      } else {
        this.monthlyPlans.push(data);
        this.monthlyPlans.sort((a, b) => a.month - b.month);
      }
      
      this.isLoading = false;
      return { success: true, data };
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'ì›”ë³„ ê³„íš ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('ì›”ë³„ ê³„íš ì €ì¥ ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },
  
  // ì›”ë³„ í‰ê°€ ì €ì¥
  async saveMonthlyEvaluation(evaluationData) {
    this.isLoading = true;
    this.error = null;
    
    try {
      // UTF-8 ì¸ì½”ë”© ê²€ì¦
      if (evaluationData.evaluation_content && !this.validateUTF8(JSON.stringify(evaluationData.evaluation_content))) {
        throw new Error('í‰ê°€ ë‚´ìš©ì— ì¸ì½”ë”© ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤.');
      }
      
      const { data, error } = await supabase
        .from('monthly_evaluations')
        .upsert([
          {
            ...evaluationData,
            evaluation_date: evaluationData.evaluation_date || new Date().toISOString().split('T')[0],
            updated_at: new Date().toISOString()
          }
        ])
        .select()
        .single();
        
      if (error) throw error;
      
      // ê¸°ì¡´ ë°ì´í„° ì—…ë°ì´íŠ¸ ë˜ëŠ” ìƒˆ ë°ì´í„° ì¶”ê°€
      const existingIndex = this.monthlyEvaluations.findIndex(
        eval => eval.student_id === data.student_id && 
               eval.plan_id === data.plan_id && 
               eval.evaluation_date === data.evaluation_date
      );
      
      if (existingIndex !== -1) {
        this.monthlyEvaluations[existingIndex] = data;
      } else {
        this.monthlyEvaluations.unshift(data);
      }
      
      this.isLoading = false;
      return { success: true, data };
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'ì›”ë³„ í‰ê°€ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('ì›”ë³„ í‰ê°€ ì €ì¥ ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },
  
  // ì„ íƒ ì•¡ì…˜ë“¤
  selectLevel(level) {
    this.selectedLevel = level;
  },
  
  selectPlan(plan) {
    this.selectedPlan = plan;
  },
  
  selectEvaluation(evaluation) {
    this.selectedEvaluation = evaluation;
  },
  
  // ì—ëŸ¬ ì´ˆê¸°í™”
  clearError() {
    this.error = null;
  },
  
  // UTF-8 ê²€ì¦ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
  validateUTF8(text) {
    try {
      const encoder = new TextEncoder();
      const decoder = new TextDecoder('utf-8', { fatal: true });
      const encoded = encoder.encode(text);
      const decoded = decoder.decode(encoded);
      return decoded === text;
    } catch {
      return false;
    }
  },
  
  // í—¬í¼ ë©”ì„œë“œë“¤
  get currentSemesterPlans() {
    const currentSemester = new Date().getMonth() < 6 ? '1' : '2';
    return this.monthlyPlans.filter(plan => plan.semester === currentSemester);
  },
  
  get completedEvaluations() {
    return this.monthlyEvaluations.filter(eval => eval.completion_status === 'completed');
  },
  
  get pendingEvaluations() {
    return this.monthlyEvaluations.filter(eval => eval.completion_status === 'pending');
  }
});

  saveCurrentLevel: async (data) => {
    set({ isLoading: true, error: null });
    try {
      const { data: result, error } = await supabase
        .from('current_levels')
        .upsert([data])
        .select()
        .single();

      if (error) throw error;

      set(state => ({
        currentLevels: [
          ...state.currentLevels.filter(cl => 
            !(cl.student_id === data.student_id && cl.semester === data.semester)
          ),
          result
        ],
        isLoading: false
      }));
    } catch (error) {
      set({ 
        error: error instanceof Error ? error.message : 'í˜„í–‰ìˆ˜ì¤€ ì €ì¥ ì‹¤íŒ¨',
        isLoading: false 
      });
    }
  }
}));
```

---

## 6.5 êµìœ¡ê³¼ì • ìƒíƒœ ê´€ë¦¬

### 6.5.1 Alpine.js êµìœ¡ê³¼ì • ìŠ¤í† ì–´ êµ¬í˜„
```javascript
// ì „ì—­ êµìœ¡ê³¼ì • ìŠ¤í† ì–´
Alpine.store('curriculum', {
  // ìƒíƒœ ë°ì´í„°
  units: [],
  selectedUnit: null,
  isLoading: false,
  error: null,
  totalCount: 0,
  
  // í•„í„° ë° ê²€ìƒ‰
  filters: {
    subject: '', // 'êµ­ì–´', 'ìˆ˜í•™', 'ì‚¬íšŒ', 'ê³¼í•™', 'ì˜ˆì²´'
    grade: null, // 1-6
    semester: null, // 1, 2
    searchKeyword: ''
  },
  
  // ì—…ë¡œë“œ ì§„í–‰ìƒíƒœ
  uploadProgress: {
    isUploading: false,
    progress: 0,
    message: '',
    currentFile: null
  },
  
  // êµìœ¡ê³¼ì • ëª©ë¡ ì¡°íšŒ
  async fetchUnits(customFilters = {}) {
    this.isLoading = true;
    this.error = null;
    
    try {
      // í˜„ì¬ í•„í„°ì™€ ì»¤ìŠ¤í…€ í•„í„° ë³‘í•©
      const activeFilters = { ...this.filters, ...customFilters };
      
      let query = supabase
        .from('curriculum_units')
        .select('*', { count: 'exact' })
        .eq('status', 'active')
        .order('grade', { ascending: true })
        .order('semester', { ascending: true })
        .order('unit_order', { ascending: true });
      
      // í•„í„° ì ìš©
      if (activeFilters.subject) {
        query = query.eq('subject', activeFilters.subject);
      }
      if (activeFilters.grade) {
        query = query.eq('grade', activeFilters.grade);
      }
      if (activeFilters.semester) {
        query = query.eq('semester', activeFilters.semester);
      }
      if (activeFilters.searchKeyword) {
        query = query.or(
          `unit_name.ilike.%${activeFilters.searchKeyword}%,` +
          `objectives.ilike.%${activeFilters.searchKeyword}%,` +
          `content_elements.ilike.%${activeFilters.searchKeyword}%`
        );
      }
      
      const { data, error, count } = await query;
      
      if (error) throw error;
      
      this.units = data || [];
      this.totalCount = count || 0;
      this.isLoading = false;
      
      return { success: true, data: this.units, count: this.totalCount };
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'êµìœ¡ê³¼ì • ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('êµìœ¡ê³¼ì • ì¡°íšŒ ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },
  
  // êµìœ¡ê³¼ì • ê²€ìƒ‰
  async searchUnits(keyword) {
    return await this.fetchUnits({ searchKeyword: keyword });
  },
  
  // ìƒˆ êµìœ¡ê³¼ì • ë‹¨ìœ„ ìƒì„±
  async createUnit(unitData) {
    this.isLoading = true;
    this.error = null;
    
    try {
      // UTF-8 ì¸ì½”ë”© ê²€ì¦
      if (unitData.unit_name && !this.validateUTF8(unitData.unit_name)) {
        throw new Error('ë‹¨ì›ëª…ì— ì¸ì½”ë”© ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤.');
      }
      if (unitData.objectives && !this.validateUTF8(JSON.stringify(unitData.objectives))) {
        throw new Error('í•™ìŠµëª©í‘œì— ì¸ì½”ë”© ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤.');
      }
      
      const { data, error } = await supabase
        .from('curriculum_units')
        .insert([{
          ...unitData,
          status: 'active',
          created_at: new Date().toISOString()
        }])
        .select()
        .single();
        
      if (error) throw error;
      
      // ëª©ë¡ì— ì¶”ê°€
      this.units.unshift(data);
      this.totalCount += 1;
      this.isLoading = false;
      
      return { success: true, data };
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'êµìœ¡ê³¼ì • ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('êµìœ¡ê³¼ì • ìƒì„± ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },
  
  // êµìœ¡ê³¼ì • ë‹¨ìœ„ ìˆ˜ì •
  async updateUnit(id, updates) {
    this.isLoading = true;
    this.error = null;
    
    try {
      // UTF-8 ì¸ì½”ë”© ê²€ì¦
      if (updates.unit_name && !this.validateUTF8(updates.unit_name)) {
        throw new Error('ë‹¨ì›ëª…ì— ì¸ì½”ë”© ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤.');
      }
      if (updates.objectives && !this.validateUTF8(JSON.stringify(updates.objectives))) {
        throw new Error('í•™ìŠµëª©í‘œì— ì¸ì½”ë”© ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤.');
      }
      
      const { data, error } = await supabase
        .from('curriculum_units')
        .update({ 
          ...updates, 
          updated_at: new Date().toISOString() 
        })
        .eq('id', id)
        .select()
        .single();
        
      if (error) throw error;
      
      // ëª©ë¡ì—ì„œ í•´ë‹¹ í•­ëª© ì—…ë°ì´íŠ¸
      const index = this.units.findIndex(u => u.id === id);
      if (index !== -1) {
        this.units[index] = data;
      }
      
      // ì„ íƒëœ ë‹¨ìœ„ê°€ ìˆ˜ì •ëœ ë‹¨ìœ„ì¸ ê²½ìš° ì—…ë°ì´íŠ¸
      if (this.selectedUnit?.id === id) {
        this.selectedUnit = data;
      }
      
      this.isLoading = false;
      return { success: true, data };
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'êµìœ¡ê³¼ì • ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('êµìœ¡ê³¼ì • ìˆ˜ì • ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },
  
  // êµìœ¡ê³¼ì • ë‹¨ìœ„ ì‚­ì œ (ì‹¤ì œë¡œëŠ” ë¹„í™œì„±í™”)
  async deleteUnit(id) {
    this.isLoading = true;
    this.error = null;
    
    try {
      const { data, error } = await supabase
        .from('curriculum_units')
        .update({ 
          status: 'inactive',
          deleted_at: new Date().toISOString()
        })
        .eq('id', id)
        .select()
        .single();
        
      if (error) throw error;
      
      // ëª©ë¡ì—ì„œ ì œê±°
      this.units = this.units.filter(u => u.id !== id);
      this.totalCount -= 1;
      
      // ì„ íƒëœ ë‹¨ìœ„ê°€ ì‚­ì œëœ ë‹¨ìœ„ì¸ ê²½ìš° ì„ íƒ í•´ì œ
      if (this.selectedUnit?.id === id) {
        this.selectedUnit = null;
      }
      
      this.isLoading = false;
      return { success: true };
    } catch (error) {
      this.isLoading = false;
      this.error = error.message || 'êµìœ¡ê³¼ì • ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('êµìœ¡ê³¼ì • ì‚­ì œ ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },
  
  // ëŒ€ëŸ‰ êµìœ¡ê³¼ì • ë°ì´í„° ì—…ë¡œë“œ
  async uploadUnits(unitsData) {
    this.uploadProgress.isUploading = true;
    this.uploadProgress.progress = 0;
    this.uploadProgress.message = 'ì—…ë¡œë“œ ì¤€ë¹„ ì¤‘...';
    this.error = null;
    
    try {
      this.uploadProgress.progress = 20;
      this.uploadProgress.message = 'ë°ì´í„° ê²€ì¦ ì¤‘...';
      
      // UTF-8 ì¸ì½”ë”© ê²€ì¦
      for (const unit of unitsData) {
        if (unit.unit_name && !this.validateUTF8(unit.unit_name)) {
          throw new Error(`ë‹¨ì›ëª… "${unit.unit_name}"ì— ì¸ì½”ë”© ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤.`);
        }
      }
      
      this.uploadProgress.progress = 50;
      this.uploadProgress.message = 'ë°ì´í„° ì „ì†¡ ì¤‘...';
      
      const { data, error } = await supabase
        .from('curriculum_units')
        .insert(unitsData.map(unit => ({
          ...unit,
          status: 'active',
          created_at: new Date().toISOString()
        })))
        .select();
        
      if (error) throw error;
      
      this.uploadProgress.progress = 90;
      this.uploadProgress.message = 'ë°ì´í„° ë™ê¸°í™” ì¤‘...';
      
      // ëª©ë¡ì— ì¶”ê°€
      this.units.unshift(...data);
      this.totalCount += data.length;
      
      this.uploadProgress.progress = 100;
      this.uploadProgress.message = `${data.length}ê°œ ë‹¨ì› ì—…ë¡œë“œ ì™„ë£Œ!`;
      
      // 3ì´ˆ í›„ ì—…ë¡œë“œ ìƒíƒœ ì´ˆê¸°í™”
      setTimeout(() => {
        this.uploadProgress.isUploading = false;
        this.uploadProgress.progress = 0;
        this.uploadProgress.message = '';
      }, 3000);
      
      return { success: true, data, count: data.length };
    } catch (error) {
      this.uploadProgress.isUploading = false;
      this.uploadProgress.progress = 0;
      this.uploadProgress.message = '';
      this.error = error.message || 'ë°ì´í„° ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('ëŒ€ëŸ‰ ì—…ë¡œë“œ ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  },
  
  // Excel íŒŒì¼ ì—…ë¡œë“œ
  async uploadExcel(file, subject, grade, semester) {
    this.uploadProgress.isUploading = true;
    this.uploadProgress.progress = 0;
    this.uploadProgress.message = 'Excel íŒŒì¼ ì²˜ë¦¬ ì‹œì‘...';
    this.uploadProgress.currentFile = file.name;
    this.error = null;
    
    try {
      // íŒŒì¼ íƒ€ì… ë° í¬ê¸° ê²€ì¦
      if (!file.name.match(/\.(xlsx|xls)$/i)) {
        throw new Error('Excel íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
      }
      if (file.size > 10 * 1024 * 1024) { // 10MB ì œí•œ
        throw new Error('íŒŒì¼ í¬ê¸°ëŠ” 10MBë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      }
      
      this.uploadProgress.progress = 30;
      this.uploadProgress.message = 'íŒŒì¼ ì—…ë¡œë“œ ì¤‘...';
      
      const formData = new FormData();
      formData.append('file', file);
      formData.append('subject', subject);
      formData.append('grade', grade.toString());
      formData.append('semester', semester.toString());
      
      // Supabase Edge Functionìœ¼ë¡œ íŒŒì¼ ì—…ë¡œë“œ
      const { data, error } = await supabase.functions.invoke('upload-curriculum-excel', {
        body: formData
      });
      
      if (error) throw error;
      
      this.uploadProgress.progress = 80;
      this.uploadProgress.message = 'ë°ì´í„° ì²˜ë¦¬ ì¤‘...';
      
      // ì²˜ë¦¬ëœ ë°ì´í„°ë¥¼ DBì— ì €ì¥
      if (data && data.units && data.units.length > 0) {
        const result = await this.uploadUnits(data.units);
        if (!result.success) {
          throw new Error(result.error);
        }
        
        this.uploadProgress.progress = 100;
        this.uploadProgress.message = `Excelì—ì„œ ${data.units.length}ê°œ ë‹¨ì› ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ!`;
        
        return { success: true, data: data.units, count: data.units.length };
      } else {
        throw new Error('ì—…ë¡œë“œëœ íŒŒì¼ì—ì„œ ìœ íš¨í•œ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      }
    } catch (error) {
      this.uploadProgress.isUploading = false;
      this.uploadProgress.progress = 0;
      this.uploadProgress.message = '';
      this.uploadProgress.currentFile = null;
      this.error = error.message || 'Excel íŒŒì¼ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      console.error('Excel ì—…ë¡œë“œ ì˜¤ë¥˜:', error);
      return { success: false, error: this.error };
    }
  }, 
          error: result.error?.message || 'Excel ì—…ë¡œë“œ ì‹¤íŒ¨',
          uploadProgress: { isUploading: false, progress: 0, message: '' }
        });
      }
    } catch (error) {
      set({ 
        error: 'Excel ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.',
        uploadProgress: { isUploading: false, progress: 0, message: '' }
      });
    }
  },

  // ì„ íƒ ë° í•„í„°
  setSelectedUnit: (unit) => {
    set({ selectedUnit: unit });
  },

  setFilters: (filters) => {
    set(state => ({ filters: { ...state.filters, ...filters } }));
  },

  clearFilters: () => {
    set({ 
      filters: {
        subject: '',
        grade: null,
        semester: null,
        searchKeyword: ''
      }
    });
  },

  // ìƒíƒœ ê´€ë¦¬
  setLoading: (loading) => {
    set({ isLoading: loading });
  },

  setError: (error) => {
    set({ error });
  },

  clearError: () => {
    set({ error: null });
  }
}));
```

### 6.5.2 êµìœ¡ê³¼ì • ìƒíƒœ í™œìš© ì˜ˆì‹œ (Alpine.js)
```html
<!-- êµìœ¡ê³¼ì • ëª©ë¡ í˜ì´ì§€ Alpine.js ì»´í¬ë„ŒíŠ¸ -->
<div 
  x-data="{
    get curriculum() { return $store.curriculum; },
    
    // ì´ˆê¸°í™” í•¨ìˆ˜
    async init() {
      await this.curriculum.fetchUnits();
    },
    
    // í•„í„° ë³€ê²½ í•¸ë“¤ëŸ¬
    async handleFilterChange(newFilters) {
      this.curriculum.setFilters(newFilters);
      await this.curriculum.fetchUnits(newFilters);
    },
    
    // ì‚­ì œ í•¸ë“¤ëŸ¬ (UTF-8 ì•ˆì „)
    async handleDelete(id) {
      if (!id) {
        alert('ì‚­ì œí•  êµìœ¡ê³¼ì • IDê°€ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      
      if (confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        const result = await this.curriculum.deleteUnit(id);
        if (result.success) {
          // UI ì—…ë°ì´íŠ¸ëŠ” Alpine.js ë°˜ì‘ì„±ìœ¼ë¡œ ìë™ ì²˜ë¦¬
          console.log('êµìœ¡ê³¼ì • ì‚­ì œ ì™„ë£Œ:', id);
        } else {
          alert(result.error || 'ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        }
      }
    }
  }"
  x-init="init()"
  class="curriculum-list-page"
>
  <!-- êµìœ¡ê³¼ì • í•„í„° ì„¹ì…˜ -->
  <div class="curriculum-filters" 
       x-show="curriculum.units.length > 0 || curriculum.filters.searchKeyword">
    
    <!-- ê²€ìƒ‰ ì…ë ¥ -->
    <div class="search-section">
      <input 
        type="text" 
        x-model="curriculum.filters.searchKeyword"
        @input.debounce.500ms="handleFilterChange(curriculum.filters)"
        placeholder="êµìœ¡ê³¼ì • ê²€ìƒ‰..."
        aria-label="êµìœ¡ê³¼ì • ê²€ìƒ‰"
        class="search-input"
      >
    </div>
    
    <!-- í•„í„° ì˜µì…˜ë“¤ -->
    <div class="filter-options">
      <select 
        x-model="curriculum.filters.grade"
        @change="handleFilterChange(curriculum.filters)"
        aria-label="í•™ë…„ í•„í„°"
        class="grade-filter"
      >
        <option value="">ëª¨ë“  í•™ë…„</option>
        <option value="elementary">ì´ˆë“±</option>
        <option value="middle">ì¤‘ë“±</option>
        <option value="high">ê³ ë“±</option>
      </select>
      
      <select 
        x-model="curriculum.filters.subject"
        @change="handleFilterChange(curriculum.filters)"
        aria-label="ê³¼ëª© í•„í„°"
        class="subject-filter"
      >
        <option value="">ëª¨ë“  ê³¼ëª©</option>
        <option value="korean">êµ­ì–´</option>
        <option value="math">ìˆ˜í•™</option>
        <option value="social">ì‚¬íšŒ</option>
        <option value="science">ê³¼í•™</option>
      </select>
    </div>
  </div>
  
  <!-- ë¡œë”© ìƒíƒœ -->
  <div x-show="curriculum.isLoading" class="loading-spinner" role="status" aria-label="ë¡œë”© ì¤‘">
    <div class="spinner"></div>
    <span>êµìœ¡ê³¼ì • ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span>
  </div>
  
  <!-- ì—ëŸ¬ ìƒíƒœ -->
  <div x-show="curriculum.error" class="error-message" role="alert">
    <span x-text="curriculum.error"></span>
    <button @click="curriculum.clearError()" class="error-close" aria-label="ì—ëŸ¬ ë©”ì‹œì§€ ë‹«ê¸°">Ã—</button>
  </div>
  
  <!-- êµìœ¡ê³¼ì • ëª©ë¡ -->
  <div x-show="!curriculum.isLoading && !curriculum.error" class="curriculum-list">
    <!-- ë¹ˆ ìƒíƒœ -->
    <div x-show="curriculum.units.length === 0" class="empty-state">
      <p>ë“±ë¡ëœ êµìœ¡ê³¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.</p>
      <button @click="$dispatch('open-curriculum-form')" class="add-curriculum-btn">
        ìƒˆ êµìœ¡ê³¼ì • ì¶”ê°€
      </button>
    </div>
    
    <!-- êµìœ¡ê³¼ì • ì¹´ë“œë“¤ -->
    <div x-show="curriculum.units.length > 0" class="curriculum-grid">
      <template x-for="unit in curriculum.units" :key="unit.id">
        <div class="curriculum-card">
          <div class="card-header">
            <h3 x-text="unit.title" class="unit-title"></h3>
            <span x-text="unit.grade + 'í•™ë…„'" class="grade-badge"></span>
          </div>
          
          <div class="card-content">
            <p x-text="unit.description || 'ì„¤ëª…ì´ ì—†ìŠµë‹ˆë‹¤.'" class="unit-description"></p>
            
            <div class="unit-meta">
              <span x-text="unit.subject" class="subject-tag"></span>
              <span x-text="unit.duration + 'ë¶„'" class="duration-tag"></span>
            </div>
          </div>
          
          <div class="card-actions">
            <button 
              @click="$dispatch('edit-curriculum', { id: unit.id })"
              class="btn-edit"
              aria-label="êµìœ¡ê³¼ì • í¸ì§‘"
            >
              í¸ì§‘
            </button>
            
            <button 
              @click="handleDelete(unit.id)"
              class="btn-delete"
              aria-label="êµìœ¡ê³¼ì • ì‚­ì œ"
            >
              ì‚­ì œ
            </button>
          </div>
        </div>
      </template>
    </div>
  </div>
  
  <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
  <div x-show="curriculum.totalCount > curriculum.units.length" class="pagination">
    <button 
      @click="curriculum.loadMore()"
      :disabled="curriculum.isLoading"
      class="load-more-btn"
    >
      ë” ë³´ê¸° (<span x-text="curriculum.totalCount - curriculum.units.length"></span>ê°œ ë‚¨ìŒ)
    </button>
  </div>
</div>
```

---

## 6.6 UI ìƒíƒœ ê´€ë¦¬

### 6.6.1 Alpine.js UI ìŠ¤í† ì–´ êµ¬í˜„
```javascript
// ì „ì—­ UI ìƒíƒœ ìŠ¤í† ì–´ (Alpine.js)
Alpine.store('ui', {
  // ìƒíƒœ ë°ì´í„°
  sidebarOpen: false,
  currentPage: 'dashboard',
  modals: {}, // ëª¨ë‹¬ ìƒíƒœ ë°©ëŒ€ { modalId: boolean }
  notifications: [],
  theme: 'light', // 'light' | 'dark'
  
  // ì‚¬ì´ë“œë°” í† ê¸€
  toggleSidebar() {
    this.sidebarOpen = !this.sidebarOpen;
    
    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
    localStorage.setItem('iepon_sidebar_open', this.sidebarOpen.toString());
  },
  
  // ì‚¬ì´ë“œë°” ë‹«ê¸°
  closeSidebar() {
    this.sidebarOpen = false;
    localStorage.setItem('iepon_sidebar_open', 'false');
  },
  
  // í˜„ì¬ í˜ì´ì§€ ì„¤ì •
  setCurrentPage(page) {
    // UTF-8 ê²€ì¦
    if (typeof page === 'string') {
      try {
        const encoded = new TextEncoder().encode(page);
        const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
        if (decoded !== page) {
          console.error('UTF-8 ì¸ì½”ë”© ì˜¤ë¥˜:', page);
          return;
        }
      } catch (error) {
        console.error('í˜ì´ì§€ ì´ë¦„ UTF-8 ê²€ì¦ ì‹¤íŒ¨:', error);
        return;
      }
    }
    
    this.currentPage = page;
    
    // URL ì—…ë°ì´íŠ¸ (ë¸Œë¼ìš°ì € íˆìŠ¤í† ë¦¬ ê´€ë¦¬)
    if (window.history && window.history.pushState) {
      const newUrl = `/${page}.html`;
      window.history.pushState({ page }, '', newUrl);
    }
  },
  
  // ëª¨ë‹¬ ì—´ê¸°
  openModal(modalId) {
    if (!modalId) {
      console.error('ëª¨ë‹¬ IDê°€ í•„ìš”í•©ë‹ˆë‹¤.');
      return;
    }
    
    this.modals[modalId] = true;
    
    // ëª¨ë‹¬ ì—´ë¦´ ë•Œ body ìŠ¤í¬ë¡¤ ë¹„í™œì„±í™”
    document.body.style.overflow = 'hidden';
    
    // ì ‘ê·¼ì„±: í¬ì»¤ìŠ¤ ê´€ë¦¬
    this.trapFocus(modalId);
  },
  
  // ëª¨ë‹¬ ë‹«ê¸°
  closeModal(modalId) {
    if (!modalId) {
      console.error('ëª¨ë‹¬ IDê°€ í•„ìš”í•©ë‹ˆë‹¤.');
      return;
    }
    
    this.modals[modalId] = false;
    
    // ë‹¤ë¥¸ ëª¨ë‹¬ì´ ì—´ë ¤ìˆëŠ”ì§€ í™•ì¸
    const hasOpenModal = Object.values(this.modals).some(isOpen => isOpen);
    if (!hasOpenModal) {
      document.body.style.overflow = '';
    }
  },
  
  // ëª¨ë“  ëª¨ë‹¬ ë‹«ê¸°
  closeAllModals() {
    this.modals = {};
    document.body.style.overflow = '';
  },
  
  // ì•Œë¦¼ ì¶”ê°€
  addNotification(notification) {
    if (!notification || !notification.message) {
      console.error('ì•Œë¦¼ ë©”ì‹œì§€ê°€ í•„ìš”í•©ë‹ˆë‹¤.');
      return;
    }
    
    // UTF-8 ê²€ì¦
    try {
      const encoded = new TextEncoder().encode(notification.message);
      const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
      if (decoded !== notification.message) {
        console.error('ì•Œë¦¼ ë©”ì‹œì§€ UTF-8 ì¸ì½”ë”© ì˜¤ë¥˜');
        return;
      }
    } catch (error) {
      console.error('ì•Œë¦¼ UTF-8 ê²€ì¦ ì‹¤íŒ¨:', error);
      return;
    }
    
    const id = Date.now().toString() + Math.random().toString(36).substr(2, 9);
    const newNotification = {
      id,
      message: notification.message,
      type: notification.type || 'info', // 'success', 'error', 'warning', 'info'
      duration: notification.duration || 5000,
      createdAt: new Date().toISOString()
    };
    
    this.notifications.push(newNotification);
    
    // ìë™ ì œê±°
    if (newNotification.duration > 0) {
      setTimeout(() => {
        this.removeNotification(id);
      }, newNotification.duration);
    }
    
    return id;
  },
  
  // ì•Œë¦¼ ì œê±°
  removeNotification(id) {
    const index = this.notifications.findIndex(n => n.id === id);
    if (index > -1) {
      this.notifications.splice(index, 1);
    }
  },
  
  // ëª¨ë“  ì•Œë¦¼ ì œê±°
  clearAllNotifications() {
    this.notifications = [];
  },
  
  // í…Œë§ˆ ì„¤ì •
  setTheme(theme) {
    if (!['light', 'dark'].includes(theme)) {
      console.error('ì§€ì›ë˜ì§€ ì•ŠëŠ” í…Œë§ˆ:', theme);
      return;
    }
    
    this.theme = theme;
    
    // HTML ë£¨íŠ¸ ì—˜ë¦¬ë¨¼íŠ¸ì— í´ë˜ìŠ¤ ì ìš©
    document.documentElement.className = theme;
    
    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
    localStorage.setItem('iepon_theme', theme);
  },
  
  // í…Œë§ˆ í† ê¸€
  toggleTheme() {
    const newTheme = this.theme === 'light' ? 'dark' : 'light';
    this.setTheme(newTheme);
  },
  
  // ì ‘ê·¼ì„±: í¬ì»¤ìŠ¤ íŠ¸ë© (ëª¨ë‹¬ ë‚´ì—ì„œë§Œ í¬ì»¤ìŠ¤ ì´ë™)
  trapFocus(modalId) {
    const modal = document.querySelector(`[data-modal="${modalId}"]`);
    if (!modal) return;
    
    const focusableElements = modal.querySelectorAll(
      'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
    );
    const firstElement = focusableElements[0];
    const lastElement = focusableElements[focusableElements.length - 1];
    
    // ì²« ë²ˆì§¸ ìš”ì†Œì— í¬ì»¤ìŠ¤
    if (firstElement) {
      firstElement.focus();
    }
    
    // Tab í‚¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    modal.addEventListener('keydown', (e) => {
      if (e.key === 'Tab') {
        if (e.shiftKey) {
          // Shift+Tab: ì—­ë°©í–¥
          if (document.activeElement === firstElement) {
            lastElement.focus();
            e.preventDefault();
          }
        } else {
          // Tab: ì •ë°©í–¥
          if (document.activeElement === lastElement) {
            firstElement.focus();
            e.preventDefault();
          }
        }
      } else if (e.key === 'Escape') {
        // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
        this.closeModal(modalId);
        e.preventDefault();
      }
    });
  },
  
  // ì´ˆê¸°í™” (ë¡œìº¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ìƒíƒœ ë³µì›)
  init() {
    // ì‚¬ì´ë“œë°” ìƒíƒœ ë³µì›
    const savedSidebarState = localStorage.getItem('iepon_sidebar_open');
    if (savedSidebarState !== null) {
      this.sidebarOpen = savedSidebarState === 'true';
    }
    
    // í…Œë§ˆ ìƒíƒœ ë³µì›
    const savedTheme = localStorage.getItem('iepon_theme');
    if (savedTheme && ['light', 'dark'].includes(savedTheme)) {
      this.setTheme(savedTheme);
    }
    
    // ë¸Œë¼ìš°ì € íˆìŠ¤í† ë¦¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    window.addEventListener('popstate', (event) => {
      if (event.state && event.state.page) {
        this.currentPage = event.state.page;
      }
    });
  },
  
  // Computed ì†ì„±ë“¤
  get unreadNotificationCount() {
    return this.notifications.length;
  },
  
  get isModalOpen() {
    return Object.values(this.modals).some(isOpen => isOpen);
  },
  
  get isDarkMode() {
    return this.theme === 'dark';
  }
});
```

---

## 6.7 ìë™ì €ì¥ ìƒíƒœ ê´€ë¦¬

### 6.7.1 Alpine.js ìë™ì €ì¥ ìœ í‹¸ë¦¬í‹°
```javascript
// ìë™ì €ì¥ ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ (Alpine.js íŒ¨í„´)
class AutoSaveManager {
  constructor(saveFunction, delay = 3000) {
    this.saveFunction = saveFunction;
    this.delay = delay;
    this.isSaving = false;
    this.lastSaved = null;
    this.hasUnsavedChanges = false;
    this.saveTimeout = null;
    this.onStateChange = null; // ìƒíƒœ ë³€ê²½ ì½œë°±
  }
  
  // ë°ì´í„° ì €ì¥ ë©”ì„œë“œ
  async save(data) {
    if (!this.saveFunction || !data) {
      console.warn('ì €ì¥ í•¨ìˆ˜ ë˜ëŠ” ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
      return false;
    }
    
    // UTF-8 ì•ˆì „ì„± ê²€ì¦
    if (!this.validateUTF8(data)) {
      console.error('ë°ì´í„° UTF-8 ì¸ì½”ë”© ì˜¤ë¥˜');
      return false;
    }
    
    this.isSaving = true;
    this.updateState();
    
    try {
      await this.saveFunction(data);
      this.lastSaved = new Date();
      this.hasUnsavedChanges = false;
      
      // ì„±ê³µ ì•Œë¦¼
      if (Alpine.store('ui')) {
        Alpine.store('ui').addNotification({
          message: 'ìë™ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.',
          type: 'success',
          duration: 2000
        });
      }
      
      return true;
    } catch (error) {
      console.error('ìë™ì €ì¥ ì‹¤íŒ¨:', error);
      
      // ì‹¤íŒ¨ ì•Œë¦¼
      if (Alpine.store('ui')) {
        Alpine.store('ui').addNotification({
          message: 'ìë™ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ì €ì¥í•´ì£¼ì„¸ìš”.',
          type: 'error',
          duration: 5000
        });
      }
      
      return false;
    } finally {
      this.isSaving = false;
      this.updateState();
    }
  }
  
  // ë””ë°”ìš´ìŠ¤ëœ ì €ì¥
  scheduleSave(data) {
    if (this.saveTimeout) {
      clearTimeout(this.saveTimeout);
    }
    
    this.hasUnsavedChanges = true;
    this.updateState();
    
    this.saveTimeout = setTimeout(() => {
      this.save(data);
    }, this.delay);
  }
  
  // ì¦‰ì‹œ ì €ì¥ (ë””ë°”ìš´ìŠ¤ ë¬´ì‹œ)
  async forceSave(data) {
    if (this.saveTimeout) {
      clearTimeout(this.saveTimeout);
      this.saveTimeout = null;
    }
    
    return await this.save(data);
  }
  
  // UTF-8 ê²€ì¦ ë©”ì„œë“œ
  validateUTF8(data) {
    try {
      const jsonString = JSON.stringify(data);
      const encoded = new TextEncoder().encode(jsonString);
      const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
      return decoded === jsonString;
    } catch (error) {
      console.error('UTF-8 ê²€ì¦ ì‹¤íŒ¨:', error);
      return false;
    }
  }
  
  // ìƒíƒœ ë³€ê²½ ì•Œë¦¼
  updateState() {
    if (this.onStateChange) {
      this.onStateChange({
        isSaving: this.isSaving,
        lastSaved: this.lastSaved,
        hasUnsavedChanges: this.hasUnsavedChanges
      });
    }
  }
  
  // ì •ë¦¬ ë©”ì„œë“œ
  destroy() {
    if (this.saveTimeout) {
      clearTimeout(this.saveTimeout);
      this.saveTimeout = null;
    }
  }
  
  // ìƒíƒœ ì ‘ê·¼ìë“¤
  get status() {
    return {
      isSaving: this.isSaving,
      lastSaved: this.lastSaved,
      hasUnsavedChanges: this.hasUnsavedChanges,
      lastSavedText: this.lastSaved ? 
        `ë§ˆì§€ë§‰ ì €ì¥: ${this.lastSaved.toLocaleTimeString()}` : 
        'ì €ì¥ëœ ì  ì—†ìŒ'
    };
  }
}
```

### 6.7.2 Alpine.js í¼ ìƒíƒœ ê´€ë¦¬ ìœ í‹¸ë¦¬í‹°
```javascript
// í¼ ìƒíƒœ ê´€ë¦¬ í´ë˜ìŠ¤ (Alpine.js íŒ¨í„´)
class FormStateManager {
  constructor(initialData = {}, validationRules = {}) {
    this.initialData = { ...initialData };
    this.data = { ...initialData };
    this.errors = {};
    this.touched = {};
    this.isDirty = false;
    this.isSubmitting = false;
    this.validationRules = validationRules;
    this.onStateChange = null;
  }
  
  // í•„ë“œ ê°’ ì—…ë°ì´íŠ¸
  updateField(field, value) {
    // UTF-8 ê²€ì¦ (string í•„ë“œì˜ ê²½ìš°)
    if (typeof value === 'string') {
      try {
        const encoded = new TextEncoder().encode(value);
        const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
        if (decoded !== value) {
          console.error(`í•„ë“œ ${field} UTF-8 ì¸ì½”ë”© ì˜¤ë¥˜`);
          return false;
        }
      } catch (error) {
        console.error(`í•„ë“œ ${field} UTF-8 ê²€ì¦ ì‹¤íŒ¨:`, error);
        return false;
      }
    }
    
    this.data[field] = value;
    this.touched[field] = true;
    this.isDirty = true;
    
    // í•´ë‹¹ í•„ë“œ ì—ëŸ¬ ì œê±°
    if (this.errors[field]) {
      delete this.errors[field];
    }
    
    // ì‹¤ì‹œê°„ ê²€ì¦ (ì˜µì…˜)
    if (this.validationRules[field]) {
      this.validateField(field);
    }
    
    this.updateState();
    return true;
  }
  
  // ì—¬ëŸ¬ í•„ë“œ ì—…ë°ì´íŠ¸
  updateFields(fields) {
    let hasErrors = false;
    
    for (const [field, value] of Object.entries(fields)) {
      const success = this.updateField(field, value);
      if (!success) hasErrors = true;
    }
    
    return !hasErrors;
  }
  
  // ë‹¨ì¼ í•„ë“œ ê²€ì¦
  validateField(field) {
    const rule = this.validationRules[field];
    const value = this.data[field];
    
    if (!rule) return true;
    
    // í•„ìˆ˜ ê²€ì¦
    if (rule.required && (!value || value.toString().trim() === '')) {
      this.errors[field] = rule.requiredMessage || `${field}ëŠ” í•„ìˆ˜ í•­ëª©ì…ë‹ˆë‹¤.`;
      return false;
    }
    
    // ìµœì†Œ ê¸¸ì´ ê²€ì¦
    if (rule.minLength && value && value.length < rule.minLength) {
      this.errors[field] = rule.minLengthMessage || `${field}ëŠ” ìµœì†Œ ${rule.minLength}ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.`;
      return false;
    }
    
    // ìµœëŒ€ ê¸¸ì´ ê²€ì¦
    if (rule.maxLength && value && value.length > rule.maxLength) {
      this.errors[field] = rule.maxLengthMessage || `${field}ëŠ” ìµœëŒ€ ${rule.maxLength}ìê¹Œì§€ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.`;
      return false;
    }
    
    // ì •ê·œì‹ ê²€ì¦
    if (rule.pattern && value && !rule.pattern.test(value)) {
      this.errors[field] = rule.patternMessage || `${field} í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.`;
      return false;
    }
    
    // ì»¤ìŠ¤í…€ ê²€ì¦ í•¨ìˆ˜
    if (rule.custom && typeof rule.custom === 'function') {
      const result = rule.custom(value, this.data);
      if (result !== true) {
        this.errors[field] = result || `${field} ê°’ì´ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.`;
        return false;
      }
    }
    
    // í•´ë‹¹ í•„ë“œ ì—ëŸ¬ ì œê±°
    if (this.errors[field]) {
      delete this.errors[field];
    }
    
    return true;
  }
  
  // ì „ì²´ í¼ ê²€ì¦
  validate() {
    this.errors = {};
    let isValid = true;
    
    for (const field of Object.keys(this.validationRules)) {
      if (!this.validateField(field)) {
        isValid = false;
      }
    }
    
    this.updateState();
    return isValid;
  }
  
  // ë¹„ë™ê¸° ê²€ì¦ (ì˜ˆ: ì„œë²„ ê²€ì¦)
  async validateAsync(asyncValidator) {
    if (!asyncValidator || typeof asyncValidator !== 'function') {
      return this.validate();
    }
    
    try {
      const result = await asyncValidator(this.data);
      
      if (result === true) {
        return true;
      } else if (typeof result === 'object') {
        // ì„œë²„ì—ì„œ ë°˜í™˜ëœ ì—ëŸ¬ ê°ì²´
        this.errors = { ...this.errors, ...result };
        this.updateState();
        return false;
      }
    } catch (error) {
      console.error('ë¹„ë™ê¸° ê²€ì¦ ì‹¤íŒ¨:', error);
      return false;
    }
    
    return false;
  }
  
  // í¼ ë¦¬ì…‹
  reset() {
    this.data = { ...this.initialData };
    this.errors = {};
    this.touched = {};
    this.isDirty = false;
    this.isSubmitting = false;
    this.updateState();
  }
  
  // íŠ¹ì • í•„ë“œ ë¦¬ì…‹
  resetField(field) {
    this.data[field] = this.initialData[field] || '';
    delete this.errors[field];
    delete this.touched[field];
    this.updateState();
  }
  
  // í¼ ì„œë°‹ ìƒíƒœ ì„¤ì •
  setSubmitting(isSubmitting) {
    this.isSubmitting = isSubmitting;
    this.updateState();
  }
  
  // ìƒíƒœ ë³€ê²½ ì•Œë¦¼
  updateState() {
    if (this.onStateChange) {
      this.onStateChange({
        data: this.data,
        errors: this.errors,
        touched: this.touched,
        isDirty: this.isDirty,
        isSubmitting: this.isSubmitting,
        isValid: Object.keys(this.errors).length === 0
      });
    }
  }
  
  // ìƒíƒœ ì ‘ê·¼ìë“¤
  get isValid() {
    return Object.keys(this.errors).length === 0;
  }
  
  get hasErrors() {
    return Object.keys(this.errors).length > 0;
  }
  
  get errorCount() {
    return Object.keys(this.errors).length;
  }
  
  get touchedCount() {
    return Object.keys(this.touched).length;
  }
  
  // í¼ ë°ì´í„° ì´ˆê¸°í™”
  setInitialData(data) {
    this.initialData = { ...data };
    this.reset();
  }
  
  // ì—ëŸ¬ ë©”ì‹œì§€ ì„¤ì •
  setError(field, message) {
    this.errors[field] = message;
    this.updateState();
  }
  
  // ì—ëŸ¬ ì œê±°
  clearError(field) {
    if (this.errors[field]) {
      delete this.errors[field];
      this.updateState();
    }
  }
  
  // ëª¨ë“  ì—ëŸ¬ ì œê±°
  clearAllErrors() {
    this.errors = {};
    this.updateState();
  }
}

```

---

## 6.8 ì„œë²„ ìƒíƒœ ê´€ë¦¬ (Alpine.js + HTMX)

### 6.8.1 ì„œë²„ ë°ì´í„° ìºì‹± ë§¤ë‹ˆì €
```javascript
// ì„œë²„ ë°ì´í„° ìºì‹± ë° ë™ê¸°í™” ê´€ë¦¬ (Alpine.js íŒ¨í„´)
class ServerDataManager {
  constructor() {
    this.cache = new Map(); // ë°ì´í„° ìºì‹œ
    this.loading = new Set(); // ë¡œë”© ìƒíƒœ ì¶”ì 
    this.subscriptions = new Map(); // ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ êµ¬ë…
    this.staleTime = 5 * 60 * 1000; // 5ë¶„ (ê¸°ë³¸ ìœ íš¨ì‹œê°„)
    this.onDataChange = null; // ë°ì´í„° ë³€ê²½ ì½œë°±
  }
  
  // ìºì‹œ í‚¤ ìƒì„±
  generateCacheKey(type, ...params) {
    return [type, ...params.filter(p => p !== null && p !== undefined)].join(':');
  }
  
  // ë°ì´í„° ìš”ì²­ (HTMX í˜¸í™˜)
  async fetchData(cacheKey, fetchFunction, options = {}) {
    const { 
      forceRefresh = false,
      staleTime = this.staleTime,
      retries = 3 
    } = options;
    
    // ì´ë¯¸ ë¡œë”© ì¤‘ì¸ ê²½ìš° ëŒ€ê¸°
    if (this.loading.has(cacheKey)) {
      return new Promise((resolve) => {
        const checkInterval = setInterval(() => {
          if (!this.loading.has(cacheKey)) {
            clearInterval(checkInterval);
            resolve(this.cache.get(cacheKey)?.data);
          }
        }, 100);
      });
    }
    
    // ìºì‹œëœ ë°ì´í„° í™•ì¸
    const cached = this.cache.get(cacheKey);
    if (cached && !forceRefresh && (Date.now() - cached.timestamp < staleTime)) {
      return cached.data;
    }
    
    // ë°ì´í„° ë¡œë”©
    this.loading.add(cacheKey);
    
    let attempt = 0;
    while (attempt < retries) {
      try {
        const data = await fetchFunction();
        
        // UTF-8 ê²€ì¦
        if (!this.validateUTF8(data)) {
          throw new Error('ë°ì´í„° UTF-8 ì¸ì½”ë”© ì˜¤ë¥˜');
        }
        
        // ìºì‹œ ì €ì¥
        this.cache.set(cacheKey, {
          data,
          timestamp: Date.now(),
          error: null
        });
        
        this.loading.delete(cacheKey);
        this.notifyDataChange(cacheKey, data);
        
        return data;
        
      } catch (error) {
        attempt++;
        console.error(`ë°ì´í„° ìš”ì²­ ì‹¤íŒ¨ (${attempt}/${retries}):`, error);
        
        if (attempt >= retries) {
          this.cache.set(cacheKey, {
            data: null,
            timestamp: Date.now(),
            error: error.message || 'ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨'
          });
          
          this.loading.delete(cacheKey);
          throw error;
        }
        
        // ì¬ì‹œë„ ëŒ€ê¸° (ì§€ìˆ˜ ë°±ì˜¤í”„)
        await new Promise(resolve => setTimeout(resolve, Math.pow(2, attempt) * 1000));
      }
    }
  }
  
  // UTF-8 ê²€ì¦
  validateUTF8(data) {
    try {
      const jsonString = JSON.stringify(data);
      const encoded = new TextEncoder().encode(jsonString);
      const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
      return decoded === jsonString;
    } catch (error) {
      console.error('UTF-8 ê²€ì¦ ì‹¤íŒ¨:', error);
      return false;
    }
  }
  
  // ë°ì´í„° ë³€ê²½ ì•Œë¦¼
  notifyDataChange(key, data) {
    if (this.onDataChange) {
      this.onDataChange({ key, data });
    }
  }
}

// ì „ì—­ ì„œë²„ ë°ì´í„° ë§¤ë‹ˆì € ì¸ìŠ¤í„´ìŠ¤
window.serverDataManager = new ServerDataManager();
```

---

## ğŸ“‹ **ì²´í¬ë¦¬ìŠ¤íŠ¸**

### Alpine.js ìƒíƒœ ê´€ë¦¬ ì„¤ì •
- [ ] Alpine.js ìŠ¤í† ì–´ êµ¬í˜„ (Auth, Students, Education, UI)
- [ ] HTMX + Alpine.js ì„œë²„ ìƒíƒœ ê´€ë¦¬ ì„¤ì •
- [ ] ìë™ì €ì¥ ìœ í‹¸ë¦¬í‹° êµ¬í˜„
- [ ] í¼ ìƒíƒœ ê´€ë¦¬ í´ë˜ìŠ¤ êµ¬í˜„
- [ ] ì„œë²„ ë°ì´í„° ìºì‹± ë§¤ë‹ˆì € ì„¤ì •

### ìƒíƒœ ë™ê¸°í™” (Alpine.js + HTMX)
- [ ] ì„œë²„-í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ ë™ê¸°í™”
- [ ] Supabase Realtime ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ êµ¬ë…
- [ ] ì˜¤í”„ë¼ì¸ ìƒíƒœ ì²˜ë¦¬ (ì„œë¹„ìŠ¤ ì›Œì»¤)
- [ ] ì—ëŸ¬ ìƒíƒœ ê´€ë¦¬ ë° ì‚¬ìš©ì ì•Œë¦¼
- [ ] UTF-8 ì¸ì½”ë”© ì•ˆì „ì„± ê²€ì¦

---

## 6.7 AI ìƒì„± ì„œë¹„ìŠ¤ ìƒíƒœ ê´€ë¦¬

### 6.7.1 AI êµìœ¡ê³„íš ìƒì„± ìƒíƒœ
```javascript
// Alpine.js AI êµìœ¡ê³„íš ìƒì„± ìŠ¤í† ì–´
Alpine.store('aiEducationPlan', {
  // ìƒì„± ìƒíƒœ
  isGenerating: false,
  generatedPlans: {}, // studentId -> plan
  selectedPlan: null,
  
  // ìƒì„± ì§„í–‰ ìƒíƒœ
  generationProgress: 0, // 0-100
  currentStep: '',
  
  // ì„¤ì •
  preferences: {
    complexity: 'medium',
    focusAreas: [],
    includePreviousData: true,
    customInstructions: ''
  },
  
  // ìƒì„± ê²°ê³¼ í’ˆì§ˆ
  confidence: 0, // 0-100
  warnings: [],
  suggestions: [],
  
  // ì—ëŸ¬ ë° ì¬ì‹œë„
  error: null,
  retryCount: 0,
  
  // UTF-8 ì¸ì½”ë”© ê²€ì¦ ìœ í‹¸ë¦¬í‹°
  validateUTF8(text) {
    try {
      const encoded = new TextEncoder().encode(text);
      const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
      return decoded === text;
    } catch (error) {
      console.error('UTF-8 ì¸ì½”ë”© ì˜¤ë¥˜:', error);
      return false;
    }
  },
  
  // ê³„íš ìƒì„±
  async generatePlan(params) {
    const { studentId, subject, unit, standards } = params;
    
    // UTF-8 ê²€ì¦
    if (!this.validateUTF8(subject) || !this.validateUTF8(unit)) {
      this.error = 'ì…ë ¥ ë°ì´í„°ì— ì¸ì½”ë”© ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤.';
      return;
    }
    
    this.isGenerating = true;
    this.generationProgress = 0;
    this.currentStep = 'í•™ìƒ ë°ì´í„° ìˆ˜ì§‘ ì¤‘...';
    this.error = null;
    this.retryCount = 0;
    
    try {
      this.generationProgress = 20;
      this.currentStep = 'êµìœ¡ê³¼ì • ë°ì´í„° ë¡œë“œ ì¤‘...';
      
      this.generationProgress = 50;
      this.currentStep = 'AI ê³„íš ìƒì„± ì¤‘...';
      
      // Supabase Edge Function í˜¸ì¶œ
      const { data, error } = await supabase.functions.invoke('generate-education-plan', {
        body: {
          studentId,
          subject,
          unit,
          standards,
          teacherPreferences: this.preferences
        }
      });
      
      this.generationProgress = 80;
      this.currentStep = 'ê²°ê³¼ ì²˜ë¦¬ ì¤‘...';
      
      if (error) throw error;
      
      if (data && data.success) {
        const plan = data.data;
        this.generatedPlans[studentId] = plan;
        this.selectedPlan = plan;
        this.confidence = plan.confidence || 0;
        this.warnings = plan.warnings || [];
        this.suggestions = plan.suggestions || [];
        this.generationProgress = 100;
        this.currentStep = 'ì™„ë£Œ';
        
        // HTMXë¡œ UI ì—…ë°ì´íŠ¸ íŠ¸ë¦¬ê±°
        document.body.dispatchEvent(new CustomEvent('ai:plan-generated', {
          detail: { studentId, plan }
        }));
      } else {
        throw new Error(data?.error?.message || 'AI ìƒì„± ì‹¤íŒ¨');
      }
    } catch (error) {
      this.error = error.message || 'AI ê³„íš ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      this.retryCount += 1;
      console.error('AI ê³„íš ìƒì„± ì˜¤ë¥˜:', error);
    } finally {
      this.isGenerating = false;
    }
  },
    
    // ê³„íš ê´€ë¦¬
    savePlan: async (studentId, plan) => {
      try {
        // API í˜¸ì¶œë¡œ ì €ì¥
        await fetch('/api/education-plans', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ studentId, plan })
        });
        
        set(state => ({
          generatedPlans: {
            ...state.generatedPlans,
            [studentId]: plan
          }
        }));
      } catch (error: any) {
        set({ error: error.message });
      }
    },
    
    loadPlan: async (studentId) => {
      try {
        const response = await fetch(`/api/education-plans/${studentId}`);
        const plan = await response.json();
        
        set(state => ({
          generatedPlans: {
            ...state.generatedPlans,
            [studentId]: plan
          },
          selectedPlan: plan
        }));
      } catch (error: any) {
        set({ error: error.message });
      }
    },
    
    updatePlan: async (studentId, updates) => {
      const currentPlan = get().generatedPlans[studentId];
      if (!currentPlan) return;
      
      const updatedPlan = { ...currentPlan, ...updates };
      await get().savePlan(studentId, updatedPlan);
    },
    
    deletePlan: async (studentId) => {
      try {
        await fetch(`/api/education-plans/${studentId}`, {
          method: 'DELETE'
        });
        
        set(state => {
          const { [studentId]: deleted, ...rest } = state.generatedPlans;
          return {
            generatedPlans: rest,
            selectedPlan: state.selectedPlan?.id === studentId ? null : state.selectedPlan
          };
        });
      } catch (error: any) {
        set({ error: error.message });
      }
    },
    
    // ì„¤ì • ê´€ë¦¬
    updatePreferences: (preferences) => {
      set(state => ({
        preferences: { ...state.preferences, ...preferences }
      }));
    },
    
    loadTemplates: async () => {
      try {
        const response = await fetch('/api/plan-templates');
        const templates = await response.json();
        set({ templates });
      } catch (error: any) {
        set({ error: error.message });
      }
    },
    
    // ìƒíƒœ ì´ˆê¸°í™”
    resetGeneration: () => {
      set({
        isGenerating: false,
        generationProgress: 0,
        currentStep: '',
        confidence: 0,
        warnings: [],
        suggestions: [],
        error: null,
        retryCount: 0
      });
    },
    
    clearError: () => {
      set({ error: null });
    }
  
  // ì˜ê²¬ì„œ ìŠ¹ì¸
  async approveOpinion(studentId, previewContent, confidence) {
    if (!this.validateUTF8(previewContent)) {
      this.error = 'ì˜ê²¬ì„œ ë‚´ìš©ì— ì¸ì½”ë”© ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤.';
      return;
    }
    
    const opinion = {
      id: `opinion_${Date.now()}`,
      studentId,
      content: previewContent,
      confidence,
      createdAt: new Date().toISOString(),
      status: 'approved'
    };
    
    await this.saveOpinion(studentId, opinion);
    this.previewMode = false;
    this.previewContent = '';
  },
  
  // ì˜ê²¬ì„œ ê±°ë¶€
  rejectOpinion(studentId) {
    this.previewMode = false;
    this.previewContent = '';
    this.confidence = 0;
  },
  
  // ì˜ê²¬ì„œ ì €ì¥
  async saveOpinion(studentId, opinion) {
    try {
      const { data, error } = await supabase
        .from('school_opinions')
        .upsert([{
          student_id: studentId,
          content: opinion.content,
          confidence: opinion.confidence,
          status: opinion.status
        }])
        .select();
      
      if (error) throw error;
      
      this.generatedOpinions[studentId] = opinion;
      this.selectedOpinion = opinion;
      
      // HTMX UI ì—…ë°ì´íŠ¸
      document.body.dispatchEvent(new CustomEvent('ai:opinion-saved', {
        detail: { studentId, opinion }
      }));
    } catch (error) {
      this.error = error.message || 'ì˜ê²¬ì„œ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      console.error('ì˜ê²¬ì„œ ì €ì¥ ì˜¤ë¥˜:', error);
    }
  },
  
  // ì˜ê²¬ì„œ ë¡œë“œ
  async loadOpinion(studentId) {
    try {
      const { data, error } = await supabase
        .from('school_opinions')
        .select('*')
        .eq('student_id', studentId)
        .single();
      
      if (error && error.code !== 'PGRST116') throw error;
      
      if (data) {
        const opinion = {
          id: data.id,
          studentId: data.student_id,
          content: data.content,
          confidence: data.confidence,
          createdAt: data.created_at,
          status: data.status
        };
        
        this.generatedOpinions[studentId] = opinion;
        this.selectedOpinion = opinion;
      }
    } catch (error) {
      this.error = error.message || 'ì˜ê²¬ì„œ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      console.error('ì˜ê²¬ì„œ ë¡œë“œ ì˜¤ë¥˜:', error);
    }
  },
  
  // ë¯¸ë¦¬ë³´ê¸° ëª¨ë“œ ì„¤ì •
  setPreviewMode(enabled) {
    this.previewMode = enabled;
  },
  
  // ì—ëŸ¬ ì‚­ì œ
  clearError() {
    this.error = null;
  }
});
```

### 6.7.3 AI ìƒë‹´ ê°€ì´ë“œ ìƒíƒœ
```javascript
// Alpine.js AI ìƒë‹´ ê°€ì´ë“œ ìŠ¤í† ì–´
Alpine.store('aiCounselingGuide', {
  // ìƒì„± ìƒíƒœ
  isGenerating: false,
  generatedGuides: {}, // studentId -> guide
  selectedGuide: null,
  
  // ì„¤ì •
  selectedFocusAreas: [],
  availableFocusAreas: [
    'í•™ìŠµ ëŠ¥ë ¥ í–¥ìƒ',
    'ì‚¬íšŒì„± ë°œë‹¬',
    'ì˜ì‚¬ì†Œí†µ ê¸°ìˆ ',
    'ë¬¸ì œí–‰ë™ ê°œì„ ',
    'ìë¦½ìƒí™œ ê¸°ìˆ ',
    'ì§„ë¡œ íƒìƒ‰',
    'ê°€ì¡± ê´€ê³„',
    'ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬'
  ],
  
  // ì˜¤ë¥˜ ì²˜ë¦¬
  error: null,
  
  // UTF-8 ì¸ì½”ë”© ê²€ì¦
  validateUTF8(text) {
    try {
      const encoded = new TextEncoder().encode(text);
      const decoded = new TextDecoder('utf-8', { fatal: true }).decode(encoded);
      return decoded === text;
    } catch (error) {
      console.error('UTF-8 ì¸ì½”ë”© ì˜¤ë¥˜:', error);
      return false;
    }
  },
  
  // ê°€ì´ë“œ ìƒì„±
  async generateGuide(params) {
    const { studentId, counselingType, focusAreas } = params;
    
    // UTF-8 ê²€ì¦
    if (focusAreas.some(area => !this.validateUTF8(area))) {
      this.error = 'ê´€ì‹¬ ì˜ì—­ ë°ì´í„°ì— ì¸ì½”ë”© ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤.';
      return;
    }
    
    this.isGenerating = true;
    this.error = null;
    
    try {
      // Supabase Edge Function í˜¸ì¶œ
      const { data, error } = await supabase.functions.invoke('generate-counseling-guide', {
        body: {
          studentId,
          counselingType,
          focusAreas,
          teacherPreferences: {}
        }
      });
      
      if (error) throw error;
      
      if (data && data.success) {
        const guide = data.data;
        this.generatedGuides[studentId] = guide;
        this.selectedGuide = guide;
        
        // HTMX UI ì—…ë°ì´íŠ¸
        document.body.dispatchEvent(new CustomEvent('ai:guide-generated', {
          detail: { studentId, guide }
        }));
      } else {
        throw new Error(data?.error?.message || 'ìƒë‹´ ê°€ì´ë“œ ìƒì„± ì‹¤íŒ¨');
      }
    } catch (error) {
      this.error = error.message || 'ìƒë‹´ ê°€ì´ë“œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      console.error('AI ìƒë‹´ ê°€ì´ë“œ ìƒì„± ì˜¤ë¥˜:', error);
    } finally {
      this.isGenerating = false;
    }
  },
  
  // ê°€ì´ë“œ ì €ì¥
  async saveGuide(studentId, guide) {
    try {
      const { data, error } = await supabase
        .from('counseling_guides')
        .upsert([{
          student_id: studentId,
          counseling_type: guide.counselingType,
          focus_areas: guide.focusAreas,
          content: guide.content,
          recommendations: guide.recommendations
        }])
        .select();
      
      if (error) throw error;
      
      this.generatedGuides[studentId] = guide;
      
      // HTMX UI ì—…ë°ì´íŠ¸
      document.body.dispatchEvent(new CustomEvent('ai:guide-saved', {
        detail: { studentId, guide }
      }));
    } catch (error) {
      this.error = error.message || 'ìƒë‹´ ê°€ì´ë“œ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      console.error('ìƒë‹´ ê°€ì´ë“œ ì €ì¥ ì˜¤ë¥˜:', error);
    }
  },
  
  // ê°€ì´ë“œ ë¡œë“œ
  async loadGuide(studentId) {
    try {
      const { data, error } = await supabase
        .from('counseling_guides')
        .select('*')
        .eq('student_id', studentId)
        .single();
      
      if (error && error.code !== 'PGRST116') throw error;
      
      if (data) {
        const guide = {
          id: data.id,
          studentId: data.student_id,
          counselingType: data.counseling_type,
          focusAreas: data.focus_areas,
          content: data.content,
          recommendations: data.recommendations,
          createdAt: data.created_at
        };
        
        this.generatedGuides[studentId] = guide;
        this.selectedGuide = guide;
      }
    } catch (error) {
      this.error = error.message || 'ìƒë‹´ ê°€ì´ë“œ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      console.error('ìƒë‹´ ê°€ì´ë“œ ë¡œë“œ ì˜¤ë¥˜:', error);
    }
  },
  
  // ê´€ì‹¬ ì˜ì—­ ì—…ë°ì´íŠ¸
  updateFocusAreas(areas) {
    this.selectedFocusAreas = areas.filter(area => this.validateUTF8(area));
  },
  
  // ê´€ì‹¬ ì˜ì—­ ë¡œë“œ
  async loadFocusAreas() {
    try {
      const { data, error } = await supabase
        .from('counseling_focus_areas')
        .select('name')
        .eq('is_active', true)
        .order('display_order');
      
      if (error) throw error;
      
      this.availableFocusAreas = data.map(item => item.name);
    } catch (error) {
      this.error = error.message || 'ê´€ì‹¬ ì˜ì—­ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      console.error('ê´€ì‹¬ ì˜ì—­ ë¡œë“œ ì˜¤ë¥˜:', error);
    }
  },
  
  // ì—ëŸ¬ ì‚­ì œ
  clearError() {
    this.error = null;
  }
});
    clearError: () => {
      set({ error: null });
    }
  })
);
```

### 6.7.4 AI ìƒíƒœ ê´€ë¦¬ í†µí•© Alpine.js ìŠ¤í† ì–´
```javascript
// AI ìƒíƒœ ê´€ë¦¬ í†µí•© Alpine.js ìŠ¤í† ì–´
Alpine.store('aiServices', {
  // í†µí•© ìƒíƒœ
  isAnyGenerating: false,
  errors: [],
  
  // ì „ì²´ AI ì„œë¹„ìŠ¤ ë¡œë”© ìƒíƒœ ê³„ì‚°
  get isGenerating() {
    return this.$store.aiEducationPlan?.isGenerating || 
           this.$store.aiSchoolOpinion?.isGenerating || 
           this.$store.aiCounselingGuide?.isGenerating || 
           false;
  },
  
  // ì „ì²´ ì—ëŸ¬ ìƒíƒœ ê³„ì‚°
  get allErrors() {
    const errors = [];
    
    if (this.$store.aiEducationPlan?.error) {
      errors.push(this.$store.aiEducationPlan.error);
    }
    if (this.$store.aiSchoolOpinion?.error) {
      errors.push(this.$store.aiSchoolOpinion.error);
    }
    if (this.$store.aiCounselingGuide?.error) {
      errors.push(this.$store.aiCounselingGuide.error);
    }
    
    return errors;
  },
  
  // ì „ì²´ ì—ëŸ¬ ì‚­ì œ
  clearAllErrors() {
    if (this.$store.aiEducationPlan) {
      this.$store.aiEducationPlan.clearError();
    }
    if (this.$store.aiSchoolOpinion) {
      this.$store.aiSchoolOpinion.clearError();
    }
    if (this.$store.aiCounselingGuide) {
      this.$store.aiCounselingGuide.clearError();
    }
    this.errors = [];
  },
  
  // í•™ìƒë³„ AI ì„œë¹„ìŠ¤ ë°ì´í„° ì¡°íšŒ
  getStudentAIData(studentId) {
    return {
      educationPlan: this.$store.aiEducationPlan?.generatedPlans?.[studentId] || null,
      schoolOpinion: this.$store.aiSchoolOpinion?.generatedOpinions?.[studentId] || null,
      counselingGuide: this.$store.aiCounselingGuide?.generatedGuides?.[studentId] || null
    };
  },
  
  // í•™ìƒë³„ AI ì„œë¹„ìŠ¤ ë°ì´í„° ë¡œë“œ
  async loadStudentAIData(studentId) {
    const promises = [];
    
    if (this.$store.aiEducationPlan && this.$store.aiEducationPlan.loadPlan) {
      promises.push(this.$store.aiEducationPlan.loadPlan(studentId));
    }
    if (this.$store.aiSchoolOpinion && this.$store.aiSchoolOpinion.loadOpinion) {
      promises.push(this.$store.aiSchoolOpinion.loadOpinion(studentId));
    }
    if (this.$store.aiCounselingGuide && this.$store.aiCounselingGuide.loadGuide) {
      promises.push(this.$store.aiCounselingGuide.loadGuide(studentId));
    }
    
    try {
      await Promise.all(promises);
      return { success: true };
    } catch (error) {
      console.error('AI ì„œë¹„ìŠ¤ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
      return { success: false, error: error.message };
    }
  },
  
  // Alpine.js ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•  í—¬í¼ í•¨ìˆ˜
  initializeAIServices() {
    // AI ì„œë¹„ìŠ¤ ìŠ¤í† ì–´ë“¤ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ì´ˆê¸°í™”
    if (!this.$store.aiEducationPlan) {
      console.warn('AI êµìœ¡ê³„íš ìŠ¤í† ì–´ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
    }
    if (!this.$store.aiSchoolOpinion) {
      console.warn('AI í•™êµ ì˜ê²¬ ìŠ¤í† ì–´ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
    }
    if (!this.$store.aiCounselingGuide) {
      console.warn('AI ìƒë‹´ ê°€ì´ë“œ ìŠ¤í† ì–´ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
    }
  }
});

// Alpine.js ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„° íŒ¨í„´
Alpine.data('aiServicesManager', () => ({
  get aiServices() {
    return this.$store.aiServices;
  },
  
  get hasAnyErrors() {
    return this.aiServices.allErrors.length > 0;
  },
  
  get isLoading() {
    return this.aiServices.isGenerating;
  },
  
  init() {
    this.aiServices.initializeAIServices();
  },
  
  async loadStudentData(studentId) {
    if (!studentId) return;
    
    const result = await this.aiServices.loadStudentAIData(studentId);
    if (!result.success) {
      this.showError('AI ì„œë¹„ìŠ¤ ë°ì´í„° ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + result.error);
    }
  },
  
  showError(message) {
    // ì—ëŸ¬ í‘œì‹œ ë¡œì§ (ì•Œë¦¼ ë“±)
    if (this.$store.notifications) {
      this.$store.notifications.add({
        type: 'error',
        message: message,
        duration: 5000
      });
    } else {
      alert(message);
    }
  }
}));
```

---

## 6.8 ê´€ë¦¬ì ì‹œìŠ¤í…œ ìƒíƒœ ê´€ë¦¬

### 6.8.1 ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ìƒíƒœ

**Alpine.js ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ìŠ¤í† ì–´**
```javascript
/**
 * @typedef {Object} AdminStatistics - ê´€ë¦¬ì í†µê³„ ì •ë³´
 * @property {number} totalUsers - ì „ì²´ ì‚¬ìš©ì ìˆ˜
 * @property {number} activeUsers - í™œì„± ì‚¬ìš©ì ìˆ˜
 * @property {number} totalStudents - ì „ì²´ í•™ìƒ ìˆ˜
 * @property {number} recentLogins - ìµœê·¼ ë¡œê·¸ì¸ ìˆ˜
 */

/**
 * @typedef {Object} UserProfile - ì‚¬ìš©ì í”„ë¡œí•„ ì •ë³´
 * @property {string} id - ì‚¬ìš©ì ID
 * @property {string} email - ì´ë©”ì¼
 * @property {string} role - ì—­í•  (admin, teacher, student)
 * @property {boolean} is_active - í™œì„± ìƒíƒœ
 * @property {string} created_at - ìƒì„±ì¼ì‹œ
 */

/**
 * @typedef {Object} SystemSetting - ì‹œìŠ¤í…œ ì„¤ì • ì •ë³´
 * @property {string} setting_key - ì„¤ì • í‚¤
 * @property {any} setting_value - ì„¤ì • ê°’
 * @property {string} description - ì„¤ëª…
 */

// Alpine.js ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ê¸€ë¡œë²Œ ìŠ¤í† ì–´
Alpine.store('adminDashboard', {
  // í†µê³„ ë°ì´í„°
  statistics: null,
  isLoadingStats: false,
  
  // ì‚¬ìš©ì ê´€ë¦¬
  users: [],
  isLoadingUsers: false,
  userFilters: {
    search: '',
    role: 'all',
    status: 'all'
  },
  
  // ì‹œìŠ¤í…œ ì„¤ì •
  systemSettings: [],
  isLoadingSettings: false,
  
  // ì—ëŸ¬ ì²˜ë¦¬
  error: null,
  
  // ê³„ì‚°ëœ ì†ì„±ë“¤
  get filteredUsers() {
    return this.users.filter(user => {
      const matchesSearch = !this.userFilters.search || 
        user.email.toLowerCase().includes(this.userFilters.search.toLowerCase());
      
      const matchesRole = this.userFilters.role === 'all' || 
        user.role === this.userFilters.role;
      
      const matchesStatus = this.userFilters.status === 'all' || 
        (this.userFilters.status === 'active' && user.is_active) ||
        (this.userFilters.status === 'inactive' && !user.is_active);
      
      return matchesSearch && matchesRole && matchesStatus;
    });
  },
  
  get isLoading() {
    return this.isLoadingStats || this.isLoadingUsers || this.isLoadingSettings;
  },
  
  // í†µê³„ ë°ì´í„° ë¡œë“œ
  async loadStatistics() {
    this.isLoadingStats = true;
    this.error = null;
    
    try {
      const response = await fetch('/api/admin/statistics', {
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').user?.access_token}`
        }
      });
      
      if (!response.ok) {
        throw new Error('í†µê³„ ë°ì´í„° ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      }
      
      this.statistics = await response.json();
    } catch (error) {
      this.error = error.message;
      console.error('í†µê³„ ë¡œë“œ ì˜¤ë¥˜:', error);
    } finally {
      this.isLoadingStats = false;
    }
  },
  
  // ì‚¬ìš©ì ë¡œë“œ
  async loadUsers() {
    this.isLoadingUsers = true;
    this.error = null;
    
    try {
      const response = await fetch('/api/admin/users', {
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').user?.access_token}`
        }
      });
      
      if (!response.ok) {
        throw new Error('ì‚¬ìš©ì ë°ì´í„° ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      }
      
      this.users = await response.json();
    } catch (error) {
      this.error = error.message;
      console.error('ì‚¬ìš©ì ë¡œë“œ ì˜¤ë¥˜:', error);
    } finally {
      this.isLoadingUsers = false;
    }
  },
  
  // ì‚¬ìš©ì ì—­í•  ë³€ê²½
  async updateUserRole(userId, newRole) {
    try {
      const response = await fetch(`/api/admin/users/${userId}/role`, {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').user?.access_token}`
        },
        body: JSON.stringify({ role: newRole })
      });
      
      if (!response.ok) {
        throw new Error('ì‚¬ìš©ì ì—­í•  ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      }
      
      // ì‚¬ìš©ì ëª©ë¡ì—ì„œ í•´ë‹¹ ì‚¬ìš©ì ì—…ë°ì´íŠ¸
      const userIndex = this.users.findIndex(user => user.id === userId);
      if (userIndex !== -1) {
        this.users[userIndex].role = newRole;
      }
      
      // ì„±ê³µ ì•Œë¦¼
      Alpine.store('ui').showNotification('ì‚¬ìš©ì ì—­í• ì´ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
      
    } catch (error) {
      this.error = error.message;
      console.error('ì—­í•  ë³€ê²½ ì˜¤ë¥˜:', error);
    }
  },
  
  // ì‚¬ìš©ì í™œì„±/ë¹„í™œì„± í† ê¸€
  async toggleUserActive(userId) {
    try {
      const user = this.users.find(u => u.id === userId);
      if (!user) return;
      
      const response = await fetch(`/api/admin/users/${userId}/toggle-active`, {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').user?.access_token}`
        }
      });
      
      if (!response.ok) {
        throw new Error('ì‚¬ìš©ì ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      }
      
      // ì‚¬ìš©ì ëª©ë¡ì—ì„œ í•´ë‹¹ ì‚¬ìš©ì ìƒíƒœ ì—…ë°ì´íŠ¸
      const userIndex = this.users.findIndex(u => u.id === userId);
      if (userIndex !== -1) {
        this.users[userIndex].is_active = !this.users[userIndex].is_active;
      }
      
      // ì„±ê³µ ì•Œë¦¼
      const status = user.is_active ? 'ë¹„í™œì„±í™”' : 'í™œì„±í™”';
      Alpine.store('ui').showNotification(`ì‚¬ìš©ìê°€ ì„±ê³µì ìœ¼ë¡œ ${status}ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
      
    } catch (error) {
      this.error = error.message;
      console.error('ì‚¬ìš©ì ìƒíƒœ ë³€ê²½ ì˜¤ë¥˜:', error);
    }
  },
  
  // ì‚¬ìš©ì í•„í„° ì„¤ì •
  setUserFilters(filters) {
    this.userFilters = { ...this.userFilters, ...filters };
  },
  
  // ì‹œìŠ¤í…œ ì„¤ì • ë¡œë“œ
  async loadSystemSettings() {
    this.isLoadingSettings = true;
    this.error = null;
    
    try {
      const response = await fetch('/api/admin/system-settings', {
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').user?.access_token}`
        }
      });
      
      if (!response.ok) {
        throw new Error('ì‹œìŠ¤í…œ ì„¤ì • ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      }
      
      this.systemSettings = await response.json();
    } catch (error) {
      this.error = error.message;
      console.error('ì‹œìŠ¤í…œ ì„¤ì • ë¡œë“œ ì˜¤ë¥˜:', error);
    } finally {
      this.isLoadingSettings = false;
    }
  },
  
  // ì‹œìŠ¤í…œ ì„¤ì • ì—…ë°ì´íŠ¸
  async updateSystemSetting(key, value) {
    try {
      const response = await fetch(`/api/admin/system-settings/${key}`, {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').user?.access_token}`
        },
        body: JSON.stringify({ value })
      });
      
      if (!response.ok) {
        throw new Error('ì‹œìŠ¤í…œ ì„¤ì • ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      }
      
      // ì„¤ì • ëª©ë¡ì—ì„œ í•´ë‹¹ ì„¤ì • ì—…ë°ì´íŠ¸
      const settingIndex = this.systemSettings.findIndex(
        setting => setting.setting_key === key
      );
      if (settingIndex !== -1) {
        this.systemSettings[settingIndex].setting_value = value;
      }
      
      // ì„±ê³µ ì•Œë¦¼
      Alpine.store('ui').showNotification('ì‹œìŠ¤í…œ ì„¤ì •ì´ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
      
    } catch (error) {
      this.error = error.message;
      console.error('ì‹œìŠ¤í…œ ì„¤ì • ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);
    }
  },
  
  // ì—ëŸ¬ ì„¤ì •
  setError(error) {
    this.error = error;
  },
  
  // ì—ëŸ¬ ì´ˆê¸°í™”
  clearError() {
    this.error = null;
  },
  
  // ì „ì²´ ë°ì´í„° ì´ˆê¸°í™”
  reset() {
    this.statistics = null;
    this.users = [];
    this.systemSettings = [];
    this.userFilters = { search: '', role: 'all', status: 'all' };
    this.error = null;
    this.isLoadingStats = false;
    this.isLoadingUsers = false;
    this.isLoadingSettings = false;
  }
});

// Alpine.js ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì»´í¬ë„ŒíŠ¸ ë°ì´í„°
Alpine.data('adminDashboardComponent', () => ({
  // í˜„ì¬ í™œì„± íƒ­
  activeTab: 'statistics',
  
  // íƒ­ ë³€ê²½
  setActiveTab(tab) {
    this.activeTab = tab;
    
    // íƒ­ë³„ ë°ì´í„° ë¡œë“œ
    const store = Alpine.store('adminDashboard');
    switch (tab) {
      case 'statistics':
        if (!store.statistics) store.loadStatistics();
        break;
      case 'users':
        if (store.users.length === 0) store.loadUsers();
        break;
      case 'settings':
        if (store.systemSettings.length === 0) store.loadSystemSettings();
        break;
    }
  },
  
  // ì´ˆê¸°í™” ì‹œ ì‹¤í–‰
  init() {
    // í˜ì´ì§€ ë¡œë“œ ì‹œ í†µê³„ ë°ì´í„° ìë™ ë¡œë“œ
    Alpine.store('adminDashboard').loadStatistics();
  }
}));
```

### 6.8.2 ì•Œë¦¼ ì‹œìŠ¤í…œ ìƒíƒœ

**Alpine.js ì•Œë¦¼ ì‹œìŠ¤í…œ ìŠ¤í† ì–´**
```javascript
/**
 * @typedef {Object} Notification - ì•Œë¦¼ ì •ë³´
 * @property {string} id - ì•Œë¦¼ ID
 * @property {string} title - ì œëª©
 * @property {string} message - ë‚´ìš©
 * @property {string} type - ìœ í˜• (info, success, warning, error)
 * @property {boolean} is_read - ì½ìŒ ì—¬ë¶€
 * @property {string} user_id - ëŒ€ìƒ ì‚¬ìš©ì ID
 * @property {string} created_at - ìƒì„±ì¼ì‹œ
 * @property {string|null} action_url - ì•¡ì…˜ URL
 */

// Alpine.js ì•Œë¦¼ ì‹œìŠ¤í…œ ê¸€ë¡œë²Œ ìŠ¤í† ì–´
Alpine.store('notifications', {
  // ì•Œë¦¼ ë°ì´í„°
  notifications: [],
  unreadCount: 0,
  isLoading: false,
  isOpen: false,
  error: null,
  
  // ì•Œë¦¼ ìë™ ìƒˆë¡œê³ ì¹¨ ìƒíƒœ
  autoRefresh: true,
  refreshInterval: null,
  
  // ê³„ì‚°ëœ ì†ì„±ë“¤
  get recentNotifications() {
    return this.notifications
      .sort((a, b) => new Date(b.created_at) - new Date(a.created_at))
      .slice(0, 10); // ìµœê·¼ 10ê°œë§Œ í‘œì‹œ
  },
  
  get unreadNotifications() {
    return this.notifications.filter(n => !n.is_read);
  },
  
  get hasUnread() {
    return this.unreadCount > 0;
  },
  
  // ì•Œë¦¼ ë¡œë“œ
  async loadNotifications() {
    this.isLoading = true;
    this.error = null;
    
    try {
      const response = await fetch('/api/notifications', {
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').user?.access_token}`
        }
      });
      
      if (!response.ok) {
        throw new Error('ì•Œë¦¼ ë°ì´í„° ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      }
      
      this.notifications = await response.json();
      this.unreadCount = this.notifications.filter(n => !n.is_read).length;
      
    } catch (error) {
      this.error = error.message;
      console.error('ì•Œë¦¼ ë¡œë“œ ì˜¤ë¥˜:', error);
    } finally {
      this.isLoading = false;
    }
  },
  
  // ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬
  async markAsRead(notificationId) {
    try {
      const response = await fetch(`/api/notifications/${notificationId}/read`, {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').user?.access_token}`
        }
      });
      
      if (!response.ok) {
        throw new Error('ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      }
      
      // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸
      const notificationIndex = this.notifications.findIndex(n => n.id === notificationId);
      if (notificationIndex !== -1 && !this.notifications[notificationIndex].is_read) {
        this.notifications[notificationIndex].is_read = true;
        this.unreadCount = Math.max(0, this.unreadCount - 1);
      }
      
    } catch (error) {
      this.error = error.message;
      console.error('ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
    }
  },
  
  // ëª¨ë“  ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬
  async markAllAsRead() {
    if (this.unreadCount === 0) return;
    
    try {
      const response = await fetch('/api/notifications/read-all', {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').user?.access_token}`
        }
      });
      
      if (!response.ok) {
        throw new Error('ëª¨ë“  ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      }
      
      // ëª¨ë“  ì•Œë¦¼ì„ ì½ìŒ ìƒíƒœë¡œ ë³€ê²½
      this.notifications = this.notifications.map(n => ({ ...n, is_read: true }));
      this.unreadCount = 0;
      
      // ì„±ê³µ ì•Œë¦¼
      Alpine.store('ui').showNotification('ëª¨ë“  ì•Œë¦¼ì„ ì½ìŒ ì²˜ë¦¬í–ˆìŠµë‹ˆë‹¤.', 'success');
      
    } catch (error) {
      this.error = error.message;
      console.error('ëª¨ë“  ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
    }
  },
  
  // ì•Œë¦¼ ì‚­ì œ
  async deleteNotification(notificationId) {
    try {
      const response = await fetch(`/api/notifications/${notificationId}`, {
        method: 'DELETE',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').user?.access_token}`
        }
      });
      
      if (!response.ok) {
        throw new Error('ì•Œë¦¼ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      }
      
      // ë¡œì»¬ ìƒíƒœì—ì„œ ì•Œë¦¼ ì œê±°
      const notification = this.notifications.find(n => n.id === notificationId);
      if (notification && !notification.is_read) {
        this.unreadCount = Math.max(0, this.unreadCount - 1);
      }
      
      this.notifications = this.notifications.filter(n => n.id !== notificationId);
      
      // ì„±ê³µ ì•Œë¦¼
      Alpine.store('ui').showNotification('ì•Œë¦¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
      
    } catch (error) {
      this.error = error.message;
      console.error('ì•Œë¦¼ ì‚­ì œ ì˜¤ë¥˜:', error);
    }
  },
  
  // ìƒˆ ì•Œë¦¼ ë°œì†¡
  async sendNotification(notificationData) {
    try {
      const response = await fetch('/api/notifications', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').user?.access_token}`
        },
        body: JSON.stringify(notificationData)
      });
      
      if (!response.ok) {
        throw new Error('ì•Œë¦¼ ë°œì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      }
      
      // ìƒˆ ì•Œë¦¼ ë¡œë“œ
      await this.loadNotifications();
      
      // ì„±ê³µ ì•Œë¦¼
      Alpine.store('ui').showNotification('ì•Œë¦¼ì´ ì„±ê³µì ìœ¼ë¡œ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
      
    } catch (error) {
      this.error = error.message;
      console.error('ì•Œë¦¼ ë°œì†¡ ì˜¤ë¥˜:', error);
    }
  },
  
  // ì•Œë¦¼ íŒ¨ë„ í† ê¸€
  toggleNotificationPanel() {
    this.isOpen = !this.isOpen;
    
    // íŒ¨ë„ì´ ì—´ë¦´ ë•Œ ì•Œë¦¼ ë¡œë“œ
    if (this.isOpen && this.notifications.length === 0) {
      this.loadNotifications();
    }
  },
  
  // ì•Œë¦¼ íŒ¨ë„ ì—´ê¸°/ë‹«ê¸°
  setOpen(isOpen) {
    this.isOpen = isOpen;
    
    // íŒ¨ë„ì´ ì—´ë¦´ ë•Œ ì•Œë¦¼ ë¡œë“œ
    if (isOpen && this.notifications.length === 0) {
      this.loadNotifications();
    }
  },
  
  // ìë™ ìƒˆë¡œê³ ì¹¨ ì‹œì‘
  startAutoRefresh() {
    if (this.refreshInterval) return;
    
    this.autoRefresh = true;
    this.refreshInterval = setInterval(() => {
      if (!document.hidden) { // íƒ­ì´ í™œì„± ìƒíƒœì¼ ë•Œë§Œ ìƒˆë¡œê³ ì¹¨
        this.loadNotifications();
      }
    }, 30000); // 30ì´ˆë§ˆë‹¤ ìƒˆë¡œê³ ì¹¨
  },
  
  // ìë™ ìƒˆë¡œê³ ì¹¨ ì¤‘ì§€
  stopAutoRefresh() {
    if (this.refreshInterval) {
      clearInterval(this.refreshInterval);
      this.refreshInterval = null;
    }
    this.autoRefresh = false;
  },
  
  // ì—ëŸ¬ ì´ˆê¸°í™”
  clearError() {
    this.error = null;
  },
  
  // ì „ì²´ ë°ì´í„° ì´ˆê¸°í™”
  reset() {
    this.stopAutoRefresh();
    this.notifications = [];
    this.unreadCount = 0;
    this.isOpen = false;
    this.error = null;
    this.isLoading = false;
  }
});

// Alpine.js ì•Œë¦¼ íŒ¨ë„ ì»´í¬ë„ŒíŠ¸ ë°ì´í„°
Alpine.data('notificationPanel', () => ({
  // í˜„ì¬ í‘œì‹œ ëª¨ë“œ (ì „ì²´/ì½ì§€ì•ŠìŒ)
  viewMode: 'all',
  
  // ë³´ê¸° ëª¨ë“œ ë³€ê²½
  setViewMode(mode) {
    this.viewMode = mode;
  },
  
  // í‘œì‹œí•  ì•Œë¦¼ ëª©ë¡
  get displayNotifications() {
    const store = Alpine.store('notifications');
    
    if (this.viewMode === 'unread') {
      return store.unreadNotifications;
    }
    
    return store.recentNotifications;
  },
  
  // ì•Œë¦¼ í´ë¦­ ì²˜ë¦¬
  async handleNotificationClick(notification) {
    // ì•Œë¦¼ì„ ì½ìŒìœ¼ë¡œ ì²˜ë¦¬
    if (!notification.is_read) {
      await Alpine.store('notifications').markAsRead(notification.id);
    }
    
    // ì•¡ì…˜ URLì´ ìˆìœ¼ë©´ ì´ë™
    if (notification.action_url) {
      window.location.href = notification.action_url;
    }
  },
  
  // ì´ˆê¸°í™” ì‹œ ì‹¤í–‰
  init() {
    // ì»´í¬ë„ŒíŠ¸ ìƒì„± ì‹œ ìë™ ìƒˆë¡œê³ ì¹¨ ì‹œì‘
    Alpine.store('notifications').startAutoRefresh();
    
    // ì»´í¬ë„ŒíŠ¸ íŒŒê´´ ì‹œ ì •ë¦¬
    this.$cleanup(() => {
      Alpine.store('notifications').stopAutoRefresh();
    });
  }
}));
```

### 6.8.3 ë¡œê·¸ì¸ ê¸°ë¡ ìƒíƒœ

**Alpine.js ë¡œê·¸ì¸ ê¸°ë¡ ìŠ¤í† ì–´**
```javascript
/**
 * @typedef {Object} AdminLoginLog - ê´€ë¦¬ì ë¡œê·¸ì¸ ê¸°ë¡
 * @property {string} id - ë¡œê·¸ ID
 * @property {string} user_id - ì‚¬ìš©ì ID
 * @property {string} user_email - ì‚¬ìš©ì ì´ë©”ì¼
 * @property {string} login_type - ë¡œê·¸ì¸ ìœ í˜• (email, social, admin)
 * @property {string} ip_address - IP ì£¼ì†Œ
 * @property {string} user_agent - ë¸Œë¼ìš°ì € ì •ë³´
 * @property {string} login_at - ë¡œê·¸ì¸ ì‹œê°„
 * @property {boolean} success - ì„±ê³µ ì—¬ë¶€
 * @property {string|null} failure_reason - ì‹¤íŒ¨ ì‚¬ìœ 
 */

// Alpine.js ë¡œê·¸ì¸ ê¸°ë¡ ê¸€ë¡œë²Œ ìŠ¤í† ì–´
Alpine.store('loginLogs', {
  // ë¡œê·¸ ë°ì´í„°
  logs: [],
  isLoading: false,
  error: null,
  
  // í•„í„° ì„¤ì •
  filters: {
    dateRange: {
      start: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0], // 30ì¼ ì „
      end: new Date().toISOString().split('T')[0] // ì˜¤ëŠ˜
    },
    loginType: 'all', // all, email, social, admin
    searchTerm: '',
    successOnly: false // ì„±ê³µí•œ ë¡œê·¸ì¸ë§Œ í‘œì‹œ
  },
  
  // í˜ì´ì§€ë„¤ì´ì…˜
  pagination: {
    page: 1,
    limit: 20,
    total: 0
  },
  
  // ê³„ì‚°ëœ ì†ì„±ë“¤
  get filteredLogs() {
    let filtered = [...this.logs];
    
    // ê²€ìƒ‰ì–´ í•„í„°
    if (this.filters.searchTerm) {
      const term = this.filters.searchTerm.toLowerCase();
      filtered = filtered.filter(log => 
        log.user_email.toLowerCase().includes(term) ||
        log.ip_address.includes(term)
      );
    }
    
    // ë¡œê·¸ì¸ ìœ í˜• í•„í„°
    if (this.filters.loginType !== 'all') {
      filtered = filtered.filter(log => log.login_type === this.filters.loginType);
    }
    
    // ì„±ê³µ ë¡œê·¸ì¸ë§Œ í‘œì‹œ
    if (this.filters.successOnly) {
      filtered = filtered.filter(log => log.success);
    }
    
    return filtered;
  },
  
  get totalPages() {
    return Math.ceil(this.pagination.total / this.pagination.limit);
  },
  
  get hasNextPage() {
    return this.pagination.page < this.totalPages;
  },
  
  get hasPrevPage() {
    return this.pagination.page > 1;
  },
  
  // ë¡œê·¸ ë¡œë“œ
  async loadLogs() {
    this.isLoading = true;
    this.error = null;
    
    try {
      const params = new URLSearchParams({
        page: this.pagination.page.toString(),
        limit: this.pagination.limit.toString(),
        startDate: this.filters.dateRange.start,
        endDate: this.filters.dateRange.end,
        loginType: this.filters.loginType,
        search: this.filters.searchTerm,
        successOnly: this.filters.successOnly.toString()
      });
      
      const response = await fetch(`/api/admin/login-logs?${params}`, {
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${Alpine.store('auth').user?.access_token}`
        }
      });
      
      if (!response.ok) {
        throw new Error('ë¡œê·¸ì¸ ê¸°ë¡ ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      }
      
      const { data, total } = await response.json();
      
      this.logs = data;
      this.pagination.total = total;
      
    } catch (error) {
      this.error = error.message;
      console.error('ë¡œê·¸ì¸ ê¸°ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
    } finally {
      this.isLoading = false;
    }
  },
  
  // í•„í„° ì„¤ì •
  setFilters(newFilters) {
    this.filters = { ...this.filters, ...newFilters };
    this.pagination.page = 1; // í•„í„° ë³€ê²½ ì‹œ ì²« í˜ì´ì§€ë¡œ
    
    // ìë™ìœ¼ë¡œ ë¡œê·¸ ë‹¤ì‹œ ë¡œë“œ
    this.loadLogs();
  },
  
  // ë‚ ì§œ ë²”ìœ„ ì„¤ì •
  setDateRange(start, end) {
    this.filters.dateRange = { start, end };
    this.pagination.page = 1;
    this.loadLogs();
  },
  
  // ë¯¸ë¦¬ ì •ì˜ëœ ë‚ ì§œ ë²”ìœ„ ì„¤ì •
  setDateRangePreset(preset) {
    const now = new Date();
    let start;
    
    switch (preset) {
      case 'today':
        start = new Date(now);
        break;
      case 'week':
        start = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
        break;
      case 'month':
        start = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
        break;
      case 'quarter':
        start = new Date(now.getTime() - 90 * 24 * 60 * 60 * 1000);
        break;
      default:
        start = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
    }
    
    this.setDateRange(
      start.toISOString().split('T')[0],
      now.toISOString().split('T')[0]
    );
  },
  
  // í˜ì´ì§€ ì„¤ì •
  setPage(page) {
    if (page < 1 || page > this.totalPages) return;
    
    this.pagination.page = page;
    this.loadLogs();
  },
  
  // ì´ì „ í˜ì´ì§€
  previousPage() {
    if (this.hasPrevPage) {
      this.setPage(this.pagination.page - 1);
    }
  },
  
  // ë‹¤ìŒ í˜ì´ì§€
  nextPage() {
    if (this.hasNextPage) {
      this.setPage(this.pagination.page + 1);
    }
  },
  
  // í˜ì´ì§€ í¬ê¸° ì„¤ì •
  setLimit(limit) {
    this.pagination.limit = limit;
    this.pagination.page = 1; // ì²« í˜ì´ì§€ë¡œ ì¬ì„¤ì •
    this.loadLogs();
  },
  
  // ë¡œê·¸ ë‚´ë³´ë‚´ê¸° (CSV)
  async exportLogs() {
    try {
      const params = new URLSearchParams({
        startDate: this.filters.dateRange.start,
        endDate: this.filters.dateRange.end,
        loginType: this.filters.loginType,
        search: this.filters.searchTerm,
        successOnly: this.filters.successOnly.toString(),
        format: 'csv'
      });
      
      const response = await fetch(`/api/admin/login-logs/export?${params}`, {
        headers: {
          'Authorization': `Bearer ${Alpine.store('auth').user?.access_token}`
        }
      });
      
      if (!response.ok) {
        throw new Error('ë¡œê·¸ ë‚´ë³´ë‚´ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      }
      
      // íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì²˜ë¦¬
      const blob = await response.blob();
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `login-logs-${this.filters.dateRange.start}-${this.filters.dateRange.end}.csv`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      window.URL.revokeObjectURL(url);
      
      // ì„±ê³µ ì•Œë¦¼
      Alpine.store('ui').showNotification('ë¡œê·¸ì¸ ê¸°ë¡ì´ CSV íŒŒì¼ë¡œ ë‚´ë³´ë‚´ì¡ŒìŠµë‹ˆë‹¤.', 'success');
      
    } catch (error) {
      this.error = error.message;
      console.error('ë¡œê·¸ ë‚´ë³´ë‚´ê¸° ì˜¤ë¥˜:', error);
    }
  },
  
  // ì—ëŸ¬ ì´ˆê¸°í™”
  clearError() {
    this.error = null;
  },
  
  // ì „ì²´ ë°ì´í„° ì´ˆê¸°í™”
  reset() {
    this.logs = [];
    this.pagination = { page: 1, limit: 20, total: 0 };
    this.filters = {
      dateRange: {
        start: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
        end: new Date().toISOString().split('T')[0]
      },
      loginType: 'all',
      searchTerm: '',
      successOnly: false
    };
    this.error = null;
    this.isLoading = false;
  }
});

// Alpine.js ë¡œê·¸ì¸ ê¸°ë¡ ì»´í¬ë„ŒíŠ¸ ë°ì´í„°
Alpine.data('loginLogsComponent', () => ({
  // ë‚ ì§œ ì„ íƒê¸° ì—´ê¸°/ë‹«ê¸°
  isDatePickerOpen: false,
  
  // ë‚ ì§œ ì„ íƒê¸° í† ê¸€
  toggleDatePicker() {
    this.isDatePickerOpen = !this.isDatePickerOpen;
  },
  
  // ë¡œê·¸ ìœ í˜•ë³„ ë°°ì§€ ìƒ‰ìƒ
  getLoginTypeBadgeClass(loginType) {
    const classes = {
      'email': 'badge-primary',
      'social': 'badge-success', 
      'admin': 'badge-warning'
    };
    return classes[loginType] || 'badge-secondary';
  },
  
  // ë¡œê·¸ì¸ ì„±ê³µ/ì‹¤íŒ¨ ì•„ì´ì½˜
  getStatusIcon(success) {
    return success ? 'âœ“' : 'âœ—';
  },
  
  // ë¡œê·¸ì¸ ì„±ê³µ/ì‹¤íŒ¨ ìƒ‰ìƒ
  getStatusClass(success) {
    return success ? 'text-success' : 'text-danger';
  },
  
  // IP ì£¼ì†Œ í¬ë§·íŒ…
  formatIPAddress(ip) {
    // IPv4 ì£¼ì†Œ ê²€ì¦ ë° í¬ë§·íŒ…
    const ipv4Regex = /^(\d{1,3}\.){3}\d{1,3}$/;
    if (ipv4Regex.test(ip)) {
      return ip;
    }
    
    // IPv6 ì£¼ì†Œ ê°„ë‹¨íˆ í‘œì‹œ
    if (ip.includes(':')) {
      return ip.substring(0, 20) + (ip.length > 20 ? '...' : '');
    }
    
    return ip;
  },
  
  // ì‚¬ìš©ì ì—ì´ì „íŠ¸ ê°„ë‹¨íˆ í‘œì‹œ
  formatUserAgent(userAgent) {
    if (!userAgent) return 'ì•Œ ìˆ˜ ì—†ìŒ';
    
    // ì£¼ìš” ë¸Œë¼ìš°ì € ì´ë¦„ ì¶”ì¶œ
    if (userAgent.includes('Chrome')) return 'Chrome';
    if (userAgent.includes('Firefox')) return 'Firefox';
    if (userAgent.includes('Safari')) return 'Safari';
    if (userAgent.includes('Edge')) return 'Edge';
    
    return userAgent.substring(0, 30) + (userAgent.length > 30 ? '...' : '');
  },
  
  // ì´ˆê¸°í™” ì‹œ ì‹¤í–‰
  init() {
    // ì»´í¬ë„ŒíŠ¸ ë¡œë“œ ì‹œ ë¡œê·¸ ë°ì´í„° ìë™ ë¡œë“œ
    Alpine.store('loginLogs').loadLogs();
  }
}));
```

### 6.8.4 ê´€ë¦¬ì ìƒíƒœ í™œìš© ì˜ˆì‹œ
```html
<!-- ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ HTML + Alpine.js -->
<div class="admin-dashboard" 
     x-data="adminDashboard()" 
     x-init="init()">
  
  <!-- ì—ëŸ¬ ì²˜ë¦¬ -->
  <div x-show="error" 
       x-transition
       class="alert alert-error mb-4"
       role="alert">
    <span x-text="error"></span>
    <button @click="clearError()" 
            class="btn-close"
            aria-label="ì˜¤ë¥˜ ë©”ì‹œì§€ ë‹«ê¸°">
      âœ•
    </button>
  </div>
  
  <div class="space-y-6">
    <!-- í†µê³„ ì¹´ë“œ -->
    <div x-show="isLoadingStats" 
         class="stats-skeleton" 
         role="status" 
         aria-label="í†µê³„ ë¡œë”© ì¤‘">
      <div class="skeleton-card"></div>
      <div class="skeleton-card"></div>
      <div class="skeleton-card"></div>
    </div>
    
    <div x-show="!isLoadingStats" 
         class="stats-grid">
      <template x-for="stat in statistics">
        <div class="stat-card">
          <h3 x-text="stat.title"></h3>
          <span x-text="stat.value" class="stat-value"></span>
        </div>
      </template>
    </div>
    
    <!-- ì‚¬ìš©ì ê´€ë¦¬ í…Œì´ë¸” -->
    <div class="user-management-section">
      <h2>ì‚¬ìš©ì ê´€ë¦¬</h2>
      
      <div x-show="isLoadingUsers" 
           class="loading-indicator"
           role="status" 
           aria-label="ì‚¬ìš©ì ëª©ë¡ ë¡œë”© ì¤‘">
        <div class="spinner"></div>
      </div>
      
      <table x-show="!isLoadingUsers" 
             class="user-table table-responsive"
             role="table">
        <thead>
          <tr>
            <th>ì´ë¦„</th>
            <th>ì´ë©”ì¼</th>
            <th>ì—­í• </th>
            <th>ìƒíƒœ</th>
            <th>ì•¡ì…˜</th>
          </tr>
        </thead>
        <tbody>
          <template x-for="user in users" :key="user.id">
            <tr>
              <td x-text="user.name"></td>
              <td x-text="user.email"></td>
              <td>
                <select @change="updateUserRole(user.id, $event.target.value)"
                        :value="user.role"
                        class="role-select">
                  <option value="user">ì‚¬ìš©ì</option>
                  <option value="admin">ê´€ë¦¬ì</option>
                  <option value="teacher">êµì‚¬</option>
                </select>
              </td>
              <td>
                <span :class="user.active ? 'badge-active' : 'badge-inactive'"
                      x-text="user.active ? 'í™œì„±' : 'ë¹„í™œì„±'"></span>
              </td>
              <td>
                <button @click="toggleUserActive(user.id)"
                        :class="user.active ? 'btn-deactivate' : 'btn-activate'"
                        :aria-label="user.active ? user.name + ' ë¹„í™œì„±í™”' : user.name + ' í™œì„±í™”'">
                  <span x-text="user.active ? 'ë¹„í™œì„±í™”' : 'í™œì„±í™”'"></span>
                </button>
              </td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>
    
    <!-- ì•Œë¦¼ ì„¼í„° -->
    <div class="notification-center">
      <h2>ì•Œë¦¼ ì„¼í„° 
        <span x-show="unreadCount > 0" 
              x-text="'(' + unreadCount + ')'"
              class="unread-badge"
              aria-label="ì½ì§€ ì•Šì€ ì•Œë¦¼ ìˆ˜"></span>
      </h2>
      
      <div class="notification-actions">
        <button @click="markAllAsRead()" 
                :disabled="unreadCount === 0"
                class="btn btn-outline">
          ëª¨ë‘ ì½ìŒ ì²˜ë¦¬
        </button>
      </div>
      
      <div class="notifications-list">
        <template x-for="notification in notifications" :key="notification.id">
          <div :class="['notification-item', { 'unread': !notification.read }]">
            <div class="notification-content">
              <p x-text="notification.message"></p>
              <small x-text="formatDate(notification.created_at)" 
                     class="notification-date"></small>
            </div>
            <div class="notification-actions">
              <button x-show="!notification.read" 
                      @click="markAsRead(notification.id)"
                      class="btn-read"
                      :aria-label="'ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬: ' + notification.message">
                ì½ìŒ
              </button>
              <button @click="deleteNotification(notification.id)"
                      class="btn-delete"
                      :aria-label="'ì•Œë¦¼ ì‚­ì œ: ' + notification.message">
                ì‚­ì œ
              </button>
            </div>
          </div>
        </template>
      </div>
    </div>
  </div>
</div>

<script>
// ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ Alpine.js ë°ì´í„° í•¨ìˆ˜
function adminDashboard() {
  return {
    // ìƒíƒœ ë°ì´í„°
    statistics: [],
    users: [],
    notifications: [],
    
    // ë¡œë”© ìƒíƒœ
    isLoadingStats: false,
    isLoadingUsers: false,
    
    // ì•Œë¦¼ ê´€ë ¨
    unreadCount: 0,
    
    // ì—ëŸ¬ ì²˜ë¦¬
    error: null,
    
    // ì´ˆê¸°í™” í•¨ìˆ˜
    async init() {
      try {
        await Promise.all([
          this.loadStatistics(),
          this.loadUsers(),
          this.loadNotifications()
        ]);
      } catch (error) {
        this.error = 'ë°ì´í„° ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message;
      }
    },
    
    // í†µê³„ ë°ì´í„° ë¡œë“œ
    async loadStatistics() {
      this.isLoadingStats = true;
      try {
        const response = await fetch('/api/admin/statistics', {
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('token')}`,
            'Content-Type': 'application/json'
          }
        });
        
        if (!response.ok) {
          throw new Error('í†µê³„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
        }
        
        this.statistics = await response.json();
      } catch (error) {
        this.error = error.message;
      } finally {
        this.isLoadingStats = false;
      }
    },
    
    // ì‚¬ìš©ì ëª©ë¡ ë¡œë“œ
    async loadUsers() {
      this.isLoadingUsers = true;
      try {
        const response = await fetch('/api/admin/users', {
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('token')}`,
            'Content-Type': 'application/json'
          }
        });
        
        if (!response.ok) {
          throw new Error('ì‚¬ìš©ì ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
        }
        
        this.users = await response.json();
      } catch (error) {
        this.error = error.message;
      } finally {
        this.isLoadingUsers = false;
      }
    },
    
    // ì•Œë¦¼ ëª©ë¡ ë¡œë“œ
    async loadNotifications() {
      try {
        const response = await fetch('/api/admin/notifications', {
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('token')}`,
            'Content-Type': 'application/json'
          }
        });
        
        if (!response.ok) {
          throw new Error('ì•Œë¦¼ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
        }
        
        this.notifications = await response.json();
        this.unreadCount = this.notifications.filter(n => !n.read).length;
      } catch (error) {
        this.error = error.message;
      }
    },
    
    // ì‚¬ìš©ì ì—­í•  ì—…ë°ì´íŠ¸
    async updateUserRole(userId, newRole) {
      try {
        const response = await fetch(`/api/admin/users/${userId}/role`, {
          method: 'PUT',
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('token')}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ role: newRole })
        });
        
        if (!response.ok) {
          throw new Error('ì‚¬ìš©ì ì—­í•  ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
        }
        
        // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸
        const userIndex = this.users.findIndex(u => u.id === userId);
        if (userIndex !== -1) {
          this.users[userIndex].role = newRole;
        }
      } catch (error) {
        this.error = error.message;
      }
    },
    
    // ì‚¬ìš©ì í™œì„± ìƒíƒœ í† ê¸€
    async toggleUserActive(userId) {
      try {
        const user = this.users.find(u => u.id === userId);
        const newStatus = !user.active;
        
        const response = await fetch(`/api/admin/users/${userId}/status`, {
          method: 'PUT',
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('token')}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ active: newStatus })
        });
        
        if (!response.ok) {
          throw new Error('ì‚¬ìš©ì ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
        }
        
        // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸
        user.active = newStatus;
      } catch (error) {
        this.error = error.message;
      }
    },
    
    // ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬
    async markAsRead(notificationId) {
      try {
        const response = await fetch(`/api/admin/notifications/${notificationId}/read`, {
          method: 'PUT',
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('token')}`,
            'Content-Type': 'application/json'
          }
        });
        
        if (!response.ok) {
          throw new Error('ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
        }
        
        // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸
        const notification = this.notifications.find(n => n.id === notificationId);
        if (notification && !notification.read) {
          notification.read = true;
          this.unreadCount--;
        }
      } catch (error) {
        this.error = error.message;
      }
    },
    
    // ëª¨ë“  ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬
    async markAllAsRead() {
      try {
        const response = await fetch('/api/admin/notifications/read-all', {
          method: 'PUT',
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('token')}`,
            'Content-Type': 'application/json'
          }
        });
        
        if (!response.ok) {
          throw new Error('ëª¨ë“  ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
        }
        
        // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸
        this.notifications.forEach(n => n.read = true);
        this.unreadCount = 0;
      } catch (error) {
        this.error = error.message;
      }
    },
    
    // ì•Œë¦¼ ì‚­ì œ
    async deleteNotification(notificationId) {
      try {
        const response = await fetch(`/api/admin/notifications/${notificationId}`, {
          method: 'DELETE',
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('token')}`,
            'Content-Type': 'application/json'
          }
        });
        
        if (!response.ok) {
          throw new Error('ì•Œë¦¼ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
        }
        
        // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸
        const notificationIndex = this.notifications.findIndex(n => n.id === notificationId);
        if (notificationIndex !== -1) {
          const notification = this.notifications[notificationIndex];
          this.notifications.splice(notificationIndex, 1);
          if (!notification.read) {
            this.unreadCount--;
          }
        }
      } catch (error) {
        this.error = error.message;
      }
    },
    
    // ì—ëŸ¬ ë©”ì‹œì§€ í´ë¦¬ì–´
    clearError() {
      this.error = null;
    },
    
    // ë‚ ì§œ í¬ë§·íŒ… ìœ í‹¸ë¦¬í‹°
    formatDate(dateString) {
      return new Date(dateString).toLocaleString('ko-KR', {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit'
      });
    }
  };
}
</script>

<!-- ë¡œê·¸ì¸ ê¸°ë¡ ë·°ì–´ HTML + Alpine.js -->
<div class="login-log-viewer" 
     x-data="loginLogViewer()" 
     x-init="init()">
  
  <!-- ì—ëŸ¬ ì²˜ë¦¬ -->
  <div x-show="error" 
       x-transition
       class="alert alert-error mb-4"
       role="alert">
    <span x-text="error"></span>
    <button @click="clearError()" 
            class="btn-close"
            aria-label="ì˜¤ë¥˜ ë©”ì‹œì§€ ë‹«ê¸°">
      âœ•
    </button>
  </div>
  
  <div class="space-y-4">
    <!-- í•„í„° ì„¹ì…˜ -->
    <div class="log-filters">
      <h2>ë¡œê·¸ì¸ ê¸°ë¡ í•„í„°</h2>
      
      <div class="filter-controls">
        <div class="filter-item">
          <label for="user-filter">ì‚¬ìš©ì:</label>
          <input type="text" 
                 id="user-filter"
                 x-model="filters.user"
                 @input="debounceFilter()"
                 placeholder="ì‚¬ìš©ìëª… ë˜ëŠ” ì´ë©”ì¼ë¡œ ê²€ìƒ‰"
                 class="filter-input">
        </div>
        
        <div class="filter-item">
          <label for="date-from">ì‹œì‘ì¼:</label>
          <input type="date" 
                 id="date-from"
                 x-model="filters.dateFrom"
                 @change="applyFilters()"
                 class="filter-input">
        </div>
        
        <div class="filter-item">
          <label for="date-to">ì¢…ë£Œì¼:</label>
          <input type="date" 
                 id="date-to"
                 x-model="filters.dateTo"
                 @change="applyFilters()"
                 class="filter-input">
        </div>
        
        <div class="filter-item">
          <label for="status-filter">ìƒíƒœ:</label>
          <select id="status-filter"
                  x-model="filters.status"
                  @change="applyFilters()"
                  class="filter-input">
            <option value="">ì „ì²´</option>
            <option value="success">ì„±ê³µ</option>
            <option value="failed">ì‹¤íŒ¨</option>
          </select>
        </div>
        
        <button @click="resetFilters()" 
                class="btn btn-outline">
          í•„í„° ì´ˆê¸°í™”
        </button>
      </div>
    </div>
    
    <!-- ë¡œê·¸ í…Œì´ë¸” -->
    <div class="log-table-container">
      <div x-show="isLoading" 
           class="loading-indicator"
           role="status" 
           aria-label="ë¡œê·¸ì¸ ê¸°ë¡ ë¡œë”© ì¤‘">
        <div class="spinner"></div>
        <span>ë¡œê·¸ì¸ ê¸°ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span>
      </div>
      
      <table x-show="!isLoading" 
             class="log-table table-responsive"
             role="table">
        <thead>
          <tr>
            <th @click="sortBy('timestamp')"
                :class="{ active: sortColumn === 'timestamp' }"
                class="sortable">
              ì‹œê°„ 
              <span x-show="sortColumn === 'timestamp'"
                    :class="sortDirection === 'asc' ? 'sort-asc' : 'sort-desc'"
                    aria-hidden="true">â‡…</span>
            </th>
            <th>ì‚¬ìš©ì</th>
            <th>ì´ë©”ì¼</th>
            <th @click="sortBy('status')"
                :class="{ active: sortColumn === 'status' }"
                class="sortable">
              ìƒíƒœ
              <span x-show="sortColumn === 'status'"
                    :class="sortDirection === 'asc' ? 'sort-asc' : 'sort-desc'"
                    aria-hidden="true">â‡…</span>
            </th>
            <th>IP ì£¼ì†Œ</th>
            <th>ë¸Œë¼ìš°ì €</th>
          </tr>
        </thead>
        <tbody>
          <template x-for="log in paginatedLogs" :key="log.id">
            <tr :class="{ 'log-failed': log.status === 'failed' }">
              <td x-text="formatDate(log.timestamp)"></td>
              <td x-text="log.user_name"></td>
              <td x-text="log.user_email"></td>
              <td>
                <span :class="log.status === 'success' ? 'badge-success' : 'badge-error'"
                      x-text="log.status === 'success' ? 'ì„±ê³µ' : 'ì‹¤íŒ¨'"></span>
              </td>
              <td x-text="log.ip_address"></td>
              <td x-text="log.user_agent" class="truncate"></td>
            </tr>
          </template>
        </tbody>
      </table>
      
      <!-- ë¹ˆ ìƒíƒœ -->
      <div x-show="!isLoading && paginatedLogs.length === 0" 
           class="empty-state">
        <p>ê²€ìƒ‰ ì¡°ê±´ì— ë§ëŠ” ë¡œê·¸ì¸ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>
      </div>
    </div>
    
    <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
    <div x-show="!isLoading && totalPages > 1" 
         class="pagination" 
         role="navigation" 
         aria-label="ë¡œê·¸ì¸ ê¸°ë¡ í˜ì´ì§€ë„¤ì´ì…˜">
      <button @click="setPage(1)" 
              :disabled="currentPage === 1"
              class="pagination-btn"
              aria-label="ì²« í˜ì´ì§€ë¡œ">
        âŸª
      </button>
      
      <button @click="setPage(currentPage - 1)" 
              :disabled="currentPage === 1"
              class="pagination-btn"
              aria-label="ì´ì „ í˜ì´ì§€">
        âŸ¨
      </button>
      
      <span class="pagination-info">
        <span x-text="currentPage"></span> / <span x-text="totalPages"></span>
      </span>
      
      <button @click="setPage(currentPage + 1)" 
              :disabled="currentPage === totalPages"
              class="pagination-btn"
              aria-label="ë‹¤ìŒ í˜ì´ì§€">
        âŸ©
      </button>
      
      <button @click="setPage(totalPages)" 
              :disabled="currentPage === totalPages"
              class="pagination-btn"
              aria-label="ë§ˆì§€ë§‰ í˜ì´ì§€ë¡œ">
        âŸ«
      </button>
      
      <div class="pagination-size">
        <label for="page-size">í˜ì´ì§€ í¬ê¸°:</label>
        <select id="page-size"
                x-model="pageSize"
                @change="setLimit($event.target.value)"
                class="pagination-select">
          <option value="10">10</option>
          <option value="25">25</option>
          <option value="50">50</option>
          <option value="100">100</option>
        </select>
      </div>
    </div>
  </div>
</div>

<script>
// ë¡œê·¸ì¸ ê¸°ë¡ ë·°ì–´ Alpine.js ë°ì´í„° í•¨ìˆ˜
function loginLogViewer() {
  return {
    // ë¡œê·¸ ë°ì´í„°
    logs: [],
    filteredLogs: [],
    paginatedLogs: [],
    
    // ë¡œë”© ìƒíƒœ
    isLoading: false,
    
    // í•„í„° ìƒíƒœ
    filters: {
      user: '',
      dateFrom: '',
      dateTo: '',
      status: ''
    },
    
    // ì •ë ¬ ìƒíƒœ
    sortColumn: 'timestamp',
    sortDirection: 'desc',
    
    // í˜ì´ì§€ë„¤ì´ì…˜ ìƒíƒœ
    currentPage: 1,
    pageSize: 25,
    totalPages: 1,
    
    // ì—ëŸ¬ ìƒíƒœ
    error: null,
    
    // ë””ë°”ìš´ìŠ¤ íƒ€ì´ë¨¸
    filterTimeout: null,
    
    // ì´ˆê¸°í™”
    async init() {
      await this.loadLogs();
    },
    
    // ë¡œê·¸ ë°ì´í„° ë¡œë“œ
    async loadLogs() {
      this.isLoading = true;
      try {
        const response = await fetch('/api/admin/login-logs', {
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('token')}`,
            'Content-Type': 'application/json'
          }
        });
        
        if (!response.ok) {
          throw new Error('ë¡œê·¸ì¸ ê¸°ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
        }
        
        this.logs = await response.json();
        this.applyFilters();
      } catch (error) {
        this.error = error.message;
      } finally {
        this.isLoading = false;
      }
    },
    
    // í•„í„° ì ìš© (ë””ë°”ìš´ìŠ¤)
    debounceFilter() {
      clearTimeout(this.filterTimeout);
      this.filterTimeout = setTimeout(() => {
        this.applyFilters();
      }, 300);
    },
    
    // í•„í„° ì ìš©
    applyFilters() {
      this.filteredLogs = this.logs.filter(log => {
        // ì‚¬ìš©ì í•„í„°
        if (this.filters.user && 
            !log.user_name.toLowerCase().includes(this.filters.user.toLowerCase()) &&
            !log.user_email.toLowerCase().includes(this.filters.user.toLowerCase())) {
          return false;
        }
        
        // ë‚ ì§œ í•„í„°
        const logDate = new Date(log.timestamp).toISOString().split('T')[0];
        if (this.filters.dateFrom && logDate < this.filters.dateFrom) {
          return false;
        }
        if (this.filters.dateTo && logDate > this.filters.dateTo) {
          return false;
        }
        
        // ìƒíƒœ í•„í„°
        if (this.filters.status && log.status !== this.filters.status) {
          return false;
        }
        
        return true;
      });
      
      this.applySorting();
      this.updatePagination();
    },
    
    // ì •ë ¬ ì ìš©
    applySorting() {
      this.filteredLogs.sort((a, b) => {
        let aVal = a[this.sortColumn];
        let bVal = b[this.sortColumn];
        
        if (this.sortColumn === 'timestamp') {
          aVal = new Date(aVal);
          bVal = new Date(bVal);
        }
        
        if (this.sortDirection === 'asc') {
          return aVal < bVal ? -1 : aVal > bVal ? 1 : 0;
        } else {
          return aVal > bVal ? -1 : aVal < bVal ? 1 : 0;
        }
      });
    },
    
    // í˜ì´ì§€ë„¤ì´ì…˜ ì—…ë°ì´íŠ¸
    updatePagination() {
      this.totalPages = Math.ceil(this.filteredLogs.length / this.pageSize);
      
      // í˜„ì¬ í˜ì´ì§€ê°€ ì´ í˜ì´ì§€ë¥¼ ì´ˆê³¼í•  ê²½ìš° ì¡°ì •
      if (this.currentPage > this.totalPages && this.totalPages > 0) {
        this.currentPage = this.totalPages;
      }
      
      const startIndex = (this.currentPage - 1) * this.pageSize;
      const endIndex = startIndex + this.pageSize;
      this.paginatedLogs = this.filteredLogs.slice(startIndex, endIndex);
    },
    
    // ì •ë ¬ ê¸°ëŠ¥
    sortBy(column) {
      if (this.sortColumn === column) {
        this.sortDirection = this.sortDirection === 'asc' ? 'desc' : 'asc';
      } else {
        this.sortColumn = column;
        this.sortDirection = 'desc';
      }
      this.applyFilters();
    },
    
    // í˜ì´ì§€ ì´ë™
    setPage(page) {
      if (page >= 1 && page <= this.totalPages) {
        this.currentPage = page;
        this.updatePagination();
      }
    },
    
    // í˜ì´ì§€ í¬ê¸° ì„¤ì •
    setLimit(limit) {
      this.pageSize = parseInt(limit);
      this.currentPage = 1;
      this.updatePagination();
    },
    
    // í•„í„° ì´ˆê¸°í™”
    resetFilters() {
      this.filters = {
        user: '',
        dateFrom: '',
        dateTo: '',
        status: ''
      };
      this.currentPage = 1;
      this.applyFilters();
    },
    
    // ì—ëŸ¬ í´ë¦¬ì–´
    clearError() {
      this.error = null;
    },
    
    // ë‚ ì§œ í¬ë§·íŒ…
    formatDate(dateString) {
      return new Date(dateString).toLocaleString('ko-KR', {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit'
      });
    }
  };
}
</script>
```

---

## ğŸ”— **ê´€ë ¨ ë¬¸ì„œ**

- **[05_ì»´í¬ë„ŒíŠ¸_ì„¤ê³„.md](./05_ì»´í¬ë„ŒíŠ¸_ì„¤ê³„.md)**: ì»´í¬ë„ŒíŠ¸ì™€ ìƒíƒœ ì—°ê²°
- **[07_API_ì„¤ê³„.md](./07_API_ì„¤ê³„.md)**: API í˜¸ì¶œ ë° ë°ì´í„° ê´€ë¦¬
- **[12_ê°œë°œ_ê°€ì´ë“œ.md](./12_ê°œë°œ_ê°€ì´ë“œ.md)**: ìƒíƒœ ê´€ë¦¬ ê°œë°œ ê°€ì´ë“œë¼ì¸
